{"version":3,"sources":["Common/MovieAPI.js","Common/MovieSeen.js","Login/UserContext.js","Common/TagAPI.js","ApplicationContext.js","Admin/Tag.js","MovieList/MovieCard.jsx","Common/MoviesContext.js","Common/MultiDownshift.jsx","shared.js","Common/MultiDownshiftWithReverse.jsx","Common/AsyncMultiDownshift.jsx","MovieList/MoviesFilter.js","Common/SingleDownshift.jsx","Common/Accordion.jsx","MovieList/MovieForm.jsx","MovieList/List.js","Common/EditableField.js","Movie/Season/Episode.js","Common/hooks.js","Movie/Season/Season.js","Movie/Movie.js","Common/Fetch.jsx","Header.js","Statistics/Statistics.js","Admin/TagList.js","App.js","Login/Login.js","index.js"],"names":["controller","MovieSeen","_ref","seen","onClick","_ref$partial","partial","react_default","a","createElement","className","style","color","cursor","headers","user","Accept","Content-Type","Authorization","concat","token","handleResponse","response","ok","json","Error","getMovies","abortable","search","abort","AbortController","fetch","signal","then","updateMovie","movie","_id","method","body","JSON","stringify","updateSeason","season","UserContext","React","createContext","withUser","Component","props","Consumer","Object","assign","LOGOUT","Symbol","LOGIN","LOGIN_FAILED","UserProvider","_React$Component","_getPrototypeOf2","_this","classCallCheck","this","_len","arguments","length","args","Array","_key","possibleConstructorReturn","getPrototypeOf","call","apply","state","status","login","bind","assertThisInitialized","inherits","createClass","key","value","_this2","localStorage","getItem","exp","Date","setState","password","_this3","_ref2","setItem","catch","Provider","children","ApplicationContext","LOADING","LOADED","ApplicationProvider","set","field","fn","objectSpread","defineProperty","genres","types","tags","options","Promise","all","slicedToArray","Tag","hex","label","big","_ref$className","_ref$style","backgroundColor","indexOf","slice","parseInt","MovieCard","onEdit","onChange","onDelete","useContext","update","title","subtitle","productionYear","genre","join","Link","to","position","top","right","type","finished","MovieSeen_MovieSeen","every","seasons","map","episodes","some","window","confirm","deleteMovie","src","fileUrl","alt","movieTag","Tag_Tag","find","tag","MoviesContext","MoviesProvider","add","movies","toConsumableArray","id","index","findIndex","filter","Boolean","addAll","data","count","_ref3","invalidate","name","undefined","_ref4","filters","limit","MultiDownshift","selectedItems","stateReducer","changes","Downshift","stateChangeTypes","keyDownEnter","clickItem","highlightedIndex","isOpen","callOnChange","downshift","getStateAndHelpers","handleSelection","selectedItem","includes","removeItem","addSelectedItem","item","cb","i","getRemoveButtonProps","objectWithoutProperties","e","stopPropagation","prevProps","_this$props","render","_this$props$children","downshift_esm","css","emoCSS","Item","styled","display","border","height","textAlign","borderTop","lineHeight","fontSize","textTransform","fontWeight","boxShadow","padding","whiteSpace","wordWrap","isActive","isSelected","styles","push","background","BaseMenu","marginTop","width","maxHeight","overflowY","overflowX","outline","transition","borderRadius","borderColor","borderTopWidth","borderRightWidth","borderBottomWidth","borderLeftWidth","borderStyle","zIndex","Menu","forwardRef","ref","innerRef","ControllerButton","flexDirection","justifyContent","alignItems","ArrowIcon","viewBox","preserveAspectRatio","fill","stroke","strokeWidth","transform","d","MultiDownshiftWithReverse","clickOnItem","newSelectedItems","displayItem","displayBackground","itemToFind","BaseMultiDownshift","BaseComponent","_Component","_class","handleChange","placeholder","items","getToggleButtonProps","getMenuProps","getItemProps","toggleMenu","_ref$clickOnItem","_ref$displayItem","identity","_ref$displayBackgroun","_ref$isSelected","margin","paddingRight","flexWrap","paddingLeft","event","preventDefault","gridGap","gridAutoFlow","AsyncMultiDownshift","AsyncMultiDownshiftwithReverse","fromEvent","target","forInput","from","FilterTag","selected","onAdd","MoviesFilter","_useContext","_useContext2","max","minWidth","icon","renderSeen","renderFinished","MoviesFilter_FilterTag","filterTag","t","SingleDownshift","getInputProps","getLabelProps","inputValue","Accordion","open","toggle","react","defaultState","summary","allocine","tvshows","MovieFormWithContext","valid","isEmpty","$","modal","onUpdate","synchronizeMovieAllocine","idAllocine","m","sort","release","releaseDate","getFullYear","synopsis","poster","href","synchronizeTvShowAllocine","tvseries","yearStart","onInput","onSelect","on","onClose","application","tabIndex","role","data-show","data-dismiss","aria-label","aria-hidden","htmlFor","aria-describedby","paddingTop","Accordion_Accordion","_ref5","code","_ref6","tvshow","SingleDownshift_SingleDownshift","disabled","MovieForm","MovieAPI","List","_useState","useState","_useState2","offset","setOffset","_useState3","_useState4","setMovie","_useState5","_useState6","setKey","_useState7","_useState8","loaded","setLoaded","loadMore","notGenres","keys","isArray","buildQuery","useEffect","debouncedLoadMore","debounce","leading","trailing","cancel","left","MoviesFilter_MoviesFilter","MovieCard_MovieCard","_","EditableField","setValue","edit","setEdit","lock","renderFormField","renderValue","EditableInput","EditableField_EditableField","fieldProps","valueProps","EditableTextarea","rows","split","Episode","episode","onEpisodeChanged","MovieContext","SeasonContext","seasonIndex","ellipsis","setEllipsis","updateEpisode","newMovie","produce","EditableField_EditableInput","EditableField_EditableTextarea","useToggle","initialValue","useInput","Season","onMovieChanged","_useToggle","_useToggle2","oneSeen","episodeIndex","Episode_Episode","MovieTag","Movie","withRouter","match","history","params","mergeContext","updatedMovie","goBack","Movie_MovieTag","flexGrow","Season_Season_Season","Fetch","FetchWithContext","debounceFetch","endpoint","onSuccess","Header","initialState","unseen","Statistics","stats","setStats","forEach","draft","g","fetchByTypes","fetchByTags","orderBy","toFixed","random","Math","floor","generateColor","toString","padStart","TagList","setTags","_useInput","_useInput2","setColor","_useInput3","_useInput4","setLabel","overflow","deleteTag","createTag","toLowerCase","marginLeft","App","BrowserRouter","Header_Header","Route","exact","path","component","Login","onKeyDown","ReactDOM","UserContext_UserProvider","ApplicationContext_ApplicationProvider","MoviesContext_MoviesProvider","src_App_0","document","getElementById"],"mappings":"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","file":"static/js/main.882cbff3.chunk.js","sourcesContent":["const headers = user => ({\n  Accept: \"application/json\",\n  \"Content-Type\": \"application/json\",\n  Authorization: `Bearer ${user.token}`\n});\n\nconst handleResponse = response => {\n  if (response.ok) return response.json();\n  throw new Error(\"Fetch fail\");\n};\n\nexport const getMovie = (id, user) => {\n  return fetch(`/api/movies/${id}`, {\n    headers: headers(user)\n  }).then(handleResponse);\n};\n\nlet controller;\nexport const getMovies = abortable => (search, user) => {\n  if (abortable && controller) {\n    controller.abort();\n  }\n  controller = new AbortController();\n  return fetch(`/api/movies?${search}`, {\n    headers: headers(user),\n    signal: controller.signal\n  })\n    .then(response => {\n      controller = null;\n      return response;\n    })\n    .then(handleResponse);\n};\n\nexport const updateMovie = (movie, user) => {\n  return fetch(`/api/movies/${movie._id}`, {\n    method: \"PUT\",\n    body: JSON.stringify(movie),\n    headers: headers(user)\n  }).then(handleResponse);\n};\n\nexport const deleteMovie = (movie, user) => {\n  return fetch(`/api/movies/${movie._id}`, {\n    method: \"DELETE\",\n    headers: headers(user)\n  }).then(handleResponse);\n};\n\nexport const addSeason = (movie, user) => {\n  return fetch(`/api/movies/${movie._id}/seasons`, {\n    method: \"POST\",\n    body: JSON.stringify(movie),\n    headers: headers(user)\n  }).then(handleResponse);\n};\n\nexport const updateSeason = (movie, season, user) => {\n  return fetch(`/api/movies/${movie._id}/seasons/${season._id}`, {\n    method: \"PUT\",\n    body: JSON.stringify(season),\n    headers: headers(user)\n  }).then(handleResponse);\n};\n\nexport const deleteSeason = (movie, season, user) => {\n  return fetch(`/api/movies/${movie._id}/seasons/${season._id}`, {\n    method: \"DELETE\",\n    headers: headers(user)\n  }).then(handleResponse);\n};\n\nexport const addEpisode = (movie, season, user) => {\n  return fetch(`/api/movies/${movie._id}/seasons/${season._id}/episodes`, {\n    method: \"POST\",\n    body: JSON.stringify(season),\n    headers: headers(user)\n  }).then(handleResponse);\n};\n\nexport const updateEpisode = (movie, season, episode, user) => {\n  return fetch(\n    `/api/movies/${movie._id}/seasons/${season._id}/episodes/${episode._id}`,\n    {\n      method: \"PUT\",\n      body: JSON.stringify(episode),\n      headers: headers(user)\n    }\n  ).then(handleResponse);\n};\n\nexport const deleteEpisode = (movie, season, episode, user) => {\n  return fetch(\n    `/api/movies/${movie._id}/seasons/${season._id}/episodes/${episode._id}`,\n    {\n      method: \"DELETE\",\n      headers: headers(user)\n    }\n  ).then(handleResponse);\n};\n","import React from \"react\";\n\nexport const MovieSeen = ({ seen, onClick, partial = false }) => (\n  <i\n    className=\"fas fa-eye\"\n    style={{\n      color: partial && !seen ? \"var(--warning)\" : seen ? \"var(--success)\" : \"\",\n      cursor: \"pointer\"\n    }}\n    onClick={onClick}\n  />\n);\n","import React from \"react\";\n\nexport const UserContext = React.createContext();\nexport const withUser = Component => props => (\n  <UserContext.Consumer>\n    {user => <Component {...props} user={user} />}\n  </UserContext.Consumer>\n);\n\nexport const LOGOUT = Symbol();\nexport const LOGIN = Symbol();\nexport const LOGIN_FAILED = Symbol();\n\nconst handleResponse = response => {\n  if (response.ok) return response.json();\n  throw new Error(\"Fetch fail\");\n};\n\nexport class UserProvider extends React.Component {\n  state = {\n    token: null,\n    status: LOGOUT,\n    login: this.login.bind(this)\n  };\n\n  componentDidMount() {\n    const token = localStorage.getItem(\"token\");\n    if (token) {\n      fetch(\"/account\", {\n        method: \"POST\",\n        headers: {\n          Accept: \"application/json\",\n          \"Content-Type\": \"application/json\",\n          Authorization: `Bearer ${token}`\n        }\n      })\n        .then(handleResponse)\n        .then(({ exp }) => {\n          if (new Date() < new Date(exp * 1000))\n            this.setState({ token, status: LOGIN });\n        });\n    }\n  }\n\n  login(password) {\n    fetch(\"/login\", {\n      method: \"POST\",\n      body: JSON.stringify({ password }),\n      headers: {\n        Accept: \"application/json\",\n        \"Content-Type\": \"application/json\"\n      }\n    })\n      .then(handleResponse)\n      .then(({ token }) => {\n        this.setState({ token, status: LOGIN });\n        localStorage.setItem(\"token\", token);\n      })\n      .catch(() => this.setState({ status: LOGIN_FAILED }));\n  }\n\n  render() {\n    return (\n      <UserContext.Provider value={this.state}>\n        {this.props.children}\n      </UserContext.Provider>\n    );\n  }\n}\n","const headers = user => ({\n  Accept: \"application/json\",\n  \"Content-Type\": \"application/json\",\n  Authorization: `Bearer ${user.token}`\n});\n\nconst handleResponse = response => {\n  if (response.ok) return response.json();\n  throw new Error(\"Fetch fail\");\n};\n\nexport const getTags = user => {\n  return fetch(`/api/tags`, {\n    headers: headers(user)\n  }).then(handleResponse);\n};\n\nexport const createTag = (tag, user) => {\n  return fetch(`/api/tags`, {\n    method: \"POST\",\n    body: JSON.stringify(tag),\n    headers: headers(user)\n  }).then(handleResponse);\n};\n\nexport const deleteTag = (tag, user) => {\n  return fetch(`/api/tags/${tag._id}`, {\n    method: \"DELETE\",\n    headers: headers(user)\n  }).then(handleResponse);\n};\n","import React from \"react\";\nimport { getTags } from \"./Common/TagAPI\";\n\nexport const ApplicationContext = React.createContext();\nexport const withApplication = Component => props => (\n  <ApplicationContext.Consumer>\n    {application => <Component {...props} application={application} />}\n  </ApplicationContext.Consumer>\n);\n\nexport const LOADING = Symbol();\nexport const LOADED = Symbol();\n\nexport class ApplicationProvider extends React.Component {\n  set = field => fn => {\n    this.setState(state => ({ ...state, [field]: fn(state[field]) }));\n  };\n\n  componentDidMount() {\n    const options = {\n      headers: {\n        Authorization: `Bearer ${this.props.token}`\n      }\n    };\n\n    const handleResponse = response => {\n      if (response.ok) return response.json();\n      throw new Error(\"Fetch fail\");\n    };\n    Promise.all([\n      fetch(\"/api/movies/genre\", options).then(handleResponse),\n      fetch(\"/api/movies/type\", options).then(handleResponse),\n      getTags(this.props)\n    ]).then(([genres, types, tags]) => {\n      this.setState({\n        genres,\n        types,\n        tags,\n        status: LOADED\n      });\n    });\n  }\n  state = {\n    genres: [],\n    types: [],\n    tags: [],\n    status: LOADING,\n    set: this.set\n  };\n\n  render() {\n    return (\n      <ApplicationContext.Provider value={this.state}>\n        {this.props.children}\n      </ApplicationContext.Provider>\n    );\n  }\n}\n","import React from \"react\";\nimport \"./Tag.css\";\n\nconst invertColor = hex => {\n  if (hex.indexOf(\"#\") === 0) {\n    hex = hex.slice(1);\n  }\n\n  const red = parseInt(hex.slice(0, 2), 16),\n    green = parseInt(hex.slice(2, 4), 16),\n    blue = parseInt(hex.slice(4, 6), 16);\n  return red * 0.299 + green * 0.587 + blue * 0.114 > 186\n    ? \"#000000\"\n    : \"#FFFFFF\";\n};\n\nexport const Tag = ({ color, label, big, className = \"\", style = {} }) => (\n  <span\n    className={`tag ${big ? \"big\" : \"\"} ${className}`}\n    style={{\n      backgroundColor: color,\n      color: `${invertColor(color)}`,\n      ...style\n    }}\n  >\n    {label}\n  </span>\n);\n","import React, { useContext } from \"react\";\nimport \"./MovieList.css\";\nimport { Link } from \"react-router-dom\";\nimport { MovieSeen } from \"../Common/MovieSeen\";\nimport { deleteMovie, updateMovie } from \"../Common/MovieAPI\";\nimport every from \"lodash/every\";\nimport some from \"lodash/some\";\nimport { UserContext } from \"../Login/UserContext\";\nimport { ApplicationContext } from \"../ApplicationContext\";\nimport { Tag } from \"../Admin/Tag\";\n\nexport const MovieCard = ({ movie, onEdit, onChange, onDelete }) => {\n  const user = useContext(UserContext);\n  const { tags } = useContext(ApplicationContext);\n  const update = (field, value) => () =>\n    updateMovie({ ...movie, [field]: value }, user).then(onChange);\n\n  const title = `${movie.title}`;\n  const subtitle = `${movie.productionYear} - ${movie.genre.join(\",\")}`;\n\n  return (\n    <div className=\"card movie-card\">\n      <div className=\"card-body\">\n        <h5 className=\"card-title\">\n          <Link to={`movie/${movie._id}`}>\n            <div className=\"ellipsis\" title={title}>\n              {title}\n            </div>\n          </Link>\n        </h5>\n        <h6 className=\"card-subtitle mb-2 text-muted ellipsis\" title={subtitle}>\n          {subtitle}\n        </h6>\n        <div\n          className=\"movie-card-actions\"\n          style={{ position: \"absolute\", top: 2, right: 4 }}\n        >\n          {movie.type !== \"Film\" && (\n            <i\n              className=\"fas fa-ban\"\n              style={{\n                cursor: \"pointer\",\n                color: movie.finished ? \"var(--danger)\" : \"black\"\n              }}\n              onClick={update(\"finished\", !movie.finished)}\n            />\n          )}\n          {movie.type === \"Film\" ? (\n            <MovieSeen\n              seen={movie.seen}\n              onClick={update(\"seen\", !movie.seen)}\n            />\n          ) : (\n            <MovieSeen\n              seen={\n                every(\n                  movie.seasons.map(\n                    season =>\n                      every(season.episodes, \"seen\") &&\n                      season.episodes.length > 0\n                  )\n                ) && movie.seasons.length > 0\n              }\n              partial={\n                some(\n                  movie.seasons.map(\n                    season =>\n                      some(season.episodes, \"seen\") &&\n                      season.episodes.length > 0\n                  )\n                ) && movie.seasons.length > 0\n              }\n            />\n          )}\n          <i\n            className=\"fas fa-pencil-alt\"\n            onClick={onEdit}\n            style={{ cursor: \"pointer\" }}\n          />\n          <i\n            className=\"fas fa-trash\"\n            onClick={() => {\n              if (window.confirm()) {\n                deleteMovie(movie, user).then(onDelete);\n              }\n            }}\n            style={{ cursor: \"pointer\" }}\n          />\n        </div>\n        <div className=\"poster text-center\">\n          <img src={movie.fileUrl} alt=\"movie poster\" />\n        </div>\n        <div className=\"mt-2 text-center\">\n          {movie.tags.map(movieTag => (\n            <Tag {...tags.find(tag => tag._id === movieTag)} className=\"mr-2\" />\n          ))}\n        </div>\n      </div>\n    </div>\n  );\n};\n","import React from \"react\";\nimport findIndex from \"lodash/findIndex\";\n\nexport const MoviesContext = React.createContext();\n\nexport class MoviesProvider extends React.Component {\n  add = movie => {\n    this.setState(({ movies }) => ({ movies: [movie, ...movies] }));\n  };\n\n  update = (id, movie) => {\n    const index = findIndex(this.state.movies, [\"_id\", id]);\n    const movies = [...this.state.movies];\n    movies[index] = movie;\n    this.setState({\n      movies: movies.filter(Boolean) // pass undefined as delete and then use filter te remove the element\n    });\n  };\n\n  addAll = ({ data, count }) => {\n    this.setState(({ movies }) => ({ movies: [...movies, ...data], count }));\n  };\n\n  invalidate = () => {\n    this.setState({ movies: [], count: 0 });\n  };\n\n  onChange = name => (value = \"\") => {\n    this.setState(({ filters }) => ({\n      movies: [],\n      count: 0,\n      filters: { ...filters, [name]: value }\n    }));\n  };\n\n  state = {\n    movies: [],\n    count: 0,\n    filters: {\n      productionYear: \"\",\n      title: \"\",\n      genres: [],\n      types: [],\n      tags: [],\n      seen: null, // null = dont care, true = have seen, false = have not seen\n      finished: null, // null = dont care, true = finished\n      limit: 30\n    },\n    onChange: this.onChange,\n    addAll: this.addAll,\n    update: this.update,\n    add: this.add,\n    invalidate: this.invalidate\n  };\n\n  render() {\n    return (\n      <MoviesContext.Provider value={this.state}>\n        {this.props.children}\n      </MoviesContext.Provider>\n    );\n  }\n}\n","import React from \"react\";\nimport Downshift from \"downshift\";\n\nexport class MultiDownshift extends React.Component {\n  state = { selectedItems: this.props.selectedItems || [] };\n\n  componentDidUpdate(prevProps) {\n    if (\n      prevProps.selectedItems !== this.props.selectedItems &&\n      this.props.selectedItems !== this.state.selectedItems\n    ) {\n      this.setState({ selectedItems: this.props.selectedItems || [] });\n    }\n  }\n  stateReducer = (state, changes) => {\n    switch (changes.type) {\n      case Downshift.stateChangeTypes.keyDownEnter:\n      case Downshift.stateChangeTypes.clickItem:\n        return {\n          ...changes,\n          highlightedIndex: state.highlightedIndex,\n          isOpen: true\n        };\n      default:\n        return changes;\n    }\n  };\n\n  callOnChange = downshift => () => {\n    if (this.props.onChange) {\n      this.props.onChange(\n        this.state.selectedItems,\n        this.getStateAndHelpers(downshift)\n      );\n    }\n  };\n\n  handleSelection = (selectedItem, downshift) => {\n    if (this.state.selectedItems.includes(selectedItem)) {\n      this.removeItem(selectedItem, this.callOnChange(downshift));\n    } else {\n      this.addSelectedItem(selectedItem, this.callOnChange(downshift));\n    }\n  };\n\n  removeItem = (item, cb) => {\n    this.setState(({ selectedItems }) => {\n      return {\n        selectedItems: selectedItems.filter(i => i !== item)\n      };\n    }, cb);\n  };\n  addSelectedItem(item, cb) {\n    this.setState(\n      ({ selectedItems }) => ({\n        selectedItems: [...selectedItems, item]\n      }),\n      cb\n    );\n  }\n\n  getRemoveButtonProps = downshift => ({ onClick, item, ...props } = {}) => {\n    return {\n      onClick: e => {\n        // TODO: use something like downshift's composeEventHandlers utility instead\n        onClick && onClick(e);\n        e.stopPropagation();\n        this.removeItem(item, this.callOnChange(downshift));\n      },\n      ...props\n    };\n  };\n\n  getStateAndHelpers(downshift) {\n    const { selectedItems } = this.state;\n    const { getRemoveButtonProps, removeItem } = this;\n    return {\n      getRemoveButtonProps: getRemoveButtonProps(downshift),\n      removeItem,\n      selectedItems,\n      ...downshift\n    };\n  }\n  render() {\n    const { render, children = render, ...props } = this.props;\n    // TODO: compose together props (rather than overwriting them) like downshift does\n    return (\n      <Downshift\n        {...props}\n        stateReducer={this.stateReducer}\n        onChange={this.handleSelection}\n        selectedItem={null}\n      >\n        {downshift => children(this.getStateAndHelpers(downshift))}\n      </Downshift>\n    );\n  }\n}\n","import React from \"react\";\nimport { css as emoCSS } from \"emotion\";\nimport styled from \"react-emotion\";\n\n// TODO copy paste from downshift example :)\n\nconst css = (...args) => ({ className: emoCSS(...args) });\n\nconst Item = styled(\"li\")(\n  {\n    position: \"relative\",\n    cursor: \"pointer\",\n    display: \"block\",\n    border: \"none\",\n    height: \"auto\",\n    textAlign: \"left\",\n    borderTop: \"none\",\n    lineHeight: \"1em\",\n    color: \"rgba(0,0,0,.87)\",\n    fontSize: \"1rem\",\n    textTransform: \"none\",\n    fontWeight: \"400\",\n    boxShadow: \"none\",\n    padding: \".8rem 1.1rem\",\n    whiteSpace: \"normal\",\n    wordWrap: \"normal\"\n  },\n  ({ isActive, isSelected }) => {\n    const styles = [];\n    if (isActive) {\n      styles.push({\n        color: \"rgba(0,0,0,.95)\",\n        background: \"rgba(0,0,0,.03)\"\n      });\n    }\n    if (isSelected) {\n      styles.push({\n        color: \"rgba(0,0,0,.95)\",\n        fontWeight: \"700\"\n      });\n    }\n    return styles;\n  }\n);\n\nconst BaseMenu = styled(\"ul\")(\n  {\n    padding: 0,\n    marginTop: 0,\n    position: \"absolute\",\n    backgroundColor: \"white\",\n    width: \"100%\",\n    maxHeight: \"20rem\",\n    overflowY: \"auto\",\n    overflowX: \"hidden\",\n    outline: \"0\",\n    transition: \"opacity .1s ease\",\n    borderRadius: \"0 0 .28571429rem .28571429rem\",\n    boxShadow: \"0 2px 3px 0 rgba(34,36,38,.15)\",\n    borderColor: \"#96c8da\",\n    borderTopWidth: \"0\",\n    borderRightWidth: 1,\n    borderBottomWidth: 1,\n    borderLeftWidth: 1,\n    borderStyle: \"solid\",\n    zIndex: 10\n  },\n  ({ isOpen }) => ({\n    border: isOpen ? null : \"none\"\n  })\n);\n\nconst Menu = React.forwardRef((props, ref) => (\n  <BaseMenu innerRef={ref} {...props} />\n));\n\nconst ControllerButton = styled(\"button\")({\n  backgroundColor: \"transparent\",\n  border: \"none\",\n  position: \"absolute\",\n  right: 0,\n  top: 0,\n  cursor: \"pointer\",\n  width: 47,\n  display: \"flex\",\n  flexDirection: \"column\",\n  height: \"100%\",\n  justifyContent: \"center\",\n  alignItems: \"center\"\n});\n\nfunction ArrowIcon({ isOpen }) {\n  return (\n    <svg\n      viewBox=\"0 0 20 20\"\n      preserveAspectRatio=\"none\"\n      width={16}\n      fill=\"transparent\"\n      stroke=\"#979797\"\n      strokeWidth=\"1.1px\"\n      transform={isOpen ? \"rotate(180)\" : null}\n    >\n      <path d=\"M1,6 L10,15 L19,6\" />\n    </svg>\n  );\n}\nexport { Menu, ControllerButton, Item, ArrowIcon, css };\n","import React from \"react\";\nimport Downshift from \"downshift\";\n\nexport class MultiDownshiftWithReverse extends React.Component {\n  state = { selectedItems: this.props.selectedItems || [] };\n  stateReducer = (state, changes) => {\n    switch (changes.type) {\n      case Downshift.stateChangeTypes.keyDownEnter:\n      case Downshift.stateChangeTypes.clickItem:\n        return {\n          ...changes,\n          highlightedIndex: state.highlightedIndex,\n          isOpen: true\n        };\n      default:\n        return changes;\n    }\n  };\n\n  callOnChange = downshift => () => {\n    if (this.props.onChange) {\n      this.props.onChange(\n        this.state.selectedItems,\n        this.getStateAndHelpers(downshift)\n      );\n    }\n  };\n\n  handleSelection = (selectedItem, downshift) => {\n    if (\n      this.state.selectedItems.filter(item => selectedItem === item[0]).length >\n      0\n    ) {\n      this.removeItem([selectedItem], this.callOnChange(downshift));\n    } else {\n      this.addSelectedItem(selectedItem, this.callOnChange(downshift));\n    }\n  };\n\n  removeItem = (item, cb) => {\n    this.setState(({ selectedItems }) => {\n      return {\n        selectedItems: selectedItems.filter(i => i[0] !== item[0])\n      };\n    }, cb);\n  };\n  addSelectedItem(item, cb) {\n    this.setState(\n      ({ selectedItems }) => ({\n        selectedItems: [...selectedItems, [item, true]]\n      }),\n      cb\n    );\n  }\n\n  getRemoveButtonProps = downshift => ({ onClick, item, ...props } = {}) => {\n    return {\n      onClick: e => {\n        // TODO: use something like downshift's composeEventHandlers utility instead\n        onClick && onClick(e);\n        e.stopPropagation();\n        this.removeItem(item, this.callOnChange(downshift));\n      },\n      ...props\n    };\n  };\n\n  clickOnItem = downshift => (item, index) => {\n    this.setState(({ selectedItems }) => {\n      const newSelectedItems = selectedItems;\n      newSelectedItems[index] = [item[0], !item[1]];\n      return {\n        selectedItems: newSelectedItems.filter(i => i !== item[0])\n      };\n    }, this.callOnChange(downshift));\n  };\n  displayItem = item => {\n    return item[0];\n  };\n  displayBackground = item => {\n    return item[1] ? \"#ccc\" : \"tomato\";\n  };\n  isSelected = itemToFind => {\n    return this.state.selectedItems.find(item => item[0] === itemToFind);\n  };\n\n  getStateAndHelpers(downshift) {\n    const { selectedItems } = this.state;\n    const {\n      getRemoveButtonProps,\n      removeItem,\n      clickOnItem,\n      displayItem,\n      displayBackground,\n      isSelected\n    } = this;\n    return {\n      getRemoveButtonProps: getRemoveButtonProps(downshift),\n      removeItem,\n      selectedItems,\n      clickOnItem: clickOnItem(downshift),\n      displayItem,\n      displayBackground,\n      isSelected,\n      ...downshift\n    };\n  }\n  render() {\n    const { render, children = render, ...props } = this.props;\n    // TODO: compose together props (rather than overwriting them) like downshift does\n    return (\n      <Downshift\n        {...props}\n        stateReducer={this.stateReducer}\n        onChange={this.handleSelection}\n        selectedItem={null}\n      >\n        {downshift => children(this.getStateAndHelpers(downshift))}\n      </Downshift>\n    );\n  }\n}\n","import { MultiDownshift } from \"./MultiDownshift\";\nimport { ArrowIcon, ControllerButton, css, Item, Menu } from \"../shared\";\nimport React, { Component } from \"react\";\nimport identity from \"lodash/identity\";\nimport { MultiDownshiftWithReverse } from \"./MultiDownshiftWithReverse\";\n\nconst BaseMultiDownshift = BaseComponent =>\n  class extends Component {\n    render() {\n      const { handleChange, placeholder, items, selectedItems } = this.props;\n      return (\n        <BaseComponent\n          onChange={handleChange}\n          selectedItems={selectedItems}\n          placeholder={placeholder}\n        >\n          {({\n            getToggleButtonProps,\n            getMenuProps,\n            getRemoveButtonProps,\n            removeItem,\n            isOpen,\n            selectedItems,\n            getItemProps,\n            highlightedIndex,\n            toggleMenu,\n            clickOnItem = () => void 0,\n            displayItem = identity,\n            displayBackground = () => \"#ccc\",\n            isSelected = item => selectedItems.includes(item)\n          }) => (\n            <div\n              style={{\n                margin: \"auto\",\n                position: \"relative\",\n                width: \"100%\"\n              }}\n            >\n              <div\n                {...css({\n                  cursor: \"pointer\",\n                  position: \"relative\",\n                  padding: \".375rem .75rem\",\n                  paddingRight: 50,\n                  border: \"1px solid #ced4da\",\n                  borderRadius: \".25rem\",\n                  backgroundColor: \"white\"\n                })}\n                onClick={() => {\n                  toggleMenu();\n                }}\n              >\n                <div\n                  {...css({\n                    display: \"flex\",\n                    flexWrap: \"wrap\",\n                    alignItems: \"center\"\n                  })}\n                >\n                  {selectedItems.length > 0 ? (\n                    selectedItems.map((item, index) => (\n                      <div\n                        key={index}\n                        {...css({\n                          margin: \"0 2px\",\n                          paddingLeft: 8,\n                          paddingRight: 8,\n                          display: \"inline-block\",\n                          wordWrap: \"none\",\n                          backgroundColor: displayBackground(item),\n                          borderRadius: 2\n                        })}\n                        onClick={event => {\n                          event.preventDefault();\n                          event.stopPropagation();\n                          clickOnItem(item, index);\n                        }}\n                      >\n                        <div\n                          {...css({\n                            display: \"grid\",\n                            gridGap: 6,\n                            gridAutoFlow: \"column\",\n                            alignItems: \"center\"\n                          })}\n                        >\n                          <span>{displayItem(item)}</span>\n                          <button\n                            {...getRemoveButtonProps({ item })}\n                            {...css({\n                              cursor: \"pointer\",\n                              lineHeight: 0.8,\n                              border: \"none\",\n                              backgroundColor: \"transparent\",\n                              padding: \"0\",\n                              fontSize: \"16px\"\n                            })}\n                            type=\"button\"\n                          >\n                            \n                          </button>\n                        </div>\n                      </div>\n                    ))\n                  ) : (\n                    <span\n                      {...css({\n                        color: \"#6c757d;\"\n                      })}\n                    >\n                      {placeholder}\n                    </span>\n                  )}\n                </div>\n                <ControllerButton\n                  {...getToggleButtonProps({\n                    // prevents the menu from immediately toggling\n                    // closed (due to our custom click handler above).\n                    onClick(event) {\n                      event.stopPropagation();\n                    }\n                  })}\n                >\n                  <ArrowIcon isOpen={isOpen} />\n                </ControllerButton>\n              </div>\n              <Menu {...getMenuProps({ isOpen })}>\n                {isOpen\n                  ? items.map((item, index) => (\n                      <Item\n                        key={index}\n                        {...getItemProps({\n                          item,\n                          index,\n                          isActive: highlightedIndex === index,\n                          isSelected: isSelected(item)\n                        })}\n                      >\n                        {item}\n                      </Item>\n                    ))\n                  : null}\n              </Menu>\n            </div>\n          )}\n        </BaseComponent>\n      );\n    }\n  };\n\nexport const AsyncMultiDownshift = BaseMultiDownshift(MultiDownshift);\nexport const AsyncMultiDownshiftwithReverse = BaseMultiDownshift(\n  MultiDownshiftWithReverse\n);\n","import React, { useContext } from \"react\";\nimport identity from \"lodash/identity\";\nimport { MoviesContext } from \"../Common/MoviesContext\";\nimport {\n  AsyncMultiDownshift,\n  AsyncMultiDownshiftwithReverse\n} from \"../Common/AsyncMultiDownshift\";\nimport { ApplicationContext } from \"../ApplicationContext\";\nimport { Tag } from \"../Admin/Tag\";\n\nconst fromEvent = event => event.target.value;\n\nconst forInput = (\n  { filters, onChange },\n  name,\n  transform = identity,\n  from = fromEvent\n) => {\n  return {\n    value: filters[name],\n    onChange: value => onChange(name)(transform(from(value)))\n  };\n};\n\nconst FilterTag = ({ tag, selected, onAdd, onDelete }) => (\n  <span onClick={selected ? onDelete : onAdd}>\n    <Tag {...tag} className={`filter-tag mr-2 ${selected ? \"selected\" : \"\"}`} />\n  </span>\n);\n\nexport const MoviesFilter = () => {\n  const { filters, onChange } = useContext(MoviesContext);\n  const { genres, types, tags } = useContext(ApplicationContext);\n  const { seen, finished } = filters;\n\n  const renderSeen = () => {\n    let color = \"\",\n      icon = \"fa-eye\",\n      onClick = () => onChange(\"seen\")(\"true\");\n    if (seen === \"true\") {\n      color = \"var(--success)\";\n      onClick = () => onChange(\"seen\")(\"partial\");\n    } else if (seen === \"partial\") {\n      color = \"var(--warning)\";\n      onClick = () => onChange(\"seen\")(\"false\");\n    } else if (seen === \"false\") {\n      color = \"var(--danger)\";\n      icon = \"fa-eye-slash\";\n      onClick = () => onChange(\"seen\")(null);\n    }\n    return (\n      <i\n        className={`fas ${icon}`}\n        style={{\n          color,\n          cursor: \"pointer\"\n        }}\n        onClick={onClick}\n      />\n    );\n  };\n\n  const renderFinished = () => {\n    let color = \"\",\n      onClick = () => onChange(\"finished\")(true);\n    if (finished === true) {\n      color = \"var(--danger)\";\n      onClick = () => onChange(\"finished\")(null);\n    }\n    return (\n      <i\n        className={`fas fa-ban`}\n        style={{\n          color,\n          cursor: \"pointer\"\n        }}\n        onClick={onClick}\n      />\n    );\n  };\n\n  return (\n    <form className=\"form-inline movies-filter mt-4 ml-3\">\n      <div className=\"form-group mr-2\">\n        <input\n          {...forInput({ filters, onChange }, \"productionYear\", value =>\n            parseInt(value, 10)\n          )}\n          type=\"number\"\n          max={2200}\n          placeholder=\"YYYY\"\n          className=\"form-control\"\n          style={{ width: \"90px\" }}\n        />\n      </div>\n      <div className=\"form-group mr-2\">\n        <input\n          type=\"text\"\n          {...forInput({ filters, onChange }, \"title\")}\n          placeholder=\"Title\"\n          className=\"form-control\"\n        />\n      </div>\n      <div className=\"form-group mr-2\" style={{ minWidth: \"220px\" }}>\n        <AsyncMultiDownshiftwithReverse\n          placeholder=\"Genre\"\n          handleChange={\n            forInput({ filters, onChange }, \"genres\", identity, identity)\n              .onChange\n          }\n          items={genres}\n          selectedItems={filters.genres}\n        />\n      </div>\n      <div className=\"form-group mr-2\" style={{ width: \"220px\" }}>\n        <AsyncMultiDownshift\n          placeholder=\"Type\"\n          handleChange={\n            forInput({ filters, onChange }, \"types\", identity, identity)\n              .onChange\n          }\n          items={types}\n          selectedItems={filters.types}\n        />\n      </div>\n      <div className=\"form-group mr-2\">{renderSeen()}</div>\n      <div className=\"form-group mr-2\">{renderFinished()}</div>\n      <div>\n        {tags.map(tag => (\n          <FilterTag\n            key={tag._id}\n            tag={tag}\n            selected={filters.tags.find(filterTag => filterTag === tag._id)}\n            onAdd={() => onChange(\"tags\")([...filters.tags, tag._id])}\n            onDelete={() =>\n              onChange(\"tags\")(filters.tags.filter(t => t !== tag._id))\n            }\n          />\n        ))}\n      </div>\n    </form>\n  );\n};\n","import React from \"react\";\nimport Downshift from \"downshift\";\nimport { ArrowIcon, ControllerButton, css, Item, Menu } from \"../shared\";\n\nexport class SingleDownshift extends React.Component {\n  render() {\n    const { onChange, placeholder, items, selectedItem } = this.props;\n    return (\n      <Downshift onChange={onChange} selectedItem={selectedItem}>\n        {({\n          getInputProps,\n          getItemProps,\n          getLabelProps,\n          getMenuProps,\n          isOpen,\n          inputValue,\n          highlightedIndex,\n          selectedItem,\n          toggleMenu\n        }) => (\n          <div\n            style={{\n              margin: \"auto\",\n              position: \"relative\",\n              width: \"100%\"\n            }}\n          >\n            <div\n              {...css({\n                cursor: \"pointer\",\n                position: \"relative\",\n                padding: \".375rem .75rem\",\n                paddingRight: 50,\n                border: \"1px solid #ced4da\",\n                borderRadius: \".25rem\",\n                backgroundColor: \"white\"\n              })}\n              onClick={() => {\n                toggleMenu();\n              }}\n            >\n              <div\n                {...css({\n                  display: \"flex\",\n                  flexWrap: \"wrap\",\n                  alignItems: \"center\"\n                })}\n              >\n                {selectedItem ? (\n                  <div\n                    {...css({\n                      margin: \"0 2px\",\n                      paddingLeft: 8,\n                      paddingRight: 8,\n                      display: \"inline-block\",\n                      wordWrap: \"none\",\n                      backgroundColor: \"#ccc\",\n                      borderRadius: 2\n                    })}\n                  >\n                    <div\n                      {...css({\n                        display: \"grid\",\n                        gridGap: 6,\n                        gridAutoFlow: \"column\",\n                        alignItems: \"center\"\n                      })}\n                    >\n                      <span>{selectedItem}</span>\n                    </div>\n                  </div>\n                ) : (\n                  <span\n                    {...css({\n                      color: \"#6c757d;\"\n                    })}\n                  >\n                    {placeholder}\n                  </span>\n                )}\n              </div>\n              <ControllerButton>\n                <ArrowIcon isOpen={isOpen} />\n              </ControllerButton>\n            </div>\n            <Menu {...getMenuProps({ isOpen })}>\n              {isOpen\n                ? items.map((item, index) => (\n                    <Item\n                      key={index}\n                      {...getItemProps({\n                        item,\n                        index,\n                        isActive: highlightedIndex === index,\n                        isSelected: selectedItem === item\n                      })}\n                    >\n                      {item}\n                    </Item>\n                  ))\n                : null}\n            </Menu>\n          </div>\n        )}\n      </Downshift>\n    );\n  }\n}\n","import React, { Component, Fragment } from \"react\";\n\nexport class Accordion extends Component {\n  state = {\n    open: false,\n    toggle: this.toggle.bind(this)\n  };\n\n  toggle() {\n    this.setState({ open: !this.state.open });\n  }\n\n  render() {\n    return <Fragment>{this.props.children(this.state)}</Fragment>;\n  }\n}\n","import React, { Fragment } from \"react\";\nimport { SingleDownshift } from \"../Common/SingleDownshift\";\nimport { LOADING, withApplication } from \"../ApplicationContext\";\nimport isEmpty from \"lodash/isEmpty\";\nimport { AsyncMultiDownshift } from \"../Common/AsyncMultiDownshift\";\nimport { Accordion } from \"../Common/Accordion\";\nimport { withUser } from \"../Login/UserContext\";\n\nconst defaultState = {\n  movie: {\n    title: \"\",\n    genre: [],\n    type: \"\",\n    productionYear: \"\",\n    summary: \"\"\n  },\n  allocine: {\n    movies: [],\n    tvshows: []\n  }\n};\n\nconst headers = user => ({\n  Accept: \"application/json\",\n  \"Content-Type\": \"application/json\",\n  Authorization: `Bearer ${user.token}`\n});\n\nconst handleResponse = response => {\n  if (response.ok) return response.json();\n  throw new Error(\"Fetch fail\");\n};\n\nclass MovieFormWithContext extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      movie: props.movie ? props.movie : defaultState.movie,\n      allocine: defaultState.allocine\n    };\n  }\n\n  componentDidMount() {\n    // eslint-disable-next-line no-undef\n    $(\"#movie-creator-updator\").on(\"hide.bs.modal\", this.props.onClose);\n  }\n\n  valid = () => {\n    return (\n      !isEmpty(this.state.movie.title) &&\n      this.state.movie.genre.length > 0 &&\n      !isEmpty(this.state.movie.type)\n    );\n  };\n\n  add = () => {\n    fetch(\"/api/movies\", {\n      method: \"POST\",\n      body: JSON.stringify(this.state.movie),\n      headers: headers(this.props.user)\n    })\n      .then(handleResponse)\n      .then(data => {\n        this.props.onAdd({ ...this.state.movie, ...data });\n        // eslint-disable-next-line no-undef\n        $(\"#movie-creator-updator\").modal(\"hide\");\n      });\n  };\n\n  update = () => {\n    fetch(`/api/movies/${this.props.movie._id}`, {\n      method: \"PUT\",\n      body: JSON.stringify(this.state.movie),\n      headers: headers(this.props.user)\n    })\n      .then(handleResponse)\n      .then(data => {\n        this.props.onUpdate({ ...this.state.movie, ...data });\n        // eslint-disable-next-line no-undef\n        $(\"#movie-creator-updator\").modal(\"hide\");\n      });\n  };\n\n  search = () => {\n    Promise.all([\n      fetch(`/api/allocine?type=Film&title=${this.state.movie.title}`, {\n        headers: headers(this.props.user)\n      }).then(handleResponse),\n      fetch(`/api/allocine?type=Srie&title=${this.state.movie.title}`, {\n        headers: headers(this.props.user)\n      }).then(handleResponse)\n    ]).then(([movies, tvshows]) =>\n      this.setState({ allocine: { movies, tvshows } })\n    );\n  };\n\n  synchronizeMovieAllocine = idAllocine => {\n    // if click on the currently selected movie, unselect it\n    if (idAllocine === this.state.movie.idAllocine) {\n      this.setState({\n        movie: {\n          ...this.state.movie,\n          idAllocine: null\n        }\n      });\n    } else {\n      fetch(`/api/allocine/movie/${idAllocine}`, {\n        headers: headers(this.props.user)\n      })\n        .then(handleResponse)\n        .then(({ movie }) =>\n          this.setState({\n            movie: {\n              ...this.state.movie,\n              idAllocine,\n              title: movie.title,\n              genre: movie.genre.map(m => m.$).sort(),\n              type: \"Film\",\n              productionYear:\n                movie.release && movie.release.releaseDate\n                  ? new Date(movie.release.releaseDate).getFullYear()\n                  : movie.productionYear,\n              summary: movie.synopsis,\n              fileUrl: movie.poster ? movie.poster.href : \"\"\n            }\n          })\n        );\n    }\n  };\n\n  synchronizeTvShowAllocine = idAllocine => {\n    // if click on the currently selected movie, unselect it\n    if (idAllocine === this.state.movie.idAllocine) {\n      this.setState({\n        movie: {\n          ...this.state.movie,\n          idAllocine: null\n        }\n      });\n    } else {\n      fetch(`/api/allocine/serie/${idAllocine}`, {\n        headers: headers(this.props.user)\n      })\n        .then(handleResponse)\n        .then(({ tvseries }) =>\n          this.setState({\n            movie: {\n              ...this.state.movie,\n              idAllocine,\n              title: tvseries.title,\n              genre: tvseries.genre.map(m => m.$).sort(),\n              type: \"Srie\",\n              productionYear: tvseries.yearStart,\n              summary: tvseries.synopsis,\n              fileUrl: tvseries.poster ? tvseries.poster.href : \"\"\n            }\n          })\n        );\n    }\n  };\n\n  onInput = (field, transform = data => data) => {\n    return event =>\n      this.setState({\n        movie: { ...this.state.movie, [field]: transform(event.target.value) }\n      });\n  };\n\n  onSelect = field => {\n    return value =>\n      this.setState({ movie: { ...this.state.movie, [field]: value } });\n  };\n\n  render() {\n    const { movie } = this.state;\n    return (\n      <Fragment>\n        {this.props.application.status === LOADING ? (\n          <div>Loading...</div>\n        ) : (\n          <div\n            className=\"movie-modal modal fade movie-form\"\n            id=\"movie-creator-updator\"\n            tabIndex=\"-1\"\n            role=\"dialog\"\n            data-show=\"true\"\n          >\n            <div className=\"modal-dialog modal-dialog-centered\" role=\"document\">\n              <div className=\"modal-content\">\n                <div className=\"modal-header\">\n                  <h5 className=\"modal-title\">\n                    {(movie && movie.title) || \"New\"}\n                  </h5>\n                  <button\n                    type=\"button\"\n                    className=\"close\"\n                    data-dismiss=\"modal\"\n                    aria-label=\"Close\"\n                  >\n                    <span aria-hidden=\"true\">&times;</span>\n                  </button>\n                </div>\n                <div className=\"modal-body\">\n                  <div className=\"form-row\">\n                    <div className=\"form-group col-11\">\n                      <label htmlFor=\"title\">Title</label>\n                      <input\n                        type=\"text\"\n                        className=\"form-control\"\n                        id=\"title\"\n                        aria-describedby=\"title\"\n                        placeholder=\"Enter title\"\n                        onChange={this.onInput(\"title\")}\n                        value={this.state.movie.title}\n                      />\n                    </div>\n                    <div className=\"form-group col-1 text-center\">\n                      <i\n                        className=\"fab fa-angular fa-2x\"\n                        style={{\n                          cursor: \"pointer\",\n                          color: \"#fecc00\",\n                          paddingTop: \"35px\"\n                        }}\n                        onClick={this.search}\n                      />\n                    </div>\n                  </div>\n                  {this.state.allocine.movies.length > 0 ? (\n                    <Accordion>\n                      {({ open, toggle }) => {\n                        return (\n                          <Fragment>\n                            <div onClick={toggle} style={{ cursor: \"pointer\" }}>\n                              {this.state.allocine.movies.length} movies\n                              {open ? (\n                                <i className=\"fas fa-chevron-up\" />\n                              ) : (\n                                <i className=\"fas fa-chevron-down\" />\n                              )}\n                            </div>\n                            <div\n                              className=\"row\"\n                              style={{\n                                overflowX: \"scroll\",\n                                display: open ? \"flex\" : \"none\",\n                                flexWrap: \"nowrap\"\n                              }}\n                            >\n                              {this.state.allocine.movies.map(movie => (\n                                <div\n                                  key={movie.code}\n                                  className={`col-2 allocine-movie ${\n                                    movie.code === this.state.movie.idAllocine\n                                      ? \"selected\"\n                                      : \"\"\n                                  }`}\n                                  onClick={() =>\n                                    this.synchronizeMovieAllocine(movie.code)\n                                  }\n                                >\n                                  {movie.code ===\n                                  this.state.movie.idAllocine ? (\n                                    <i className=\"fas fa-check-circle selected-movie-icon fa-2x\" />\n                                  ) : null}\n                                  <div>\n                                    {movie.title} -{\" \"}\n                                    {movie.release && movie.release.releaseDate\n                                      ? new Date(\n                                          movie.release.releaseDate\n                                        ).getFullYear()\n                                      : movie.productionYear}\n                                  </div>\n                                  <div>\n                                    {movie.poster ? (\n                                      <img\n                                        src={movie.poster.href}\n                                        alt=\"movie poster\"\n                                        style={{ width: \"100%\" }}\n                                      />\n                                    ) : null}\n                                  </div>\n                                </div>\n                              ))}\n                            </div>\n                          </Fragment>\n                        );\n                      }}\n                    </Accordion>\n                  ) : null}\n                  {this.state.allocine.tvshows.length > 0 ? (\n                    <Accordion>\n                      {({ open, toggle }) => {\n                        return (\n                          <Fragment>\n                            <div onClick={toggle} style={{ cursor: \"pointer\" }}>\n                              {this.state.allocine.tvshows.length} tv shows\n                              {open ? (\n                                <i className=\"fas fa-chevron-up\" />\n                              ) : (\n                                <i className=\"fas fa-chevron-down\" />\n                              )}\n                            </div>\n                            <div\n                              className=\"row\"\n                              style={{\n                                overflowX: \"scroll\",\n                                display: open ? \"flex\" : \"none\",\n                                flexWrap: \"nowrap\"\n                              }}\n                            >\n                              {this.state.allocine.tvshows.map(tvshow => (\n                                <div\n                                  key={tvshow.code}\n                                  className={`col-2 allocine-movie ${\n                                    tvshow.code === this.state.movie.idAllocine\n                                      ? \"selected\"\n                                      : \"\"\n                                  }`}\n                                  onClick={() =>\n                                    this.synchronizeTvShowAllocine(tvshow.code)\n                                  }\n                                >\n                                  {tvshow.code ===\n                                  this.state.movie.idAllocine ? (\n                                    <i className=\"fas fa-check-circle selected-movie-icon fa-2x\" />\n                                  ) : null}\n                                  <div>\n                                    {tvshow.title} - {tvshow.yearStart}\n                                  </div>\n                                  <div>\n                                    {tvshow.poster ? (\n                                      <img\n                                        src={tvshow.poster.href}\n                                        alt=\"tvshow poster\"\n                                        style={{ width: \"100%\" }}\n                                      />\n                                    ) : null}\n                                  </div>\n                                </div>\n                              ))}\n                            </div>\n                          </Fragment>\n                        );\n                      }}\n                    </Accordion>\n                  ) : null}\n                  <div className=\"form-group\">\n                    <label>Genre</label>\n                    <AsyncMultiDownshift\n                      selectedItems={this.state.movie.genre}\n                      placeholder=\"Genre\"\n                      items={this.props.application.genres}\n                      handleChange={this.onSelect(\"genre\")}\n                    />\n                  </div>\n                  <div className=\"form-group\">\n                    <label>Type</label>\n                    <SingleDownshift\n                      selectedItem={this.state.movie.type}\n                      placeholder=\"Type\"\n                      items={this.props.application.types}\n                      onChange={this.onSelect(\"type\")}\n                    />\n                  </div>\n                  <div className=\"form-group\">\n                    <label htmlFor=\"production-year\">Production Year</label>\n                    <input\n                      type=\"number\"\n                      className=\"form-control\"\n                      id=\"production-year\"\n                      aria-describedby=\"production year\"\n                      placeholder=\"Enter production year\"\n                      onChange={this.onInput(\"productionYear\", data =>\n                        parseInt(data, 10)\n                      )}\n                      value={this.state.movie.productionYear}\n                    />\n                  </div>\n                  <div className=\"form-group\">\n                    <label htmlFor=\"summary\">Summary</label>\n                    <textarea\n                      className=\"form-control\"\n                      id=\"summary\"\n                      aria-describedby=\"summary\"\n                      placeholder=\"Enter summary\"\n                      onChange={this.onInput(\"summary\")}\n                      value={this.state.movie.summary}\n                    />\n                  </div>\n                </div>\n                <div className=\"modal-footer\">\n                  <button\n                    type=\"button\"\n                    className=\"btn btn-secondary\"\n                    data-dismiss=\"modal\"\n                  >\n                    Close\n                  </button>\n                  <button\n                    type=\"button\"\n                    disabled={!this.valid()}\n                    className=\"btn btn-primary\"\n                    onClick={this.state.movie._id ? this.update : this.add}\n                  >\n                    {movie._id ? \"Update\" : \"Save\"}\n                  </button>\n                </div>\n              </div>\n            </div>\n          </div>\n        )}\n      </Fragment>\n    );\n  }\n}\n\nexport const MovieForm = withApplication(withUser(MovieFormWithContext));\n","import React, { Fragment, useContext, useEffect, useState } from \"react\";\nimport { MovieCard } from \"./MovieCard\";\nimport isArray from \"lodash/isArray\";\nimport { ApplicationContext, LOADING } from \"../ApplicationContext\";\nimport { MoviesContext } from \"../Common/MoviesContext\";\nimport { MoviesFilter } from \"./MoviesFilter\";\nimport * as MovieAPI from \"../Common/MovieAPI\";\nimport { UserContext } from \"../Login/UserContext\";\nimport debounce from \"lodash/debounce\";\nimport { MovieForm } from \"./MovieForm\";\n\nconst newMovie = () => ({});\nconst getMovies = MovieAPI.getMovies(true);\n\nconst buildQuery = (filters, offset) => {\n  // can use lodash/partition to one line\n  const genres = filters.genres\n    .filter(genre => genre[1])\n    .map(genre => genre[0]);\n  const notGenres = filters.genres\n    .filter(genre => !genre[1])\n    .map(genre => genre[0]);\n  return Object.keys(filters)\n    .filter(key => key !== \"genres\") // handle genres manually)\n    .filter(\n      key =>\n        (!isArray(filters[key]) &&\n          filters[key] !== null &&\n          filters[key] !== \"\") ||\n        (isArray(filters[key]) && filters[key].length > 0)\n    )\n    .map(key => `${key}=${filters[key]}`)\n    .concat(\n      genres.length > 0 ? `genres=${genres.join(\",\")}` : \"\",\n      notGenres.length > 0 ? `notGenres=${notGenres.join(\",\")}` : \"\",\n      `offset=${offset}`\n    )\n    .filter(Boolean) // remove empty strings\n    .join(\"&\");\n};\n\nexport const List = () => {\n  // load contexts\n  const { status } = useContext(ApplicationContext);\n  const {\n    invalidate,\n    movies,\n    count,\n    addAll,\n    filters,\n    add,\n    update\n  } = useContext(MoviesContext);\n  const user = useContext(UserContext);\n\n  // create state\n  const [offset, setOffset] = useState(movies.length / filters.limit);\n  const [movie, setMovie] = useState(newMovie());\n  const [key, setKey] = useState(0);\n  // set to true otherwise when navigating back to the page, the loader is displayed\n  const [loaded, setLoaded] = useState(true);\n\n  //create actions\n  const loadMore = offset => {\n    // invalidate if there is a new search\n    if (offset === 0) {\n      invalidate();\n    }\n    setLoaded(false);\n    getMovies(buildQuery(filters, offset), user)\n      .then(addAll)\n      .then(() => {\n        setOffset(offset + 1); // useInc\n        setLoaded(true);\n      });\n  };\n  const showMovie = () => {\n    // ignore first trigger, needed for backward navigation\n    if (key > 0) {\n      // eslint-disable-next-line no-undef\n      $(\"#movie-creator-updator\").modal(\"show\");\n    }\n  };\n\n  // create effects\n  useEffect(\n    () => {\n      // useDebounce :)\n      const debouncedLoadMore = debounce(loadMore, 400, {\n        leading: false,\n        trailing: true\n      });\n      // no movies ? then automatically fetch some (note: every time a filter is updated, movies are cleaned up)\n      if (movies.length === 0) {\n        debouncedLoadMore(0);\n        setLoaded(false);\n      }\n      return () => debouncedLoadMore.cancel();\n    },\n    [filters]\n  );\n  useEffect(showMovie, [movie]);\n\n  // render\n  return (\n    <div>\n      {status === LOADING ? (\n        <h2 className=\"text-center mt-2\">\n          <i className=\"fas fa-spinner fa-spin fa-2x\" />\n        </h2>\n      ) : (\n        <Fragment>\n          <MovieForm\n            // force reinitialisation of movie form\n            key={movie._id || key}\n            movie={movie._id ? movie : null}\n            onAdd={movie => add(movie)}\n            onUpdate={movie => update(movie._id, movie)}\n          />\n          <i\n            onClick={() => {\n              setMovie(newMovie());\n              setKey(key + 1);\n            }}\n            className=\"fas fa-plus-circle fa-3x\"\n            style={{\n              top: \"22px\",\n              left: \"22px\",\n              position: \"absolute\",\n              color: \"#F1F7EE\",\n              cursor: \"pointer\"\n            }}\n            title=\"Add a movie or a tv show\"\n          />\n          <MoviesFilter />\n          <h2 className=\"text-center\">\n            {movies.length === count && count > 0 ? (\n              <span>{count} movies/tvshows</span>\n            ) : movies.length < count ? (\n              <span>\n                {movies.length} of {count} movies/tvshows\n              </span>\n            ) : loaded ? (\n              <span> No movies/tvshows</span>\n            ) : null}\n          </h2>\n          <div className=\"movies\">\n            {movies.map(movie => (\n              <MovieCard\n                key={movie._id}\n                movie={movie}\n                onChange={movie => update(movie._id, movie)}\n                onDelete={_ => update(movie._id, undefined)}\n                onEdit={() => {\n                  setMovie({\n                    ...movie // create a new movie to force the show effect to be displayed\n                  });\n                  setKey(key + 1); // mandatory otherwise first edit fail\n                }}\n              />\n            ))}\n          </div>\n          <h2 className=\"text-center mt-2\">\n            {!loaded ? (\n              <span>\n                <i className=\"fas fa-spinner fa-spin fa-2x\" />\n              </span>\n            ) : null}\n          </h2>\n          {movies.length < count ? (\n            <div className=\"text-center m-3\">\n              <button\n                onClick={() => loadMore(offset)}\n                className=\"btn btn-primary btn-lg\"\n              >\n                Load more\n              </button>\n            </div>\n          ) : (\n            undefined\n          )}\n        </Fragment>\n      )}\n    </div>\n  );\n};\n","import React, { Fragment, useState } from \"react\";\nimport identity from \"lodash/identity\";\n\nconst EditableField = props => {\n  const [value, setValue] = useState(props.value || \"\");\n  const [edit, setEdit] = useState(!props.value);\n  const transform = props.transform || identity;\n  const lock = props.lock || false;\n  return (\n    <Fragment>\n      {!lock && edit ? (\n        <Fragment>\n          {props.renderFormField({\n            ...props,\n            value,\n            onChange: event => setValue(transform(event.target.value))\n          })}\n          <button\n            className=\"btn btn-primary\"\n            onClick={event => {\n              event.preventDefault();\n              event.stopPropagation();\n              if (value) {\n                props.onChange(value);\n                setEdit(false);\n              }\n            }}\n          >\n            OK\n          </button>\n        </Fragment>\n      ) : (\n        <Fragment>\n          {props.renderValue({\n            className: props.className,\n            value,\n            onClick: event => {\n              if (!lock) {\n                event.preventDefault();\n                event.stopPropagation();\n                setEdit(true);\n              }\n            }\n          })}\n        </Fragment>\n      )}\n    </Fragment>\n  );\n};\n\nexport const EditableInput = props => (\n  <EditableField\n    {...props}\n    renderFormField={fieldProps => (\n      <input\n        placeholder={fieldProps.placeholder}\n        type=\"text\"\n        value={fieldProps.value}\n        onChange={fieldProps.onChange}\n        onClick={event => {\n          event.preventDefault();\n          event.stopPropagation();\n        }}\n      />\n    )}\n    renderValue={valueProps => (\n      <span onClick={valueProps.onClick} className={valueProps.className}>\n        {valueProps.value}\n      </span>\n    )}\n  />\n);\n\nexport const EditableTextarea = props => (\n  <EditableField\n    {...props}\n    renderFormField={fieldProps => (\n      <textarea\n        placeholder={fieldProps.placeholder}\n        style={fieldProps.style}\n        value={fieldProps.value}\n        rows={fieldProps.rows || 2}\n        onChange={fieldProps.onChange}\n        onClick={event => {\n          event.preventDefault();\n          event.stopPropagation();\n        }}\n      />\n    )}\n    renderValue={valueProps => (\n      <span onClick={valueProps.onClick} className={valueProps.className}>\n        {props.split ? (\n          valueProps.value.split(\"\\n\").map((item, key) => (\n            <Fragment key={key}>\n              {item}\n              <br />\n            </Fragment>\n          ))\n        ) : (\n          <Fragment>{valueProps.value}</Fragment>\n        )}\n      </span>\n    )}\n  />\n);\n","import { EditableInput, EditableTextarea } from \"../../Common/EditableField\";\nimport React, { useContext, useState } from \"react\";\nimport { UserContext } from \"../../Login/UserContext\";\nimport { produce } from \"immer\";\nimport * as MovieAPI from \"../../Common/MovieAPI\";\nimport { MovieContext } from \"../Movie\";\nimport { SeasonContext } from \"./Season\";\n\nexport const Episode = ({ episode, index, onEpisodeChanged }) => {\n  // get contexts\n  const user = useContext(UserContext);\n  const { movie, lock } = useContext(MovieContext);\n  const { season, index: seasonIndex } = useContext(SeasonContext);\n  const [ellipsis, setEllipsis] = useState(\"ellipsis\");\n\n  // actions\n  const updateSeason = transform => {\n    const newMovie = produce(movie, transform);\n    const season = newMovie.seasons[seasonIndex];\n    // onEpisodeChanged(newMovie);\n    MovieAPI.updateSeason(newMovie, season, user).then(onEpisodeChanged);\n  };\n  const updateEpisode = transform => {\n    const newMovie = produce(movie, transform);\n    const season = newMovie.seasons[seasonIndex];\n    const episode = season.episodes[index];\n    MovieAPI.updateEpisode(newMovie, season, episode, user).then(\n      onEpisodeChanged\n    );\n  };\n\n  return (\n    <div className=\"row episode mr-0 ml-0\">\n      <div className=\" col-md-12 col-xl-2 align-items-center d-flex p-0\">\n        {!lock && (\n          <i\n            className=\"fas fa-times delete-episode\"\n            onClick={event => {\n              event.preventDefault();\n              event.stopPropagation();\n              if (window.confirm(\"Delete episode ?\")) {\n                MovieAPI.deleteEpisode(movie, season, episode, user).then(\n                  onEpisodeChanged\n                );\n              }\n            }}\n          />\n        )}\n        <div\n          className=\"text-center col-1\"\n          style={{\n            color: episode.seen ? \"var(--success)\" : \"\",\n            fontWeight: episode.seen ? \"bold\" : \"\",\n            cursor: \"pointer\"\n          }}\n          onClick={() =>\n            updateSeason(movie => {\n              if (!movie.seasons[seasonIndex].episodes[index].seen) {\n                for (let i = 0; i <= index; i++) {\n                  movie.seasons[seasonIndex].episodes[i].seen = true;\n                }\n              } else {\n                movie.seasons[seasonIndex].episodes[index].seen = false;\n              }\n            })\n          }\n        >\n          {index + 1}\n        </div>\n        <div className=\"text-center col-11\">\n          <EditableInput\n            lock={lock}\n            className={`font-weight-bold episode-title ${\n              episode.seen ? \"seen\" : \"\"\n            }`}\n            value={episode.title}\n            placeholder=\"Title\"\n            onChange={title =>\n              updateEpisode(movie => {\n                movie.seasons[seasonIndex].episodes[index].title = title;\n              })\n            }\n          />\n        </div>\n      </div>\n      <div className=\"col-md-12 col-xl-10 align-items-center d-flex\">\n        <EditableTextarea\n          lock={lock}\n          style={{ width: \"100%\" }}\n          rows={4}\n          value={episode.summary}\n          placeholder=\"Summary\"\n          className={`${ellipsis} d-block episode-summary w-100 text-left`}\n          onChange={summary =>\n            updateEpisode(movie => {\n              movie.seasons[seasonIndex].episodes[index].summary = summary;\n            })\n          }\n        />\n        {ellipsis && (\n          <span style={{ cursor: \"pointer\" }} onClick={() => setEllipsis(\"\")}>\n            <i className=\"fas fa-question-circle\" />\n          </span>\n        )}\n      </div>\n    </div>\n  );\n};\n","import { useState } from \"react\";\n\nexport const useToggle = (initialValue = false) => {\n  const [value, setValue] = useState(initialValue);\n  const toggle = () => setValue(!value);\n  return [value, toggle];\n};\n\nexport const useInput = (initialValue = \"\") => {\n  const [value, setValue] = useState(initialValue);\n  return [\n    {\n      value,\n      onChange: event => setValue(event.target.value)\n    },\n    setValue\n  ];\n};\n","import { useContext, Fragment } from \"react\";\nimport { EditableInput } from \"../../Common/EditableField\";\nimport * as MovieAPI from \"../../Common/MovieAPI\";\nimport React from \"react\";\nimport { produce } from \"immer\";\nimport { UserContext } from \"../../Login/UserContext\";\nimport \"./Season.css\";\nimport { MovieSeen } from \"../../Common/MovieSeen\";\nimport { Episode } from \"./Episode\";\nimport every from \"lodash/every\";\nimport some from \"lodash/some\";\nimport { useToggle } from \"../../Common/hooks\";\nimport { MovieContext } from \"../../Movie/Movie\";\n\nexport const SeasonContext = React.createContext({});\n\nexport const Season = ({ season, index, onMovieChanged }) => {\n  // get contexts\n  const user = useContext(UserContext);\n  const { movie, lock } = useContext(MovieContext);\n  const [open, toggle] = useToggle();\n\n  // actions\n  const updateSeason = transform => {\n    const newMovie = produce(movie, transform);\n    const season = newMovie.seasons[index];\n    MovieAPI.updateSeason(newMovie, season, user).then(onMovieChanged);\n  };\n\n  const seen = every(season.episodes, \"seen\") && season.episodes.length > 0;\n  const oneSeen = some(season.episodes, \"seen\") && season.episodes.length > 0;\n\n  return (\n    <div className=\"season\">\n      <div className=\"season-header\" onClick={toggle}>\n        <div>\n          <div\n            className=\"season-header-view\"\n            onClick={event => {\n              event.preventDefault();\n              event.stopPropagation();\n              updateSeason(movie => {\n                movie.seasons[index].seen = !seen;\n              });\n            }}\n          >\n            <MovieSeen seen={seen} partial={oneSeen} />\n          </div>\n          {!lock && (\n            <i\n              className=\"fas fa-times delete-season\"\n              onClick={event => {\n                event.preventDefault();\n                event.stopPropagation();\n                if (window.confirm(\"Delete season ?\")) {\n                  MovieAPI.deleteSeason(movie, season, user).then(\n                    onMovieChanged\n                  );\n                }\n              }}\n            />\n          )}\n          &nbsp;Season {index + 1}\n          &nbsp;-&nbsp;\n          <EditableInput\n            lock={lock}\n            placeholder=\"YYYY\"\n            value={season.productionYear}\n            transform={value => parseInt(value, 10)}\n            onChange={productionYear =>\n              updateSeason(movie => {\n                movie.seasons[index].productionYear = productionYear;\n              })\n            }\n          />\n        </div>\n        <div className=\"season-header-arrow\">\n          {open ? (\n            <i className=\"fas fa-chevron-up\" />\n          ) : (\n            <i className=\"fas fa-chevron-down\" />\n          )}\n        </div>\n      </div>\n      <div className=\"episodes\">\n        <SeasonContext.Provider value={{ season, index }}>\n          {open &&\n            season.episodes.map((episode, episodeIndex) => (\n              <Episode\n                key={episode._id}\n                episode={episode}\n                index={episodeIndex}\n                onEpisodeChanged={onMovieChanged}\n              />\n            ))}\n        </SeasonContext.Provider>\n      </div>\n\n      {!lock ? (\n        <Fragment>\n          {open && (\n            <button\n              className=\"btn btn-primary\"\n              onClick={() =>\n                MovieAPI.addEpisode(movie, season, user).then(onMovieChanged)\n              }\n            >\n              <i className=\"fas fa-plus\" />\n              &nbsp;Add episode\n            </button>\n          )}\n        </Fragment>\n      ) : (\n        undefined\n      )}\n    </div>\n  );\n};\n","import React, { Fragment, useContext, useEffect, useState } from \"react\";\nimport { withRouter } from \"react-router-dom\";\nimport * as MovieAPI from \"../Common/MovieAPI\";\nimport { UserContext } from \"../Login/UserContext\";\nimport { MovieSeen } from \"../Common/MovieSeen\";\nimport { MoviesContext } from \"../Common/MoviesContext\";\nimport { produce } from \"immer\";\nimport { Season } from \"./Season/Season\";\nimport { EditableTextarea } from \"../Common/EditableField\";\nimport { useToggle } from \"../Common/hooks\";\nimport \"./Movie.css\";\nimport { ApplicationContext } from \"../ApplicationContext\";\nimport { Tag } from \"../Admin/Tag\";\n\nexport const MovieContext = React.createContext({});\n\nconst MovieTag = ({ tag, selected, onAdd, onDelete, lock }) =>\n  !lock ? (\n    <span onClick={selected ? onDelete : onAdd}>\n      <Tag\n        {...tag}\n        className={`movie-tag mr-2 ${selected ? \"selected\" : \"\"}`}\n      />\n    </span>\n  ) : selected ? (\n    <Tag {...tag} className={`mr-2 selected`} />\n  ) : null;\n\nexport const Movie = withRouter(({ match, history }) => {\n  // get contexts\n  const user = useContext(UserContext);\n  const movies = useContext(MoviesContext);\n  const { tags } = useContext(ApplicationContext);\n  // create state\n  const [movie, setMovie] = useState();\n  const [lock, toggle] = useToggle(true);\n\n  // create effects\n  useEffect(() => MovieAPI.getMovie(match.params.id, user).then(setMovie), [\n    match.params.id\n  ]);\n\n  // create actions\n  const updateMovie = transform => () => {\n    MovieAPI.updateMovie(produce(movie, transform), user).then(mergeContext);\n  };\n\n  // helper\n  const mergeContext = updatedMovie => {\n    setMovie(updatedMovie);\n    movies.update(updatedMovie._id, updatedMovie);\n  };\n\n  return (\n    <div className=\"container movie-container\">\n      {!movie ? (\n        <h2 className=\"text-center mt-2\">\n          <i className=\"fas fa-spinner fa-spin fa-2x\" />\n        </h2>\n      ) : (\n        <Fragment>\n          <i\n            onClick={() => history.goBack()}\n            className=\"fas fa-arrow-circle-left fa-3x\"\n            style={{\n              top: \"22px\",\n              left: \"22px\",\n              position: \"absolute\",\n              color: \"#F1F7EE\",\n              cursor: \"pointer\"\n            }}\n            title=\"Return to the list of movies\"\n          />\n          <div\n            className=\"p-5 mt-3 single-movie-card\"\n            style={{ position: \"relative\" }}\n          >\n            <i\n              onClick={toggle}\n              className={`fas ${lock ? \"fa-lock\" : \"fa-lock-open\"} fa-2x`}\n              style={{\n                color: \"var(--movie-secondary)\",\n                position: \"absolute\",\n                top: \"5px\",\n                right: \"5px\",\n                cursor: \"pointer\"\n              }}\n              title={`Click to ${\n                lock ? \"open\" : \"close\"\n              } movie for modifications`}\n            />\n            <div className=\"d-flex justify-content-center\">\n              <div>\n                <img\n                  src={movie.fileUrl}\n                  style={{ maxHeight: \"300px\" }}\n                  alt=\"movie poster\"\n                />\n                <div className=\"mt-2\">\n                  {tags.map(tag => (\n                    <MovieTag\n                      key={tag._id}\n                      tag={tag}\n                      lock={lock}\n                      selected={movie.tags.find(\n                        movieTag => movieTag === tag._id\n                      )}\n                      onAdd={updateMovie(movie => {\n                        movie.tags.push(tag._id);\n                      })}\n                      onDelete={updateMovie(movie => {\n                        movie.tags = movie.tags.filter(\n                          movieTag => movieTag !== tag._id\n                        );\n                      })}\n                    />\n                  ))}\n                </div>\n              </div>\n              <div className=\"pl-2 d-flex flex-column\" style={{ flexGrow: 1 }}>\n                <h1 className=\"text-center\">\n                  {movie.title} - {movie.productionYear}\n                </h1>\n                <h6 className=\"text-center single-movie-subtitle\">\n                  {movie.genre.join(\",\")}\n                </h6>\n                <div>\n                  <EditableTextarea\n                    split={true}\n                    lock={lock}\n                    value={movie.summary}\n                    style={{ width: \"100%\" }}\n                    placeholder=\"Summary\"\n                    rows=\"7\"\n                    onChange={summary =>\n                      updateMovie(movie => {\n                        movie.summary = summary;\n                      })()\n                    }\n                  />\n                </div>\n              </div>\n            </div>\n            <div>\n              {movie.type === \"Film\" ? (\n                <MovieSeen\n                  seen={movie.seen}\n                  onClick={updateMovie(movie => {\n                    movie.seen = !movie.seen;\n                  })}\n                />\n              ) : (\n                undefined\n              )}\n            </div>\n            <div className=\"text-center\">\n              {movie.type !== \"Film\" ? (\n                <Fragment>\n                  <MovieContext.Provider value={{ lock, movie }}>\n                    <div>\n                      {movie.seasons.map((season, seasonIndex) => (\n                        <Season\n                          key={seasonIndex}\n                          season={season}\n                          index={seasonIndex}\n                          onMovieChanged={mergeContext}\n                        />\n                      ))}\n                    </div>\n                  </MovieContext.Provider>\n                  {!lock ? (\n                    <button\n                      className=\"btn btn-primary\"\n                      onClick={() =>\n                        MovieAPI.addSeason(movie, user).then(mergeContext)\n                      }\n                    >\n                      <i className=\"fas fa-plus\" />\n                      &nbsp;Add season\n                    </button>\n                  ) : (\n                    undefined\n                  )}\n                </Fragment>\n              ) : (\n                undefined\n              )}\n            </div>\n          </div>\n        </Fragment>\n      )}\n    </div>\n  );\n});\n","import React, { Component, Fragment } from \"react\";\nimport debounce from \"lodash/debounce\";\nimport { withUser } from \"../Login/UserContext\";\n\nexport const LOADING = Symbol(\"LOADING\");\nexport const LOADED = Symbol(\"LOADED\");\n\nconst headers = user => ({\n  Accept: \"application/json\",\n  \"Content-Type\": \"application/json\",\n  Authorization: `Bearer ${user.token}`\n});\nconst handleResponse = response => {\n  if (response.ok) return response.json();\n  throw new Error(\"Fetch fail\");\n};\n\nclass FetchWithContext extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      status: LOADING,\n      data: undefined\n    };\n\n    // TODO probably not the best place to debounce\n    this.debounceFetch = debounce(this.fetch, this.props.debounce || 0, {\n      leading: false,\n      trailing: true\n    });\n  }\n\n  componentWillUnmount() {\n    this.debounceFetch.cancel();\n  }\n\n  fetch() {\n    return fetch(`${this.props.endpoint}`, {\n      headers: headers(this.props.user)\n    })\n      .then(handleResponse)\n      .then(data => {\n        this.setState({\n          status: LOADED,\n          data\n        });\n        this.props.onSuccess && this.props.onSuccess(data);\n      });\n  }\n\n  componentDidMount() {\n    this.debounceFetch();\n  }\n\n  render() {\n    return (\n      <Fragment>\n        {this.props.children({\n          status: this.state.status,\n          data: this.state.data\n        })}\n      </Fragment>\n    );\n  }\n}\n\n/**\n * - create a context that holds movies\n * - dont load if there is already sth in the context\n * - pass initial data to prevent fetch the api (if data, dont fetch on cDM)\n */\n\nexport const Fetch = withUser(FetchWithContext);\n","import { Fetch } from \"./Common/Fetch\";\nimport React from \"react\";\nimport { Link } from \"react-router-dom\";\n\nexport const Header = () => {\n  return (\n    <div\n      className=\"text-center\"\n      style={{\n        backgroundColor: \"var(--movie-secondary)\",\n        color: \"var(--movie-primary)\",\n        padding: \"4px\"\n      }}\n    >\n      <h1 className=\"header\">\n        <Link to=\"/\">Cinematheque</Link>\n      </h1>\n      <Fetch endpoint=\"/api/movies?limit=0\">\n        {({ data }) => <h6>{data ? data.count : 0} movies/tvshows</h6>}\n      </Fetch>\n      <Link to=\"/stats\">\n        <i\n          className=\"fas fa-chart-bar fa-3x\"\n          style={{\n            top: \"22px\",\n            right: \"22px\",\n            position: \"absolute\",\n            color: \"#F1F7EE\",\n            cursor: \"pointer\"\n          }}\n          title=\"Show statistics\"\n        />\n      </Link>\n    </div>\n  );\n};\n","import React, { Fragment, useContext, useEffect, useState } from \"react\";\nimport { ApplicationContext } from \"../ApplicationContext\";\nimport * as MovieAPI from \"../Common/MovieAPI\";\nimport \"./Statistics.css\";\nimport { produce } from \"immer\";\nimport { UserContext } from \"../Login/UserContext\";\nimport orderBy from \"lodash/orderBy\";\nimport { Tag } from \"../Admin/Tag\";\nconst getMovies = MovieAPI.getMovies(false);\n\nconst initialState = (types, genres, tags) => {\n  return {\n    types: types.map(type => ({\n      name: type,\n      count: 0,\n      genres: genres.map(genre => ({\n        name: genre,\n        count: 0,\n        seen: 0,\n        unseen: 0\n      }))\n    })),\n    tags: tags.map(tag => ({\n      name: tag.label,\n      color: tag.color,\n      count: 0\n    }))\n  };\n};\n\nexport const Statistics = () => {\n  // get contexts\n  const user = useContext(UserContext);\n  const { genres, types, tags } = useContext(ApplicationContext);\n  const [stats, setStats] = useState(initialState(types, genres, tags));\n\n  // actions\n  const fetchByTypes = (types, genres) => {\n    types.forEach(type =>\n      getMovies(`types=${type}&limit=0`, user)\n        .then(data =>\n          setStats(\n            produce(\n              draft =>\n                void (draft.types.find(t => type === t.name).count = data.count)\n            )\n          )\n        )\n        .then(() =>\n          genres.forEach(genre => {\n            getMovies(`types=${type}&genres=${genre}&limit=0`, user).then(\n              data =>\n                setStats(\n                  produce(\n                    draft =>\n                      void (draft.types\n                        .find(t => type === t.name)\n                        .genres.find(g => genre === g.name).count = data.count)\n                  )\n                )\n            );\n            getMovies(\n              `types=${type}&genres=${genre}&seen=true&limit=0`,\n              user\n            ).then(data =>\n              setStats(\n                produce(\n                  draft =>\n                    void (draft.types\n                      .find(t => type === t.name)\n                      .genres.find(g => genre === g.name).seen = data.count)\n                )\n              )\n            );\n            getMovies(\n              `types=${type}&genres=${genre}&seen=false&limit=0`,\n              user\n            ).then(data =>\n              setStats(\n                produce(\n                  draft =>\n                    void (draft.types\n                      .find(t => type === t.name)\n                      .genres.find(g => genre === g.name).unseen = data.count)\n                )\n              )\n            );\n          })\n        )\n    );\n  };\n\n  const fetchByTags = tags => {\n    tags.forEach(tag =>\n      getMovies(`tags=${tag.label}&limit=0`, user).then(data =>\n        setStats(\n          produce(draft => {\n            draft.tags.find(t => tag.label === t.name).count += data.count;\n          })\n        )\n      )\n    );\n  };\n\n  // effects\n  useEffect(\n    () => {\n      setStats(initialState(types, genres, tags));\n      fetchByTypes(types, genres);\n      fetchByTags(tags, types);\n    },\n    [types, genres, tags]\n  );\n\n  return (\n    <div className=\"d-flex justify-content-around flex-wrap mb-4\">\n      {stats.types.map((type, index) => (\n        <div className=\"card stat-card\" key={index}>\n          <div className=\"card-body\">\n            <h5 className=\"card-title text-center\">\n              {type.count} {type.name}\n            </h5>\n            <div>\n              {orderBy(type.genres, [\"count\"], [\"desc\"]).map((genre, index) => (\n                <Fragment key={index}>\n                  <div>\n                    {\" \"}\n                    {genre.count} {genre.name} ({\" \"}\n                    {genre.count\n                      ? ((genre.seen * 100) / genre.count).toFixed(2)\n                      : 0}\n                    % seen){\" \"}\n                  </div>\n                  <div className=\"movie-progress\">\n                    <div\n                      className=\"progress-bar unseen\"\n                      role=\"progressbar\"\n                      style={{\n                        width: `calc(20px + ${(genre.unseen * 100) /\n                          orderBy(type.genres, [\"count\"], [\"desc\"])[0].count}%)`\n                      }}\n                    >\n                      {genre.unseen}\n                    </div>\n                    {genre.count - genre.unseen - genre.seen ? (\n                      <div\n                        className=\"progress-bar pending\"\n                        role=\"progressbar\"\n                        style={{\n                          width: `calc(20px + ${((genre.count -\n                            genre.unseen -\n                            genre.seen) *\n                            100) /\n                            orderBy(type.genres, [\"count\"], [\"desc\"])[0]\n                              .count}%)`\n                        }}\n                      >\n                        {genre.count - genre.unseen - genre.seen}\n                      </div>\n                    ) : (\n                      undefined\n                    )}\n                    <div\n                      className=\"progress-bar seen\"\n                      role=\"progressbar\"\n                      style={{\n                        width: `calc(20px + ${(genre.seen * 100) /\n                          orderBy(type.genres, [\"count\"], [\"desc\"])[0].count}%)`\n                      }}\n                    >\n                      {genre.seen}\n                    </div>\n                  </div>\n                </Fragment>\n              ))}\n            </div>\n          </div>\n        </div>\n      ))}\n      <div className=\"card stat-card stat-tags-card\">\n        <div className=\"card-body align-content-center\">\n          {stats.tags.map((tag, index) => (\n            <h5 className=\"text-center stat-tags-card-card mt-1\" key={index}>\n              <Tag label={`${tag.count} ${tag.name}`} color={tag.color} />\n            </h5>\n          ))}\n        </div>\n      </div>\n    </div>\n  );\n};\n","import React, { useEffect, useState, useContext } from \"react\";\nimport \"./TagList.css\";\nimport { useInput } from \"../Common/hooks\";\nimport { createTag, deleteTag } from \"../Common/TagAPI\";\nimport { UserContext } from \"../Login/UserContext\";\nimport { Tag } from \"./Tag\";\nimport { ApplicationContext } from \"../ApplicationContext\";\n\nconst random = max => {\n  return Math.floor(Math.random() * Math.floor(max));\n};\nconst generateColor = () => {\n  return `#${random(256)\n    .toString(16)\n    .padStart(2, \"0\")}${random(256)\n    .toString(16)\n    .padStart(2, \"0\")}${random(256)\n    .toString(16)\n    .padStart(2, \"0\")}`;\n};\n\nexport const TagList = () => {\n  // get context\n  const user = useContext(UserContext);\n  const { tags, set } = useContext(ApplicationContext);\n  const setTags = set(\"tags\");\n\n  // create state\n  const [color, setColor] = useInput(generateColor());\n  const [label, setLabel] = useInput(\"\");\n\n  return (\n    <div className=\"container tags-card\">\n      {tags.map(tag => (\n        <div\n          key={tag._id}\n          className=\"mt-2 mb-2 d-flex\"\n          style={{\n            overflow: \"hidden\" // Collapsing margins\n          }}\n        >\n          {/* avoid the tag element to fill up all the available height */}\n          <div>\n            <Tag {...tag} big />\n          </div>\n          <button\n            type=\"button\"\n            className=\"btn btn-danger ml-2\"\n            onClick={event => {\n              event.preventDefault();\n              event.stopPropagation();\n              if (window.confirm(\"Delete tag ?\")) {\n                deleteTag(tag, user).then(_ =>\n                  setTags(tags => tags.filter(t => t._id !== tag._id))\n                );\n              }\n            }}\n          >\n            <i className=\"fas fa-times\" />\n          </button>\n        </div>\n      ))}\n      <form className=\"form-inline\">\n        <input type=\"color\" className=\"form-control colorpicker\" {...color} />\n        <input\n          type=\"text\"\n          className=\"form-control ml-2\"\n          placeholder=\"Label\"\n          {...label}\n        />\n        <button\n          type=\"button\"\n          className=\"btn btn-info btn-sm ml-2\"\n          onClick={() => {\n            setColor(generateColor());\n          }}\n        >\n          <i className=\"fas fa-sync-alt\" />\n        </button>\n        <button\n          type=\"button\"\n          className=\"btn btn-primary btn-sm ml-2\"\n          onClick={() => {\n            createTag(\n              {\n                label: label.value,\n                color: color.value\n              },\n              user\n            )\n              .then(tag => setTags(tags => [...tags, tag]))\n              .then(_ => {\n                setColor(generateColor());\n                setLabel(\"\");\n              });\n          }}\n          disabled={\n            !label.value ||\n            tags.find(\n              tag => tag.label.toLowerCase() === label.value.toLowerCase()\n            )\n          }\n        >\n          <i className=\"fas fa-check\" />\n        </button>\n        <Tag\n          style={{ marginLeft: \"auto\" }}\n          color={color.value}\n          label={label.value || \"Label\"}\n        />\n      </form>\n    </div>\n  );\n};\n","import React, { Component, Fragment } from \"react\";\nimport { BrowserRouter as Router, Route } from \"react-router-dom\";\nimport \"./App.css\";\nimport { List } from \"./MovieList/List\";\nimport { Movie } from \"./Movie/Movie\";\nimport { Header } from \"./Header\";\nimport { Statistics } from \"./Statistics/Statistics\";\nimport { TagList } from \"./Admin/TagList\";\n\nclass App extends Component {\n  render() {\n    return (\n      <Fragment>\n        <Router>\n          <Fragment>\n            <Header />\n            <Route exact path=\"/\" component={List} />\n            <Route exact path=\"/movie/:id\" component={Movie} />\n            <Route exact path=\"/stats\" component={Statistics} />\n            <Route exact path=\"/admin\" component={TagList} />\n          </Fragment>\n        </Router>\n      </Fragment>\n    );\n  }\n}\n\nexport default App;\n","import React, { Component } from \"react\";\nimport { LOGIN_FAILED, withUser } from \"./UserContext\";\n\nclass LoginWithContext extends Component {\n  state = {\n    password: \"\"\n  };\n\n  render() {\n    return (\n      <div>\n        {this.props.user.status === LOGIN_FAILED ? (\n          <div className=\"alert alert-danger\" role=\"alert\">\n            Login failed\n          </div>\n        ) : (\n          undefined\n        )}\n        <div className=\"form-group\">\n          <label htmlFor=\"password\">Password</label>\n          <input\n            type=\"text\"\n            className=\"form-control\"\n            id=\"password\"\n            aria-describedby=\"password\"\n            placeholder=\"Enter password\"\n            value={this.state.password}\n            onChange={event => this.setState({ password: event.target.value })}\n            onKeyDown={event => {\n              if (event.key === \"Enter\")\n                this.props.user.login(this.state.password);\n            }}\n          />\n        </div>\n        <button\n          type=\"button\"\n          className=\"btn btn-primary\"\n          onClick={() => this.props.user.login(this.state.password)}\n        >\n          Submit\n        </button>\n      </div>\n    );\n  }\n}\n\nexport const Login = withUser(LoginWithContext);\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport \"./index.css\";\nimport App from \"./App\";\nimport { ApplicationProvider } from \"./ApplicationContext\";\nimport { UserProvider, UserContext } from \"./Login/UserContext\";\nimport { Login } from \"./Login/Login\";\nimport { MoviesProvider } from \"./Common/MoviesContext\";\n\nReactDOM.render(\n  <UserProvider>\n    <UserContext.Consumer>\n      {({ token }) =>\n        token ? (\n          <ApplicationProvider token={token}>\n            <MoviesProvider>\n              <App />\n            </MoviesProvider>\n          </ApplicationProvider>\n        ) : (\n          <Login />\n        )\n      }\n    </UserContext.Consumer>\n  </UserProvider>,\n  document.getElementById(\"root\")\n);\n"],"sourceRoot":""}
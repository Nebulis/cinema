{"version":3,"sources":["Common/MovieAPI.js","Common/MovieSeen.js","Login/UserContext.js","Common/TagAPI.js","ApplicationContext.js","Admin/Tag.js","MovieList/MovieCard.jsx","Common/MoviesContext.js","Common/MultiDownshift.jsx","shared.js","Common/MultiDownshiftWithReverse.jsx","Common/AsyncMultiDownshift.jsx","MovieList/MoviesFilter.js","Common/SingleDownshift.jsx","Common/Accordion.jsx","MovieList/MovieForm.jsx","MovieList/List.js","Common/EditableField.js","Notifications/NotificationContext.js","Movie/Season/Episode.js","Common/hooks.js","Movie/Season/Season.js","Movie/Movie.js","Common/Fetch.jsx","Header.js","Statistics/Statistics.js","Admin/tag.utils.js","Admin/TagListElement.js","Admin/TagList.js","Notifications/Notification.js","Notifications/NotificationsList.js","App.js","Login/Login.js","index.js"],"names":["controller","MovieSeen","_ref","seen","onClick","_ref$partial","partial","react_default","a","createElement","className","style","color","cursor","headers","user","Accept","Content-Type","Authorization","concat","token","handleResponse","response","ok","json","Error","getMovie","id","fetch","then","getMovies","abortable","search","abort","AbortController","signal","updateMovie","movie","_id","method","body","JSON","stringify","addSeason","updateSeason","season","addEpisode","UserContext","React","createContext","withUser","Component","props","Consumer","Object","assign","LOGOUT","Symbol","LOGIN","LOGIN_FAILED","UserProvider","_React$Component","_getPrototypeOf2","_this","classCallCheck","this","_len","arguments","length","args","Array","_key","possibleConstructorReturn","getPrototypeOf","call","apply","state","status","login","bind","assertThisInitialized","inherits","createClass","key","value","_this2","localStorage","getItem","exp","Date","setState","password","_this3","_ref2","setItem","catch","Provider","children","ApplicationContext","LOADING","LOADED","ApplicationProvider","set","field","fn","objectSpread","defineProperty","genres","types","tags","options","Promise","all","slicedToArray","Tag","hex","label","big","_ref$className","_ref$style","_ref$onClick","backgroundColor","indexOf","slice","parseInt","MovieCard","onEdit","onChange","onDelete","useContext","update","title","subtitle","productionYear","genre","join","Link","to","position","top","right","type","finished","MovieSeen_MovieSeen","every","seasons","map","episodes","some","window","confirm","deleteMovie","src","fileUrl","replace","alt","movieTag","Tag_Tag","find","tag","toLowerCase","open","MoviesContext","initialFilters","limit","MoviesProvider","add","movies","toConsumableArray","index","findIndex","filter","Boolean","addAll","data","count","_ref3","invalidate","resetFilters","filters","name","undefined","_ref4","MultiDownshift","selectedItems","stateReducer","changes","Downshift","stateChangeTypes","keyDownEnter","clickItem","highlightedIndex","isOpen","callOnChange","downshift","getStateAndHelpers","handleSelection","selectedItem","includes","removeItem","addSelectedItem","item","cb","i","getRemoveButtonProps","objectWithoutProperties","e","stopPropagation","prevProps","_this$props","render","_this$props$children","downshift_esm","css","emoCSS","Item","styled","display","border","height","textAlign","borderTop","lineHeight","fontSize","textTransform","fontWeight","boxShadow","padding","whiteSpace","wordWrap","isActive","isSelected","styles","push","background","BaseMenu","marginTop","width","maxHeight","overflowY","overflowX","outline","transition","borderRadius","borderColor","borderTopWidth","borderRightWidth","borderBottomWidth","borderLeftWidth","borderStyle","zIndex","Menu","forwardRef","ref","innerRef","ControllerButton","flexDirection","justifyContent","alignItems","ArrowIcon","viewBox","preserveAspectRatio","fill","stroke","strokeWidth","transform","d","MultiDownshiftWithReverse","clickOnItem","newSelectedItems","displayItem","displayBackground","itemToFind","BaseMultiDownshift","BaseComponent","_Component","_class","handleChange","placeholder","items","getToggleButtonProps","getMenuProps","getItemProps","toggleMenu","_ref$clickOnItem","_ref$displayItem","identity","_ref$displayBackgroun","_ref$isSelected","margin","paddingRight","flexWrap","paddingLeft","event","preventDefault","gridGap","gridAutoFlow","AsyncMultiDownshift","AsyncMultiDownshiftwithReverse","fromEvent","target","forInput","from","FilterTag","selected","onAdd","MoviesFilter","_useContext","_useContext2","max","minWidth","icon","renderSeen","renderFinished","MoviesFilter_FilterTag","filterTag","t","SingleDownshift","getInputProps","getLabelProps","inputValue","Accordion","toggle","react","defaultState","summary","allocine","tvshows","MovieFormWithContext","valid","isEmpty","$","modal","onUpdate","synchronizeMovieAllocine","idAllocine","m","sort","release","releaseDate","getFullYear","synopsis","poster","href","synchronizeTvShowAllocine","tvseries","yearStart","onInput","onSelect","on","onClose","application","tabIndex","role","data-show","data-dismiss","aria-label","aria-hidden","htmlFor","aria-describedby","paddingTop","Accordion_Accordion","_ref5","code","_ref6","tvshow","SingleDownshift_SingleDownshift","disabled","MovieForm","MovieAPI","List","_useState","useState","_useState2","offset","setOffset","_useState3","_useState4","setMovie","_useState5","_useState6","setKey","_useState7","_useState8","loaded","setLoaded","loadMore","_","notGenres","keys","isArray","buildQuery","useEffect","debouncedLoadMore","debounce","leading","trailing","cancel","isFirstRun","useRef","current","left","MoviesFilter_MoviesFilter","MovieCard_MovieCard","EditableField","setValue","edit","setEdit","lock","renderFormField","submit","renderValue","EditableInput","EditableField_EditableField","fieldProps","onKeyDown","valueProps","EditableTextarea","rows","ctrlKey","split","NotificationContext","reducer","action","payload","getTime","notification","NotificationProvider","_useReducer","useReducer","_useReducer2","dispatch","notifications","Episode","episode","onEpisodeChanged","onDragStart","onDragOver","onDragEnd","dragging","MovieContext","SeasonContext","seasonIndex","ellipsis","setEllipsis","setStyle","episodeTag","toString","padStart","updateEpisode","transformedEpisode","produce","draft","error","content","message","draggable","opacity","dataTransfer","dropEffect","EditableField_EditableInput","EditableField_EditableTextarea","useToggle","initialValue","useInput","Season","onMovieChanged","_useToggle","_useToggle2","setEpisodes","setOpacity","drag","setDrag","oneSeen","episodeIndex","Episode_Episode","tmp","asyncToGenerator","regenerator_default","mark","_callee","times","wrap","_context","prev","next","stop","MovieTag","Movie","withRouter","match","history","setSeasons","fileRef","params","mergeContext","handleFiles","files","file","FormData","append","updatedMovie","goBack","flex","accept","click","Movie_MovieTag","flexGrow","Season_Season_Season","Fetch","FetchWithContext","debounceFetch","endpoint","onSuccess","Header","initialState","unseen","Statistics","stats","setStats","forEach","g","fetchByTypes","fetchByTags","orderBy","toFixed","random","Math","floor","generateColor","TagListElement","toggleEdit","_useInput","_useInput2","setColor","_useInput3","overflow","updateTag","marginLeft","deleteTag","TagList","setTags","_useInput4","setLabel","TagListElement_TagListElement","createTag","Notification","animateProgress","setAnimateProgress","notificationOut","setNotificationOut","onAnimationEnd","animationName","NotificationsList","Notification_Notification","App","BrowserRouter","Header_Header","NotificationsList_NotificationsList","Route","exact","path","component","Login","ReactDOM","UserContext_UserProvider","ApplicationContext_ApplicationProvider","MoviesContext_MoviesProvider","NotificationContext_NotificationProvider","src_App_0","document","getElementById"],"mappings":"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","file":"static/js/main.54524d86.chunk.js","sourcesContent":["const headers = user => ({\n  Accept: \"application/json\",\n  \"Content-Type\": \"application/json\",\n  Authorization: `Bearer ${user.token}`\n});\n\nconst handleResponse = response => {\n  if (response.ok) return response.json();\n  throw new Error(\"Fetch fail\");\n};\n\nexport const getMovie = (id, user) => {\n  return fetch(`/api/movies/${id}`, {\n    headers: headers(user)\n  }).then(handleResponse);\n};\n\nlet controller;\nexport const getMovies = abortable => (search, user) => {\n  if (abortable && controller) {\n    controller.abort();\n  }\n  controller = new AbortController();\n  return fetch(`/api/movies?${search}`, {\n    headers: headers(user),\n    signal: controller.signal\n  })\n    .then(response => {\n      controller = null;\n      return response;\n    })\n    .then(handleResponse);\n};\n\nexport const updateMovie = (movie, user) => {\n  return fetch(`/api/movies/${movie._id}`, {\n    method: \"PUT\",\n    body: JSON.stringify(movie),\n    headers: headers(user)\n  }).then(handleResponse);\n};\n\nexport const updateMoviePoster = (movie, file, user) => {\n  const data = new FormData();\n  data.append(\"file\", file);\n  return fetch(`/api/movies/${movie._id}/poster`, {\n    method: \"POST\",\n    body: data,\n    headers: {\n      Accept: \"application/json\",\n      Authorization: `Bearer ${user.token}`\n    }\n  }).then(handleResponse);\n};\n\nexport const deleteMovie = (movie, user) => {\n  return fetch(`/api/movies/${movie._id}`, {\n    method: \"DELETE\",\n    headers: headers(user)\n  }).then(handleResponse);\n};\n\nexport const addSeason = (movie, user) => {\n  return fetch(`/api/movies/${movie._id}/seasons`, {\n    method: \"POST\",\n    body: JSON.stringify(movie),\n    headers: headers(user)\n  }).then(handleResponse);\n};\n\nexport const updateSeason = (movie, season, user) => {\n  return fetch(`/api/movies/${movie._id}/seasons/${season._id}`, {\n    method: \"PUT\",\n    body: JSON.stringify(season),\n    headers: headers(user)\n  }).then(handleResponse);\n};\n\nexport const deleteSeason = (movie, season, user) => {\n  return fetch(`/api/movies/${movie._id}/seasons/${season._id}`, {\n    method: \"DELETE\",\n    headers: headers(user)\n  }).then(handleResponse);\n};\n\nexport const addEpisode = (movie, season, user) => {\n  return fetch(`/api/movies/${movie._id}/seasons/${season._id}/episodes`, {\n    method: \"POST\",\n    body: JSON.stringify(season),\n    headers: headers(user)\n  }).then(handleResponse);\n};\n\nexport const updateEpisode = (movie, season, episode, user) => {\n  return fetch(\n    `/api/movies/${movie._id}/seasons/${season._id}/episodes/${episode._id}`,\n    {\n      method: \"PUT\",\n      body: JSON.stringify(episode),\n      headers: headers(user)\n    }\n  ).then(handleResponse);\n};\n\nexport const deleteEpisode = (movie, season, episode, user) => {\n  return fetch(\n    `/api/movies/${movie._id}/seasons/${season._id}/episodes/${episode._id}`,\n    {\n      method: \"DELETE\",\n      headers: headers(user)\n    }\n  ).then(handleResponse);\n};\n","import React from \"react\";\n\nexport const MovieSeen = ({ seen, onClick, partial = false }) => (\n  <i\n    className=\"fas fa-eye\"\n    style={{\n      color: partial && !seen ? \"var(--warning)\" : seen ? \"var(--success)\" : \"\",\n      cursor: \"pointer\"\n    }}\n    onClick={onClick}\n  />\n);\n","import React from \"react\";\n\nexport const UserContext = React.createContext();\nexport const withUser = Component => props => (\n  <UserContext.Consumer>\n    {user => <Component {...props} user={user} />}\n  </UserContext.Consumer>\n);\n\nexport const LOGOUT = Symbol();\nexport const LOGIN = Symbol();\nexport const LOGIN_FAILED = Symbol();\n\nconst handleResponse = response => {\n  if (response.ok) return response.json();\n  throw new Error(\"Fetch fail\");\n};\n\nexport class UserProvider extends React.Component {\n  state = {\n    token: null,\n    status: LOGOUT,\n    login: this.login.bind(this)\n  };\n\n  componentDidMount() {\n    const token = localStorage.getItem(\"token\");\n    if (token) {\n      fetch(\"/account\", {\n        method: \"POST\",\n        headers: {\n          Accept: \"application/json\",\n          \"Content-Type\": \"application/json\",\n          Authorization: `Bearer ${token}`\n        }\n      })\n        .then(handleResponse)\n        .then(({ exp }) => {\n          if (new Date() < new Date(exp * 1000))\n            this.setState({ token, status: LOGIN });\n        });\n    }\n  }\n\n  login(password) {\n    fetch(\"/login\", {\n      method: \"POST\",\n      body: JSON.stringify({ password }),\n      headers: {\n        Accept: \"application/json\",\n        \"Content-Type\": \"application/json\"\n      }\n    })\n      .then(handleResponse)\n      .then(({ token }) => {\n        this.setState({ token, status: LOGIN });\n        localStorage.setItem(\"token\", token);\n      })\n      .catch(() => this.setState({ status: LOGIN_FAILED }));\n  }\n\n  render() {\n    return (\n      <UserContext.Provider value={this.state}>\n        {this.props.children}\n      </UserContext.Provider>\n    );\n  }\n}\n","const headers = user => ({\n  Accept: \"application/json\",\n  \"Content-Type\": \"application/json\",\n  Authorization: `Bearer ${user.token}`\n});\n\nconst handleResponse = response => {\n  if (response.ok) return response.json();\n  throw new Error(\"Fetch fail\");\n};\n\nexport const getTags = user => {\n  return fetch(`/api/tags`, {\n    headers: headers(user)\n  }).then(handleResponse);\n};\n\nexport const createTag = (tag, user) => {\n  return fetch(`/api/tags`, {\n    method: \"POST\",\n    body: JSON.stringify(tag),\n    headers: headers(user)\n  }).then(handleResponse);\n};\n\nexport const updateTag = (tag, user) => {\n  return fetch(`/api/tags/${tag._id}`, {\n    method: \"PUT\",\n    body: JSON.stringify(tag),\n    headers: headers(user)\n  }).then(handleResponse);\n};\n\nexport const deleteTag = (tag, user) => {\n  return fetch(`/api/tags/${tag._id}`, {\n    method: \"DELETE\",\n    headers: headers(user)\n  }).then(handleResponse);\n};\n","import React from \"react\";\nimport { getTags } from \"./Common/TagAPI\";\n\nexport const ApplicationContext = React.createContext();\nexport const withApplication = Component => props => (\n  <ApplicationContext.Consumer>\n    {application => <Component {...props} application={application} />}\n  </ApplicationContext.Consumer>\n);\n\nexport const LOADING = Symbol();\nexport const LOADED = Symbol();\n\nexport class ApplicationProvider extends React.Component {\n  set = field => fn => {\n    this.setState(state => ({ ...state, [field]: fn(state[field]) }));\n  };\n\n  componentDidMount() {\n    const options = {\n      headers: {\n        Authorization: `Bearer ${this.props.token}`\n      }\n    };\n\n    const handleResponse = response => {\n      if (response.ok) return response.json();\n      throw new Error(\"Fetch fail\");\n    };\n    Promise.all([\n      fetch(\"/api/movies/genre\", options).then(handleResponse),\n      fetch(\"/api/movies/type\", options).then(handleResponse),\n      getTags(this.props)\n    ]).then(([genres, types, tags]) => {\n      this.setState({\n        genres,\n        types,\n        tags,\n        status: LOADED\n      });\n    });\n  }\n  state = {\n    genres: [],\n    types: [],\n    tags: [],\n    status: LOADING,\n    set: this.set\n  };\n\n  render() {\n    return (\n      <ApplicationContext.Provider value={this.state}>\n        {this.props.children}\n      </ApplicationContext.Provider>\n    );\n  }\n}\n","import React from \"react\";\nimport \"./Tag.css\";\n\nconst invertColor = hex => {\n  if (hex.indexOf(\"#\") === 0) {\n    hex = hex.slice(1);\n  }\n\n  const red = parseInt(hex.slice(0, 2), 16),\n    green = parseInt(hex.slice(2, 4), 16),\n    blue = parseInt(hex.slice(4, 6), 16);\n  return red * 0.299 + green * 0.587 + blue * 0.114 > 186\n    ? \"#000000\"\n    : \"#FFFFFF\";\n};\n\nexport const Tag = ({\n  color,\n  label,\n  big,\n  className = \"\",\n  style = {},\n  onClick = () => void 0\n}) => (\n  <span\n    className={`tag ${big ? \"big\" : \"\"} ${className}`}\n    style={{\n      backgroundColor: color,\n      color: `${invertColor(color)}`,\n      ...style\n    }}\n    onClick={onClick}\n  >\n    {label}\n  </span>\n);\n","import React, { useContext } from \"react\";\nimport \"./MovieList.css\";\nimport { Link } from \"react-router-dom\";\nimport { MovieSeen } from \"../Common/MovieSeen\";\nimport { deleteMovie, updateMovie } from \"../Common/MovieAPI\";\nimport every from \"lodash/every\";\nimport some from \"lodash/some\";\nimport { UserContext } from \"../Login/UserContext\";\nimport { ApplicationContext } from \"../ApplicationContext\";\nimport { Tag } from \"../Admin/Tag\";\n\nexport const MovieCard = ({ movie, onEdit, onChange, onDelete }) => {\n  const user = useContext(UserContext);\n  const { tags } = useContext(ApplicationContext);\n  const update = (field, value) => () =>\n    updateMovie({ ...movie, [field]: value }, user).then(onChange);\n\n  const title = `${movie.title}`;\n  const subtitle = `${movie.productionYear} - ${movie.genre.join(\",\")}`;\n\n  return (\n    <div className=\"card movie-card\">\n      <div className=\"card-body\">\n        <h5 className=\"card-title\">\n          <Link to={`movie/${movie._id}`}>\n            <div className=\"ellipsis\" title={title}>\n              {title}\n            </div>\n          </Link>\n        </h5>\n        <h6 className=\"card-subtitle mb-2 text-muted ellipsis\" title={subtitle}>\n          {subtitle}\n        </h6>\n        <div\n          className=\"movie-card-actions\"\n          style={{ position: \"absolute\", top: 2, right: 4 }}\n        >\n          {movie.type !== \"Film\" && (\n            <i\n              className=\"fas fa-ban\"\n              style={{\n                cursor: \"pointer\",\n                color: movie.finished ? \"var(--danger)\" : \"black\"\n              }}\n              onClick={update(\"finished\", !movie.finished)}\n            />\n          )}\n          {movie.type === \"Film\" ? (\n            <MovieSeen\n              seen={movie.seen}\n              onClick={update(\"seen\", !movie.seen)}\n            />\n          ) : (\n            <MovieSeen\n              seen={\n                every(\n                  movie.seasons.map(\n                    season =>\n                      every(season.episodes, \"seen\") &&\n                      season.episodes.length > 0\n                  )\n                ) && movie.seasons.length > 0\n              }\n              partial={\n                some(\n                  movie.seasons.map(\n                    season =>\n                      some(season.episodes, \"seen\") &&\n                      season.episodes.length > 0\n                  )\n                ) && movie.seasons.length > 0\n              }\n            />\n          )}\n          <i\n            className=\"fas fa-pencil-alt\"\n            onClick={onEdit}\n            style={{ cursor: \"pointer\" }}\n          />\n          <i\n            className=\"fas fa-trash\"\n            onClick={() => {\n              if (window.confirm()) {\n                deleteMovie(movie, user).then(onDelete);\n              }\n            }}\n            style={{ cursor: \"pointer\" }}\n          />\n        </div>\n        <div className=\"poster text-center\">\n          <img\n            src={\n              movie.fileUrl\n                ? movie.fileUrl.replace(\"http:\", \"https:\")\n                : \"/no-image.png\"\n            }\n            alt=\"movie poster\"\n          />\n        </div>\n        <div className=\"mt-2 text-center\">\n          {movie.tags.map(movieTag => (\n            <Tag\n              key={movieTag}\n              {...tags.find(tag => tag._id === movieTag)}\n              className=\"mr-2\"\n              onClick={() => {\n                const tag = tags.find(tag => tag._id === movieTag);\n                if (tag && tag.label.toLowerCase() === \"netflix\") {\n                  window.open(\n                    `https://www.netflix.com/search?q=${movie.title}`,\n                    \"_blank\"\n                  );\n                }\n              }}\n            />\n          ))}\n        </div>\n      </div>\n    </div>\n  );\n};\n","import React from \"react\";\nimport findIndex from \"lodash/findIndex\";\n\nexport const MoviesContext = React.createContext();\n\nconst initialFilters = () => ({\n  productionYear: \"\",\n  title: \"\",\n  genres: [],\n  types: [],\n  tags: [],\n  seen: null, // null = dont care, true = have seen, false = have not seen\n  finished: null, // null = dont care, true = finished\n  limit: 30\n});\n\nexport class MoviesProvider extends React.Component {\n  add = movie => {\n    this.setState(({ movies }) => ({ movies: [movie, ...movies] }));\n  };\n\n  update = (id, movie) => {\n    const index = findIndex(this.state.movies, [\"_id\", id]);\n    const movies = [...this.state.movies];\n    movies[index] = movie;\n    this.setState({\n      movies: movies.filter(Boolean) // pass undefined as delete and then use filter te remove the element\n    });\n  };\n\n  addAll = ({ data, count }) => {\n    this.setState(({ movies }) => ({ movies: [...movies, ...data], count }));\n  };\n\n  invalidate = () => {\n    this.setState({ movies: [], count: 0 });\n  };\n\n  resetFilters = () => {\n    this.setState({ filters: initialFilters() });\n  };\n\n  onChange = name => (value = \"\") => {\n    this.setState(({ filters }) => ({\n      movies: [],\n      count: 0,\n      filters: { ...filters, [name]: value }\n    }));\n  };\n\n  state = {\n    movies: [],\n    count: 0,\n    filters: initialFilters(),\n    onChange: this.onChange,\n    addAll: this.addAll,\n    update: this.update,\n    add: this.add,\n    invalidate: this.invalidate,\n    resetFilters: this.resetFilters\n  };\n\n  render() {\n    return (\n      <MoviesContext.Provider value={this.state}>\n        {this.props.children}\n      </MoviesContext.Provider>\n    );\n  }\n}\n","import React from \"react\";\nimport Downshift from \"downshift\";\n\nexport class MultiDownshift extends React.Component {\n  state = { selectedItems: this.props.selectedItems || [] };\n\n  componentDidUpdate(prevProps) {\n    if (\n      prevProps.selectedItems !== this.props.selectedItems &&\n      this.props.selectedItems !== this.state.selectedItems\n    ) {\n      this.setState({ selectedItems: this.props.selectedItems || [] });\n    }\n  }\n  stateReducer = (state, changes) => {\n    switch (changes.type) {\n      case Downshift.stateChangeTypes.keyDownEnter:\n      case Downshift.stateChangeTypes.clickItem:\n        return {\n          ...changes,\n          highlightedIndex: state.highlightedIndex,\n          isOpen: true\n        };\n      default:\n        return changes;\n    }\n  };\n\n  callOnChange = downshift => () => {\n    if (this.props.onChange) {\n      this.props.onChange(\n        this.state.selectedItems,\n        this.getStateAndHelpers(downshift)\n      );\n    }\n  };\n\n  handleSelection = (selectedItem, downshift) => {\n    if (this.state.selectedItems.includes(selectedItem)) {\n      this.removeItem(selectedItem, this.callOnChange(downshift));\n    } else {\n      this.addSelectedItem(selectedItem, this.callOnChange(downshift));\n    }\n  };\n\n  removeItem = (item, cb) => {\n    this.setState(({ selectedItems }) => {\n      return {\n        selectedItems: selectedItems.filter(i => i !== item)\n      };\n    }, cb);\n  };\n  addSelectedItem(item, cb) {\n    this.setState(\n      ({ selectedItems }) => ({\n        selectedItems: [...selectedItems, item]\n      }),\n      cb\n    );\n  }\n\n  getRemoveButtonProps = downshift => ({ onClick, item, ...props } = {}) => {\n    return {\n      onClick: e => {\n        // TODO: use something like downshift's composeEventHandlers utility instead\n        onClick && onClick(e);\n        e.stopPropagation();\n        this.removeItem(item, this.callOnChange(downshift));\n      },\n      ...props\n    };\n  };\n\n  getStateAndHelpers(downshift) {\n    const { selectedItems } = this.state;\n    const { getRemoveButtonProps, removeItem } = this;\n    return {\n      getRemoveButtonProps: getRemoveButtonProps(downshift),\n      removeItem,\n      selectedItems,\n      ...downshift\n    };\n  }\n  render() {\n    const { render, children = render, ...props } = this.props;\n    // TODO: compose together props (rather than overwriting them) like downshift does\n    return (\n      <Downshift\n        {...props}\n        stateReducer={this.stateReducer}\n        onChange={this.handleSelection}\n        selectedItem={null}\n      >\n        {downshift => children(this.getStateAndHelpers(downshift))}\n      </Downshift>\n    );\n  }\n}\n","import React from \"react\";\nimport { css as emoCSS } from \"emotion\";\nimport styled from \"react-emotion\";\n\n// TODO copy paste from downshift example :)\n\nconst css = (...args) => ({ className: emoCSS(...args) });\n\nconst Item = styled(\"li\")(\n  {\n    position: \"relative\",\n    cursor: \"pointer\",\n    display: \"block\",\n    border: \"none\",\n    height: \"auto\",\n    textAlign: \"left\",\n    borderTop: \"none\",\n    lineHeight: \"1em\",\n    color: \"rgba(0,0,0,.87)\",\n    fontSize: \"1rem\",\n    textTransform: \"none\",\n    fontWeight: \"400\",\n    boxShadow: \"none\",\n    padding: \".8rem 1.1rem\",\n    whiteSpace: \"normal\",\n    wordWrap: \"normal\"\n  },\n  ({ isActive, isSelected }) => {\n    const styles = [];\n    if (isActive) {\n      styles.push({\n        color: \"rgba(0,0,0,.95)\",\n        background: \"rgba(0,0,0,.03)\"\n      });\n    }\n    if (isSelected) {\n      styles.push({\n        color: \"rgba(0,0,0,.95)\",\n        fontWeight: \"700\"\n      });\n    }\n    return styles;\n  }\n);\n\nconst BaseMenu = styled(\"ul\")(\n  {\n    padding: 0,\n    marginTop: 0,\n    position: \"absolute\",\n    backgroundColor: \"white\",\n    width: \"100%\",\n    maxHeight: \"20rem\",\n    overflowY: \"auto\",\n    overflowX: \"hidden\",\n    outline: \"0\",\n    transition: \"opacity .1s ease\",\n    borderRadius: \"0 0 .28571429rem .28571429rem\",\n    boxShadow: \"0 2px 3px 0 rgba(34,36,38,.15)\",\n    borderColor: \"#96c8da\",\n    borderTopWidth: \"0\",\n    borderRightWidth: 1,\n    borderBottomWidth: 1,\n    borderLeftWidth: 1,\n    borderStyle: \"solid\",\n    zIndex: 10\n  },\n  ({ isOpen }) => ({\n    border: isOpen ? null : \"none\"\n  })\n);\n\nconst Menu = React.forwardRef((props, ref) => (\n  <BaseMenu innerRef={ref} {...props} />\n));\n\nconst ControllerButton = styled(\"button\")({\n  backgroundColor: \"transparent\",\n  border: \"none\",\n  position: \"absolute\",\n  right: 0,\n  top: 0,\n  cursor: \"pointer\",\n  width: 47,\n  display: \"flex\",\n  flexDirection: \"column\",\n  height: \"100%\",\n  justifyContent: \"center\",\n  alignItems: \"center\"\n});\n\nfunction ArrowIcon({ isOpen }) {\n  return (\n    <svg\n      viewBox=\"0 0 20 20\"\n      preserveAspectRatio=\"none\"\n      width={16}\n      fill=\"transparent\"\n      stroke=\"#979797\"\n      strokeWidth=\"1.1px\"\n      transform={isOpen ? \"rotate(180)\" : null}\n    >\n      <path d=\"M1,6 L10,15 L19,6\" />\n    </svg>\n  );\n}\nexport { Menu, ControllerButton, Item, ArrowIcon, css };\n","import React from \"react\";\nimport Downshift from \"downshift\";\n\nexport class MultiDownshiftWithReverse extends React.Component {\n  state = { selectedItems: this.props.selectedItems || [] };\n  stateReducer = (state, changes) => {\n    switch (changes.type) {\n      case Downshift.stateChangeTypes.keyDownEnter:\n      case Downshift.stateChangeTypes.clickItem:\n        return {\n          ...changes,\n          highlightedIndex: state.highlightedIndex,\n          isOpen: true\n        };\n      default:\n        return changes;\n    }\n  };\n\n  callOnChange = downshift => () => {\n    if (this.props.onChange) {\n      this.props.onChange(\n        this.state.selectedItems,\n        this.getStateAndHelpers(downshift)\n      );\n    }\n  };\n\n  handleSelection = (selectedItem, downshift) => {\n    if (\n      this.state.selectedItems.filter(item => selectedItem === item[0]).length >\n      0\n    ) {\n      this.removeItem([selectedItem], this.callOnChange(downshift));\n    } else {\n      this.addSelectedItem(selectedItem, this.callOnChange(downshift));\n    }\n  };\n\n  removeItem = (item, cb) => {\n    this.setState(({ selectedItems }) => {\n      return {\n        selectedItems: selectedItems.filter(i => i[0] !== item[0])\n      };\n    }, cb);\n  };\n  addSelectedItem(item, cb) {\n    this.setState(\n      ({ selectedItems }) => ({\n        selectedItems: [...selectedItems, [item, true]]\n      }),\n      cb\n    );\n  }\n\n  getRemoveButtonProps = downshift => ({ onClick, item, ...props } = {}) => {\n    return {\n      onClick: e => {\n        // TODO: use something like downshift's composeEventHandlers utility instead\n        onClick && onClick(e);\n        e.stopPropagation();\n        this.removeItem(item, this.callOnChange(downshift));\n      },\n      ...props\n    };\n  };\n\n  clickOnItem = downshift => (item, index) => {\n    this.setState(({ selectedItems }) => {\n      const newSelectedItems = selectedItems;\n      newSelectedItems[index] = [item[0], !item[1]];\n      return {\n        selectedItems: newSelectedItems.filter(i => i !== item[0])\n      };\n    }, this.callOnChange(downshift));\n  };\n  displayItem = item => {\n    return item[0];\n  };\n  displayBackground = item => {\n    return item[1] ? \"#ccc\" : \"tomato\";\n  };\n  isSelected = itemToFind => {\n    return this.state.selectedItems.find(item => item[0] === itemToFind);\n  };\n\n  getStateAndHelpers(downshift) {\n    const { selectedItems } = this.state;\n    const {\n      getRemoveButtonProps,\n      removeItem,\n      clickOnItem,\n      displayItem,\n      displayBackground,\n      isSelected\n    } = this;\n    return {\n      getRemoveButtonProps: getRemoveButtonProps(downshift),\n      removeItem,\n      selectedItems,\n      clickOnItem: clickOnItem(downshift),\n      displayItem,\n      displayBackground,\n      isSelected,\n      ...downshift\n    };\n  }\n  render() {\n    const { render, children = render, ...props } = this.props;\n    // TODO: compose together props (rather than overwriting them) like downshift does\n    return (\n      <Downshift\n        {...props}\n        stateReducer={this.stateReducer}\n        onChange={this.handleSelection}\n        selectedItem={null}\n      >\n        {downshift => children(this.getStateAndHelpers(downshift))}\n      </Downshift>\n    );\n  }\n}\n","import { MultiDownshift } from \"./MultiDownshift\";\nimport { ArrowIcon, ControllerButton, css, Item, Menu } from \"../shared\";\nimport React, { Component } from \"react\";\nimport identity from \"lodash/identity\";\nimport { MultiDownshiftWithReverse } from \"./MultiDownshiftWithReverse\";\n\nconst BaseMultiDownshift = BaseComponent =>\n  class extends Component {\n    render() {\n      const { handleChange, placeholder, items, selectedItems } = this.props;\n      return (\n        <BaseComponent\n          onChange={handleChange}\n          selectedItems={selectedItems}\n          placeholder={placeholder}\n        >\n          {({\n            getToggleButtonProps,\n            getMenuProps,\n            getRemoveButtonProps,\n            removeItem,\n            isOpen,\n            selectedItems,\n            getItemProps,\n            highlightedIndex,\n            toggleMenu,\n            clickOnItem = () => void 0,\n            displayItem = identity,\n            displayBackground = () => \"#ccc\",\n            isSelected = item => selectedItems.includes(item)\n          }) => (\n            <div\n              style={{\n                margin: \"auto\",\n                position: \"relative\",\n                width: \"100%\"\n              }}\n            >\n              <div\n                {...css({\n                  cursor: \"pointer\",\n                  position: \"relative\",\n                  padding: \".375rem .75rem\",\n                  paddingRight: 50,\n                  border: \"1px solid #ced4da\",\n                  borderRadius: \".25rem\",\n                  backgroundColor: \"white\"\n                })}\n                onClick={() => {\n                  toggleMenu();\n                }}\n              >\n                <div\n                  {...css({\n                    display: \"flex\",\n                    flexWrap: \"wrap\",\n                    alignItems: \"center\"\n                  })}\n                >\n                  {selectedItems.length > 0 ? (\n                    selectedItems.map((item, index) => (\n                      <div\n                        key={index}\n                        {...css({\n                          margin: \"0 2px\",\n                          paddingLeft: 8,\n                          paddingRight: 8,\n                          display: \"inline-block\",\n                          wordWrap: \"none\",\n                          backgroundColor: displayBackground(item),\n                          borderRadius: 2\n                        })}\n                        onClick={event => {\n                          event.preventDefault();\n                          event.stopPropagation();\n                          clickOnItem(item, index);\n                        }}\n                      >\n                        <div\n                          {...css({\n                            display: \"grid\",\n                            gridGap: 6,\n                            gridAutoFlow: \"column\",\n                            alignItems: \"center\"\n                          })}\n                        >\n                          <span>{displayItem(item)}</span>\n                          <button\n                            {...getRemoveButtonProps({ item })}\n                            {...css({\n                              cursor: \"pointer\",\n                              lineHeight: 0.8,\n                              border: \"none\",\n                              backgroundColor: \"transparent\",\n                              padding: \"0\",\n                              fontSize: \"16px\"\n                            })}\n                            type=\"button\"\n                          >\n                            𝘅\n                          </button>\n                        </div>\n                      </div>\n                    ))\n                  ) : (\n                    <span\n                      {...css({\n                        color: \"#6c757d;\"\n                      })}\n                    >\n                      {placeholder}\n                    </span>\n                  )}\n                </div>\n                <ControllerButton\n                  {...getToggleButtonProps({\n                    // prevents the menu from immediately toggling\n                    // closed (due to our custom click handler above).\n                    onClick(event) {\n                      event.stopPropagation();\n                    }\n                  })}\n                >\n                  <ArrowIcon isOpen={isOpen} />\n                </ControllerButton>\n              </div>\n              <Menu {...getMenuProps({ isOpen })}>\n                {isOpen\n                  ? items.map((item, index) => (\n                      <Item\n                        key={index}\n                        {...getItemProps({\n                          item,\n                          index,\n                          isActive: highlightedIndex === index,\n                          isSelected: isSelected(item)\n                        })}\n                      >\n                        {item}\n                      </Item>\n                    ))\n                  : null}\n              </Menu>\n            </div>\n          )}\n        </BaseComponent>\n      );\n    }\n  };\n\nexport const AsyncMultiDownshift = BaseMultiDownshift(MultiDownshift);\nexport const AsyncMultiDownshiftwithReverse = BaseMultiDownshift(\n  MultiDownshiftWithReverse\n);\n","import React, { useContext } from \"react\";\nimport identity from \"lodash/identity\";\nimport { MoviesContext } from \"../Common/MoviesContext\";\nimport {\n  AsyncMultiDownshift,\n  AsyncMultiDownshiftwithReverse\n} from \"../Common/AsyncMultiDownshift\";\nimport { ApplicationContext } from \"../ApplicationContext\";\nimport { Tag } from \"../Admin/Tag\";\n\nconst fromEvent = event => event.target.value;\n\nconst forInput = (\n  { filters, onChange },\n  name,\n  transform = identity,\n  from = fromEvent\n) => {\n  return {\n    value: filters[name],\n    onChange: value => onChange(name)(transform(from(value)))\n  };\n};\n\nconst FilterTag = ({ tag, selected, onAdd, onDelete }) => (\n  <span onClick={selected ? onDelete : onAdd}>\n    <Tag {...tag} className={`filter-tag mr-2 ${selected ? \"selected\" : \"\"}`} />\n  </span>\n);\n\nexport const MoviesFilter = () => {\n  const { filters, onChange } = useContext(MoviesContext);\n  const { genres, types, tags } = useContext(ApplicationContext);\n  const { seen, finished } = filters;\n\n  const renderSeen = () => {\n    let color = \"\",\n      icon = \"fa-eye\",\n      onClick = () => onChange(\"seen\")(\"true\");\n    if (seen === \"true\") {\n      color = \"var(--success)\";\n      onClick = () => onChange(\"seen\")(\"partial\");\n    } else if (seen === \"partial\") {\n      color = \"var(--warning)\";\n      onClick = () => onChange(\"seen\")(\"false\");\n    } else if (seen === \"false\") {\n      color = \"var(--danger)\";\n      icon = \"fa-eye-slash\";\n      onClick = () => onChange(\"seen\")(null);\n    }\n    return (\n      <i\n        className={`fas ${icon}`}\n        style={{\n          color,\n          cursor: \"pointer\"\n        }}\n        onClick={onClick}\n      />\n    );\n  };\n\n  const renderFinished = () => {\n    let color = \"\",\n      onClick = () => onChange(\"finished\")(true);\n    if (finished === true) {\n      color = \"var(--danger)\";\n      onClick = () => onChange(\"finished\")(null);\n    }\n    return (\n      <i\n        className={`fas fa-ban`}\n        style={{\n          color,\n          cursor: \"pointer\"\n        }}\n        onClick={onClick}\n      />\n    );\n  };\n\n  return (\n    <form className=\"form-inline movies-filter mt-4 ml-3\">\n      <div className=\"form-group mr-2\">\n        <input\n          {...forInput({ filters, onChange }, \"productionYear\", value =>\n            parseInt(value, 10)\n          )}\n          type=\"number\"\n          max={2200}\n          placeholder=\"YYYY\"\n          className=\"form-control\"\n          style={{ width: \"90px\" }}\n        />\n      </div>\n      <div className=\"form-group mr-2\">\n        <input\n          type=\"text\"\n          {...forInput({ filters, onChange }, \"title\")}\n          placeholder=\"Title\"\n          className=\"form-control\"\n        />\n      </div>\n      <div className=\"form-group mr-2\" style={{ minWidth: \"220px\" }}>\n        <AsyncMultiDownshiftwithReverse\n          placeholder=\"Genre\"\n          handleChange={\n            forInput({ filters, onChange }, \"genres\", identity, identity)\n              .onChange\n          }\n          items={genres}\n          selectedItems={filters.genres}\n        />\n      </div>\n      <div className=\"form-group mr-2\" style={{ width: \"220px\" }}>\n        <AsyncMultiDownshift\n          placeholder=\"Type\"\n          handleChange={\n            forInput({ filters, onChange }, \"types\", identity, identity)\n              .onChange\n          }\n          items={types}\n          selectedItems={filters.types}\n        />\n      </div>\n      <div className=\"form-group mr-2\">{renderSeen()}</div>\n      <div className=\"form-group mr-2\">{renderFinished()}</div>\n      <div>\n        {tags.map(tag => (\n          <FilterTag\n            key={tag._id}\n            tag={tag}\n            selected={filters.tags.find(filterTag => filterTag === tag._id)}\n            onAdd={() => onChange(\"tags\")([...filters.tags, tag._id])}\n            onDelete={() =>\n              onChange(\"tags\")(filters.tags.filter(t => t !== tag._id))\n            }\n          />\n        ))}\n      </div>\n    </form>\n  );\n};\n","import React from \"react\";\nimport Downshift from \"downshift\";\nimport { ArrowIcon, ControllerButton, css, Item, Menu } from \"../shared\";\n\nexport class SingleDownshift extends React.Component {\n  render() {\n    const { onChange, placeholder, items, selectedItem } = this.props;\n    return (\n      <Downshift onChange={onChange} selectedItem={selectedItem}>\n        {({\n          getInputProps,\n          getItemProps,\n          getLabelProps,\n          getMenuProps,\n          isOpen,\n          inputValue,\n          highlightedIndex,\n          selectedItem,\n          toggleMenu\n        }) => (\n          <div\n            style={{\n              margin: \"auto\",\n              position: \"relative\",\n              width: \"100%\"\n            }}\n          >\n            <div\n              {...css({\n                cursor: \"pointer\",\n                position: \"relative\",\n                padding: \".375rem .75rem\",\n                paddingRight: 50,\n                border: \"1px solid #ced4da\",\n                borderRadius: \".25rem\",\n                backgroundColor: \"white\"\n              })}\n              onClick={() => {\n                toggleMenu();\n              }}\n            >\n              <div\n                {...css({\n                  display: \"flex\",\n                  flexWrap: \"wrap\",\n                  alignItems: \"center\"\n                })}\n              >\n                {selectedItem ? (\n                  <div\n                    {...css({\n                      margin: \"0 2px\",\n                      paddingLeft: 8,\n                      paddingRight: 8,\n                      display: \"inline-block\",\n                      wordWrap: \"none\",\n                      backgroundColor: \"#ccc\",\n                      borderRadius: 2\n                    })}\n                  >\n                    <div\n                      {...css({\n                        display: \"grid\",\n                        gridGap: 6,\n                        gridAutoFlow: \"column\",\n                        alignItems: \"center\"\n                      })}\n                    >\n                      <span>{selectedItem}</span>\n                    </div>\n                  </div>\n                ) : (\n                  <span\n                    {...css({\n                      color: \"#6c757d;\"\n                    })}\n                  >\n                    {placeholder}\n                  </span>\n                )}\n              </div>\n              <ControllerButton>\n                <ArrowIcon isOpen={isOpen} />\n              </ControllerButton>\n            </div>\n            <Menu {...getMenuProps({ isOpen })}>\n              {isOpen\n                ? items.map((item, index) => (\n                    <Item\n                      key={index}\n                      {...getItemProps({\n                        item,\n                        index,\n                        isActive: highlightedIndex === index,\n                        isSelected: selectedItem === item\n                      })}\n                    >\n                      {item}\n                    </Item>\n                  ))\n                : null}\n            </Menu>\n          </div>\n        )}\n      </Downshift>\n    );\n  }\n}\n","import React, { Component, Fragment } from \"react\";\n\nexport class Accordion extends Component {\n  state = {\n    open: false,\n    toggle: this.toggle.bind(this)\n  };\n\n  toggle() {\n    this.setState({ open: !this.state.open });\n  }\n\n  render() {\n    return <Fragment>{this.props.children(this.state)}</Fragment>;\n  }\n}\n","import React, { Fragment } from \"react\";\nimport { SingleDownshift } from \"../Common/SingleDownshift\";\nimport { LOADING, withApplication } from \"../ApplicationContext\";\nimport isEmpty from \"lodash/isEmpty\";\nimport { AsyncMultiDownshift } from \"../Common/AsyncMultiDownshift\";\nimport { Accordion } from \"../Common/Accordion\";\nimport { withUser } from \"../Login/UserContext\";\n\nconst defaultState = {\n  movie: {\n    title: \"\",\n    genre: [],\n    type: \"\",\n    productionYear: \"\",\n    summary: \"\"\n  },\n  allocine: {\n    movies: [],\n    tvshows: []\n  }\n};\n\nconst headers = user => ({\n  Accept: \"application/json\",\n  \"Content-Type\": \"application/json\",\n  Authorization: `Bearer ${user.token}`\n});\n\nconst handleResponse = response => {\n  if (response.ok) return response.json();\n  throw new Error(\"Fetch fail\");\n};\n\nclass MovieFormWithContext extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      movie: props.movie ? props.movie : defaultState.movie,\n      allocine: defaultState.allocine\n    };\n  }\n\n  componentDidMount() {\n    // eslint-disable-next-line no-undef\n    $(\"#movie-creator-updator\").on(\"hide.bs.modal\", this.props.onClose);\n  }\n\n  valid = () => {\n    return (\n      !isEmpty(this.state.movie.title) &&\n      this.state.movie.genre.length > 0 &&\n      !isEmpty(this.state.movie.type)\n    );\n  };\n\n  add = () => {\n    fetch(\"/api/movies\", {\n      method: \"POST\",\n      body: JSON.stringify(this.state.movie),\n      headers: headers(this.props.user)\n    })\n      .then(handleResponse)\n      .then(data => {\n        this.props.onAdd({ ...this.state.movie, ...data });\n        // eslint-disable-next-line no-undef\n        $(\"#movie-creator-updator\").modal(\"hide\");\n      });\n  };\n\n  update = () => {\n    fetch(`/api/movies/${this.props.movie._id}`, {\n      method: \"PUT\",\n      body: JSON.stringify(this.state.movie),\n      headers: headers(this.props.user)\n    })\n      .then(handleResponse)\n      .then(data => {\n        this.props.onUpdate({ ...this.state.movie, ...data });\n        // eslint-disable-next-line no-undef\n        $(\"#movie-creator-updator\").modal(\"hide\");\n      });\n  };\n\n  search = () => {\n    Promise.all([\n      fetch(`/api/allocine?type=Film&title=${this.state.movie.title}`, {\n        headers: headers(this.props.user)\n      }).then(handleResponse),\n      fetch(`/api/allocine?type=Série&title=${this.state.movie.title}`, {\n        headers: headers(this.props.user)\n      }).then(handleResponse)\n    ]).then(([movies, tvshows]) =>\n      this.setState({ allocine: { movies, tvshows } })\n    );\n  };\n\n  synchronizeMovieAllocine = idAllocine => {\n    // if click on the currently selected movie, unselect it\n    if (idAllocine === this.state.movie.idAllocine) {\n      this.setState({\n        movie: {\n          ...this.state.movie,\n          idAllocine: null\n        }\n      });\n    } else {\n      fetch(`/api/allocine/movie/${idAllocine}`, {\n        headers: headers(this.props.user)\n      })\n        .then(handleResponse)\n        .then(({ movie }) =>\n          this.setState({\n            movie: {\n              ...this.state.movie,\n              idAllocine,\n              title: movie.title,\n              genre: movie.genre.map(m => m.$).sort(),\n              type: \"Film\",\n              productionYear:\n                movie.release && movie.release.releaseDate\n                  ? new Date(movie.release.releaseDate).getFullYear()\n                  : movie.productionYear,\n              summary: movie.synopsis,\n              fileUrl: movie.poster ? movie.poster.href : \"\"\n            }\n          })\n        );\n    }\n  };\n\n  synchronizeTvShowAllocine = idAllocine => {\n    // if click on the currently selected movie, unselect it\n    if (idAllocine === this.state.movie.idAllocine) {\n      this.setState({\n        movie: {\n          ...this.state.movie,\n          idAllocine: null\n        }\n      });\n    } else {\n      fetch(`/api/allocine/serie/${idAllocine}`, {\n        headers: headers(this.props.user)\n      })\n        .then(handleResponse)\n        .then(({ tvseries }) =>\n          this.setState({\n            movie: {\n              ...this.state.movie,\n              idAllocine,\n              title: tvseries.title,\n              genre: tvseries.genre.map(m => m.$).sort(),\n              type: \"Série\",\n              productionYear: tvseries.yearStart,\n              summary: tvseries.synopsis,\n              fileUrl: tvseries.poster ? tvseries.poster.href : \"\"\n            }\n          })\n        );\n    }\n  };\n\n  onInput = (field, transform = data => data) => {\n    return event =>\n      this.setState({\n        movie: { ...this.state.movie, [field]: transform(event.target.value) }\n      });\n  };\n\n  onSelect = field => {\n    return value =>\n      this.setState({ movie: { ...this.state.movie, [field]: value } });\n  };\n\n  render() {\n    const { movie } = this.state;\n    return (\n      <Fragment>\n        {this.props.application.status === LOADING ? (\n          <div>Loading...</div>\n        ) : (\n          <div\n            className=\"movie-modal modal fade movie-form\"\n            id=\"movie-creator-updator\"\n            tabIndex=\"-1\"\n            role=\"dialog\"\n            data-show=\"true\"\n          >\n            <div className=\"modal-dialog modal-dialog-centered\" role=\"document\">\n              <div className=\"modal-content\">\n                <div className=\"modal-header\">\n                  <h5 className=\"modal-title\">\n                    {(movie && movie.title) || \"New\"}\n                  </h5>\n                  <button\n                    type=\"button\"\n                    className=\"close\"\n                    data-dismiss=\"modal\"\n                    aria-label=\"Close\"\n                  >\n                    <span aria-hidden=\"true\">&times;</span>\n                  </button>\n                </div>\n                <div className=\"modal-body\">\n                  <div className=\"form-row\">\n                    <div className=\"form-group col-11\">\n                      <label htmlFor=\"title\">Title</label>\n                      <input\n                        type=\"text\"\n                        className=\"form-control\"\n                        id=\"title\"\n                        aria-describedby=\"title\"\n                        placeholder=\"Enter title\"\n                        onChange={this.onInput(\"title\")}\n                        value={this.state.movie.title}\n                      />\n                    </div>\n                    <div className=\"form-group col-1 text-center\">\n                      <i\n                        className=\"fab fa-angular fa-2x\"\n                        style={{\n                          cursor: \"pointer\",\n                          color: \"#fecc00\",\n                          paddingTop: \"35px\"\n                        }}\n                        onClick={this.search}\n                      />\n                    </div>\n                  </div>\n                  {this.state.allocine.movies.length > 0 ? (\n                    <Accordion>\n                      {({ open, toggle }) => {\n                        return (\n                          <Fragment>\n                            <div onClick={toggle} style={{ cursor: \"pointer\" }}>\n                              {this.state.allocine.movies.length} movies\n                              {open ? (\n                                <i className=\"fas fa-chevron-up\" />\n                              ) : (\n                                <i className=\"fas fa-chevron-down\" />\n                              )}\n                            </div>\n                            <div\n                              className=\"row\"\n                              style={{\n                                overflowX: \"scroll\",\n                                display: open ? \"flex\" : \"none\",\n                                flexWrap: \"nowrap\"\n                              }}\n                            >\n                              {this.state.allocine.movies.map(movie => (\n                                <div\n                                  key={movie.code}\n                                  className={`col-2 allocine-movie ${\n                                    movie.code === this.state.movie.idAllocine\n                                      ? \"selected\"\n                                      : \"\"\n                                  }`}\n                                  onClick={() =>\n                                    this.synchronizeMovieAllocine(movie.code)\n                                  }\n                                >\n                                  {movie.code ===\n                                  this.state.movie.idAllocine ? (\n                                    <i className=\"fas fa-check-circle selected-movie-icon fa-2x\" />\n                                  ) : null}\n                                  <div>\n                                    {movie.title} -{\" \"}\n                                    {movie.release && movie.release.releaseDate\n                                      ? new Date(\n                                          movie.release.releaseDate\n                                        ).getFullYear()\n                                      : movie.productionYear}\n                                  </div>\n                                  <div>\n                                    {movie.poster ? (\n                                      <img\n                                        src={movie.poster.href}\n                                        alt=\"movie poster\"\n                                        style={{ width: \"100%\" }}\n                                      />\n                                    ) : null}\n                                  </div>\n                                </div>\n                              ))}\n                            </div>\n                          </Fragment>\n                        );\n                      }}\n                    </Accordion>\n                  ) : null}\n                  {this.state.allocine.tvshows.length > 0 ? (\n                    <Accordion>\n                      {({ open, toggle }) => {\n                        return (\n                          <Fragment>\n                            <div onClick={toggle} style={{ cursor: \"pointer\" }}>\n                              {this.state.allocine.tvshows.length} tv shows\n                              {open ? (\n                                <i className=\"fas fa-chevron-up\" />\n                              ) : (\n                                <i className=\"fas fa-chevron-down\" />\n                              )}\n                            </div>\n                            <div\n                              className=\"row\"\n                              style={{\n                                overflowX: \"scroll\",\n                                display: open ? \"flex\" : \"none\",\n                                flexWrap: \"nowrap\"\n                              }}\n                            >\n                              {this.state.allocine.tvshows.map(tvshow => (\n                                <div\n                                  key={tvshow.code}\n                                  className={`col-2 allocine-movie ${\n                                    tvshow.code === this.state.movie.idAllocine\n                                      ? \"selected\"\n                                      : \"\"\n                                  }`}\n                                  onClick={() =>\n                                    this.synchronizeTvShowAllocine(tvshow.code)\n                                  }\n                                >\n                                  {tvshow.code ===\n                                  this.state.movie.idAllocine ? (\n                                    <i className=\"fas fa-check-circle selected-movie-icon fa-2x\" />\n                                  ) : null}\n                                  <div>\n                                    {tvshow.title} - {tvshow.yearStart}\n                                  </div>\n                                  <div>\n                                    {tvshow.poster ? (\n                                      <img\n                                        src={tvshow.poster.href}\n                                        alt=\"tvshow poster\"\n                                        style={{ width: \"100%\" }}\n                                      />\n                                    ) : null}\n                                  </div>\n                                </div>\n                              ))}\n                            </div>\n                          </Fragment>\n                        );\n                      }}\n                    </Accordion>\n                  ) : null}\n                  <div className=\"form-group\">\n                    <label>Genre</label>\n                    <AsyncMultiDownshift\n                      selectedItems={this.state.movie.genre}\n                      placeholder=\"Genre\"\n                      items={this.props.application.genres}\n                      handleChange={this.onSelect(\"genre\")}\n                    />\n                  </div>\n                  <div className=\"form-group\">\n                    <label>Type</label>\n                    <SingleDownshift\n                      selectedItem={this.state.movie.type}\n                      placeholder=\"Type\"\n                      items={this.props.application.types}\n                      onChange={this.onSelect(\"type\")}\n                    />\n                  </div>\n                  <div className=\"form-group\">\n                    <label htmlFor=\"production-year\">Production Year</label>\n                    <input\n                      type=\"number\"\n                      className=\"form-control\"\n                      id=\"production-year\"\n                      aria-describedby=\"production year\"\n                      placeholder=\"Enter production year\"\n                      onChange={this.onInput(\"productionYear\", data =>\n                        parseInt(data, 10)\n                      )}\n                      value={this.state.movie.productionYear}\n                    />\n                  </div>\n                  <div className=\"form-group\">\n                    <label htmlFor=\"summary\">Summary</label>\n                    <textarea\n                      className=\"form-control\"\n                      id=\"summary\"\n                      aria-describedby=\"summary\"\n                      placeholder=\"Enter summary\"\n                      onChange={this.onInput(\"summary\")}\n                      value={this.state.movie.summary}\n                    />\n                  </div>\n                </div>\n                <div className=\"modal-footer\">\n                  <button\n                    type=\"button\"\n                    className=\"btn btn-secondary\"\n                    data-dismiss=\"modal\"\n                  >\n                    Close\n                  </button>\n                  <button\n                    type=\"button\"\n                    disabled={!this.valid()}\n                    className=\"btn btn-primary\"\n                    onClick={this.state.movie._id ? this.update : this.add}\n                  >\n                    {movie._id ? \"Update\" : \"Save\"}\n                  </button>\n                </div>\n              </div>\n            </div>\n          </div>\n        )}\n      </Fragment>\n    );\n  }\n}\n\nexport const MovieForm = withApplication(withUser(MovieFormWithContext));\n","import React, {\n  Fragment,\n  useContext,\n  useEffect,\n  useState,\n  useRef\n} from \"react\";\nimport { MovieCard } from \"./MovieCard\";\nimport isArray from \"lodash/isArray\";\nimport { ApplicationContext, LOADING } from \"../ApplicationContext\";\nimport { MoviesContext } from \"../Common/MoviesContext\";\nimport { MoviesFilter } from \"./MoviesFilter\";\nimport * as MovieAPI from \"../Common/MovieAPI\";\nimport { UserContext } from \"../Login/UserContext\";\nimport debounce from \"lodash/debounce\";\nimport { MovieForm } from \"./MovieForm\";\n\nconst newMovie = () => ({});\nconst getMovies = MovieAPI.getMovies(true);\n\nconst buildQuery = (filters, offset) => {\n  // can use lodash/partition to one line\n  const genres = filters.genres\n    .filter(genre => genre[1])\n    .map(genre => genre[0]);\n  const notGenres = filters.genres\n    .filter(genre => !genre[1])\n    .map(genre => genre[0]);\n  return Object.keys(filters)\n    .filter(key => key !== \"genres\") // handle genres manually)\n    .filter(\n      key =>\n        (!isArray(filters[key]) &&\n          filters[key] !== null &&\n          filters[key] !== \"\") ||\n        (isArray(filters[key]) && filters[key].length > 0)\n    )\n    .map(key => `${key}=${filters[key]}`)\n    .concat(\n      genres.length > 0 ? `genres=${genres.join(\",\")}` : \"\",\n      notGenres.length > 0 ? `notGenres=${notGenres.join(\",\")}` : \"\",\n      `offset=${offset}`\n    )\n    .filter(Boolean) // remove empty strings\n    .join(\"&\");\n};\n\nexport const List = () => {\n  // load contexts\n  const { status } = useContext(ApplicationContext);\n  const {\n    invalidate,\n    movies,\n    count,\n    addAll,\n    filters,\n    add,\n    update\n  } = useContext(MoviesContext);\n  const user = useContext(UserContext);\n\n  // create state\n  const [offset, setOffset] = useState(movies.length / filters.limit);\n  const [movie, setMovie] = useState(newMovie());\n  const [key, setKey] = useState(0);\n  // set to true otherwise when navigating back to the page, the loader is displayed\n  const [loaded, setLoaded] = useState(true);\n\n  //create actions\n  const loadMore = _ => {\n    setLoaded(false);\n    getMovies(buildQuery(filters, offset), user).then(movies => {\n      // invalidate if there is a new search\n      if (offset === 0) {\n        invalidate();\n      }\n      setLoaded(true);\n      addAll(movies);\n    });\n  };\n  const showMovie = () => {\n    // ignore first trigger, needed for backward navigation\n    if (key > 0) {\n      // eslint-disable-next-line no-undef\n      $(\"#movie-creator-updator\").modal(\"show\");\n    }\n  };\n\n  // create effects\n  useEffect(\n    () => {\n      // useDebounce :)\n      const debouncedLoadMore = debounce(loadMore, 400, {\n        leading: false,\n        trailing: true\n      });\n      // no movies ? then automatically fetch some (note: every time a filter is updated, movies are cleaned up)\n      // the condition is needed in case of back navigation\n      if (movies.length === 0) {\n        debouncedLoadMore();\n        setLoaded(false);\n      }\n      return () => debouncedLoadMore.cancel();\n    },\n    [filters]\n  );\n  useEffect(showMovie, [movie]);\n\n  const isFirstRun = useRef(true);\n  useEffect(\n    () => {\n      if (isFirstRun.current) {\n        isFirstRun.current = false;\n        return;\n      }\n      loadMore();\n    },\n    [offset]\n  );\n\n  // render\n  return (\n    <div>\n      {status === LOADING ? (\n        <h2 className=\"text-center mt-2\">\n          <i className=\"fas fa-spinner fa-spin fa-2x\" />\n        </h2>\n      ) : (\n        <Fragment>\n          <MovieForm\n            // force reinitialisation of movie form\n            key={movie._id || key}\n            movie={movie._id ? movie : null}\n            onAdd={movie => add(movie)}\n            onUpdate={movie => update(movie._id, movie)}\n          />\n          <i\n            onClick={() => {\n              setMovie(newMovie());\n              setKey(key + 1);\n            }}\n            className=\"fas fa-plus-circle fa-3x\"\n            style={{\n              top: \"22px\",\n              left: \"22px\",\n              position: \"absolute\",\n              color: \"#F1F7EE\",\n              cursor: \"pointer\"\n            }}\n            title=\"Add a movie or a tv show\"\n          />\n          <MoviesFilter />\n          <h2 className=\"text-center\">\n            {movies.length === count && count > 0 ? (\n              <span>{count} movies/tvshows</span>\n            ) : movies.length < count ? (\n              <span>\n                {movies.length} of {count} movies/tvshows\n              </span>\n            ) : loaded ? (\n              <span> No movies/tvshows</span>\n            ) : null}\n          </h2>\n          <div className=\"movies\">\n            {movies.map(movie => (\n              <MovieCard\n                key={movie._id}\n                movie={movie}\n                onChange={movie => update(movie._id, movie)}\n                onDelete={_ => update(movie._id, undefined)}\n                onEdit={() => {\n                  setMovie({\n                    ...movie // create a new movie to force the show effect to be displayed\n                  });\n                  setKey(key + 1); // mandatory otherwise first edit fail\n                }}\n              />\n            ))}\n          </div>\n          <h2 className=\"text-center mt-2\">\n            {!loaded ? (\n              <span>\n                <i className=\"fas fa-spinner fa-spin fa-2x\" />\n              </span>\n            ) : null}\n          </h2>\n          {movies.length < count && loaded ? (\n            <div className=\"text-center m-3\">\n              <button\n                onClick={() => setOffset(offset + 1)}\n                className=\"btn btn-primary btn-lg\"\n              >\n                Load more\n              </button>\n            </div>\n          ) : (\n            undefined\n          )}\n        </Fragment>\n      )}\n    </div>\n  );\n};\n","import React, { Fragment, useState } from \"react\";\nimport identity from \"lodash/identity\";\n\nconst EditableField = props => {\n  const [value, setValue] = useState(props.value || \"\");\n  const [edit, setEdit] = useState(!props.value);\n  const transform = props.transform || identity;\n  const lock = props.lock || false;\n  return (\n    <Fragment>\n      {!lock && edit ? (\n        <Fragment>\n          {props.renderFormField({\n            ...props,\n            value,\n            onChange: event => setValue(transform(event.target.value)),\n            submit: () => {\n              if (value) {\n                props.onChange(value);\n                setEdit(false);\n              }\n            }\n          })}\n          <button\n            className=\"btn btn-primary\"\n            onClick={event => {\n              event.preventDefault();\n              event.stopPropagation();\n              if (value) {\n                props.onChange(value);\n                setEdit(false);\n              }\n            }}\n          >\n            OK\n          </button>\n        </Fragment>\n      ) : (\n        <Fragment>\n          {props.renderValue({\n            className: props.className,\n            value,\n            onClick: event => {\n              if (!lock) {\n                event.preventDefault();\n                event.stopPropagation();\n                setEdit(true);\n              }\n            }\n          })}\n        </Fragment>\n      )}\n    </Fragment>\n  );\n};\n\nexport const EditableInput = props => (\n  <EditableField\n    {...props}\n    renderFormField={fieldProps => (\n      <div className=\"form-inline d-inline-block\">\n        <input\n          className=\"form-control mr-1\"\n          placeholder={fieldProps.placeholder}\n          type={props.type || \"text\"}\n          value={fieldProps.value}\n          onKeyDown={event => {\n            if (event.key === \"Enter\") {\n              fieldProps.submit();\n            }\n          }}\n          onChange={fieldProps.onChange}\n          onClick={event => {\n            event.preventDefault();\n            event.stopPropagation();\n          }}\n        />\n      </div>\n    )}\n    renderValue={valueProps => (\n      <span onClick={valueProps.onClick} className={valueProps.className}>\n        {valueProps.value}\n      </span>\n    )}\n  />\n);\n\nexport const EditableTextarea = props => (\n  <EditableField\n    {...props}\n    renderFormField={fieldProps => (\n      <textarea\n        className=\"form-control w-100\"\n        placeholder={fieldProps.placeholder}\n        style={fieldProps.style}\n        value={fieldProps.value}\n        rows={fieldProps.rows || 2}\n        onKeyDown={event => {\n          if (event.key === \"Enter\" && event.ctrlKey) {\n            fieldProps.submit();\n          }\n        }}\n        onChange={fieldProps.onChange}\n        onClick={event => {\n          event.preventDefault();\n          event.stopPropagation();\n        }}\n      />\n    )}\n    renderValue={valueProps => (\n      <span onClick={valueProps.onClick} className={valueProps.className}>\n        {props.split ? (\n          valueProps.value.split(\"\\n\").map((item, key) => (\n            <Fragment key={key}>\n              {item}\n              <br />\n            </Fragment>\n          ))\n        ) : (\n          <Fragment>{valueProps.value}</Fragment>\n        )}\n      </span>\n    )}\n  />\n);\n","import React, { useReducer } from \"react\";\n\nexport const NotificationContext = React.createContext();\n\nfunction reducer(state = [], action) {\n  switch (action.type) {\n    case \"ADD\":\n      return [...state, { ...action.payload, id: new Date().getTime() }];\n    case \"CLOSE\":\n      return state.filter(\n        notification => notification.id !== action.payload.id\n      );\n    default:\n      return state;\n  }\n}\n\nexport const NotificationProvider = props => {\n  const [state, dispatch] = useReducer(reducer, []);\n  return (\n    <NotificationContext.Provider value={{ notifications: state, dispatch }}>\n      {props.children}\n    </NotificationContext.Provider>\n  );\n};\n","import { EditableInput, EditableTextarea } from \"../../Common/EditableField\";\nimport React, { useContext, useState } from \"react\";\nimport { UserContext } from \"../../Login/UserContext\";\nimport { produce } from \"immer\";\nimport * as MovieAPI from \"../../Common/MovieAPI\";\nimport { MovieContext } from \"../Movie\";\nimport { SeasonContext } from \"./Season\";\nimport { NotificationContext } from \"../../Notifications/NotificationContext\";\n\nexport const Episode = ({\n  episode,\n  index,\n  onEpisodeChanged, // TODO this is a design flow ... it should really return the episode instead of the movie\n  onDragStart,\n  onDragOver,\n  onDragEnd,\n  dragging\n}) => {\n  // get contexts\n  const user = useContext(UserContext);\n  const { movie, lock } = useContext(MovieContext);\n  const { season, index: seasonIndex } = useContext(SeasonContext);\n  const { dispatch } = useContext(NotificationContext);\n\n  // local state\n  const [ellipsis, setEllipsis] = useState(\"ellipsis\");\n  const [style, setStyle] = useState({});\n\n  // actions\n  const episodeTag = () => {\n    return `S${(seasonIndex + 1).toString().padStart(2, \"0\")}E${(index + 1)\n      .toString()\n      .padStart(2, \"0\")}`;\n  };\n\n  const updateSeason = transform => {\n    return MovieAPI.updateSeason(movie, produce(season, transform), user)\n      .then(onEpisodeChanged)\n      .catch(error => {\n        dispatch({\n          type: \"ADD\",\n          payload: { content: error.message, type: \"error\" }\n        });\n        throw error;\n      });\n  };\n  const updateEpisode = transform => {\n    const transformedEpisode = produce(episode, transform); // optimistic update\n    onEpisodeChanged(\n      produce(movie, draft => {\n        draft.seasons[seasonIndex].episodes[index] = transformedEpisode;\n      })\n    );\n    return MovieAPI.updateEpisode(\n      movie,\n      season,\n      transformedEpisode,\n      user\n    ).catch(error => {\n      onEpisodeChanged(\n        produce(movie, draft => {\n          draft.seasons[seasonIndex].episodes[index] = episode;\n        })\n      );\n      dispatch({\n        type: \"ADD\",\n        payload: { content: error.message, type: \"error\" }\n      });\n      throw error;\n    });\n  };\n\n  return (\n    <div\n      className=\"row episode mr-0 ml-0\"\n      draggable\n      onDragStart={event => {\n        setStyle({\n          backgroundColor: \"var(--movie-secondary-lighter)\",\n          opacity: \"0.4\",\n          color: \"var(--movie-primary)\"\n        });\n        event.dataTransfer.dropEffect = \"move\";\n        event.stopPropagation();\n        onDragStart();\n      }}\n      onDragOver={() => {\n        dragging && onDragOver();\n      }}\n      onDragEnd={event => {\n        event.stopPropagation();\n        onDragEnd();\n        setStyle({});\n      }}\n      style={style}\n    >\n      <div className=\" col-md-12 col-xl-2 align-items-center d-flex p-0\">\n        {!lock && (\n          <i\n            className=\"fas fa-times delete-episode\"\n            onClick={event => {\n              event.preventDefault();\n              event.stopPropagation();\n              if (window.confirm(\"Delete episode ?\")) {\n                MovieAPI.deleteEpisode(movie, season, episode, user).then(\n                  onEpisodeChanged\n                );\n              }\n            }}\n          />\n        )}\n        <div\n          className=\"text-center col-1\"\n          style={{\n            color: episode.seen ? \"var(--success)\" : \"\",\n            fontWeight: episode.seen ? \"bold\" : \"\",\n            cursor: \"pointer\"\n          }}\n          onClick={() =>\n            updateSeason(season => {\n              if (!season.episodes[index].seen) {\n                for (let i = 0; i <= index; i++) {\n                  season.episodes[i].seen = true;\n                }\n              } else {\n                season.episodes[index].seen = false;\n              }\n            }).then(() => {\n              dispatch({\n                type: \"ADD\",\n                payload: { content: \"Update to seen\", type: \"success\" }\n              });\n            })\n          }\n        >\n          {index + 1}\n        </div>\n        <div className=\"text-center col-11\">\n          <EditableInput\n            lock={lock}\n            className={`font-weight-bold episode-title ${\n              episode.seen ? \"seen\" : \"\"\n            }`}\n            value={episode.title}\n            placeholder=\"Title\"\n            onChange={title =>\n              updateEpisode(episode => {\n                episode.title = title;\n              }).then(() => {\n                dispatch({\n                  type: \"ADD\",\n                  payload: {\n                    content: `${episodeTag()} - Title updated`,\n                    type: \"success\"\n                  }\n                });\n              })\n            }\n          />\n        </div>\n      </div>\n      <div className=\"col-md-12 col-xl-10 align-items-center d-flex\">\n        <EditableTextarea\n          lock={lock}\n          style={{ width: \"100%\" }}\n          rows={4}\n          value={episode.summary}\n          placeholder=\"Summary\"\n          className={`${ellipsis} d-block episode-summary w-100 text-left`}\n          onChange={summary =>\n            updateEpisode(episode => {\n              episode.summary = summary;\n            }).then(() => {\n              dispatch({\n                type: \"ADD\",\n                payload: {\n                  content: `${episodeTag()} - Summary updated`,\n                  type: \"success\"\n                }\n              });\n            })\n          }\n        />\n        {ellipsis && (\n          <span style={{ cursor: \"pointer\" }} onClick={() => setEllipsis(\"\")}>\n            <i className=\"fas fa-question-circle\" />\n          </span>\n        )}\n      </div>\n    </div>\n  );\n};\n","import { useState } from \"react\";\n\nexport const useToggle = (initialValue = false) => {\n  const [value, setValue] = useState(initialValue);\n  const toggle = () => setValue(!value);\n  return [value, toggle];\n};\n\nexport const useInput = (initialValue = \"\") => {\n  const [value, setValue] = useState(initialValue);\n  return [\n    {\n      value,\n      onChange: event => setValue(event.target.value)\n    },\n    setValue\n  ];\n};\n","import { useContext, Fragment, useState } from \"react\";\nimport { EditableInput } from \"../../Common/EditableField\";\nimport * as MovieAPI from \"../../Common/MovieAPI\";\nimport React from \"react\";\nimport { produce } from \"immer\";\nimport { UserContext } from \"../../Login/UserContext\";\nimport \"./Season.css\";\nimport { MovieSeen } from \"../../Common/MovieSeen\";\nimport { Episode } from \"./Episode\";\nimport every from \"lodash/every\";\nimport some from \"lodash/some\";\nimport { useToggle } from \"../../Common/hooks\";\nimport { MovieContext } from \"../../Movie/Movie\";\nimport { NotificationContext } from \"../../Notifications/NotificationContext\";\n\nexport const SeasonContext = React.createContext({});\n\nexport const Season = ({\n  season,\n  index,\n  onMovieChanged, // TODO this is a design flow ... it should be onSeasonChanged and update the season only\n  onDragStart,\n  onDragOver,\n  onDragEnd,\n  dragging\n}) => {\n  // get contexts\n  const user = useContext(UserContext);\n  const { movie, lock } = useContext(MovieContext);\n  const { dispatch } = useContext(NotificationContext);\n\n  const [open, toggle] = useToggle();\n  const [episodes, setEpisodes] = useState(1);\n  const [opacity, setOpacity] = useState(\"1\");\n  const [drag, setDrag] = useState();\n\n  // actions\n  const updateSeason = (transform = value => value) => {\n    MovieAPI.updateSeason(movie, produce(season, transform), user)\n      .then(onMovieChanged)\n      .catch(error => {\n        dispatch({\n          type: \"ADD\",\n          payload: { content: error.message, type: \"error\" }\n        });\n      });\n  };\n\n  const seen = every(season.episodes, \"seen\") && season.episodes.length > 0;\n  const oneSeen = some(season.episodes, \"seen\") && season.episodes.length > 0;\n\n  return (\n    <div\n      className=\"season\"\n      draggable\n      onDragStart={event => {\n        setOpacity(\"0.5\");\n        event.dataTransfer.dropEffect = \"move\";\n        event.stopPropagation();\n        onDragStart();\n      }}\n      onDragEnd={event => {\n        event.stopPropagation();\n        onDragEnd();\n        setOpacity(\"1.5\");\n      }}\n      onDragOver={() => {\n        dragging && onDragOver();\n      }}\n      style={{\n        opacity\n      }}\n    >\n      <div className=\"season-header\" onClick={toggle}>\n        <div>\n          <div\n            className=\"season-header-view\"\n            onClick={event => {\n              event.preventDefault();\n              event.stopPropagation();\n              updateSeason(season => {\n                season.seen = !seen;\n              });\n            }}\n          >\n            <MovieSeen seen={seen} partial={oneSeen} />\n          </div>\n          {!lock && (\n            <i\n              className=\"fas fa-times delete-season\"\n              onClick={event => {\n                event.preventDefault();\n                event.stopPropagation();\n                if (window.confirm(\"Delete season ?\")) {\n                  MovieAPI.deleteSeason(movie, season, user).then(\n                    onMovieChanged\n                  );\n                }\n              }}\n            />\n          )}\n          &nbsp;Season {index + 1}\n          &nbsp;-&nbsp;\n          <EditableInput\n            lock={lock}\n            placeholder=\"YYYY\"\n            type=\"number\"\n            value={season.productionYear}\n            transform={value => parseInt(value, 10)}\n            onChange={productionYear =>\n              updateSeason(season => {\n                season.productionYear = productionYear;\n              })\n            }\n          />\n        </div>\n        <div className=\"season-header-arrow\">\n          {open ? (\n            <i className=\"fas fa-chevron-up\" />\n          ) : (\n            <i className=\"fas fa-chevron-down\" />\n          )}\n        </div>\n      </div>\n      <div className=\"episodes\">\n        <SeasonContext.Provider value={{ season, index }}>\n          {open &&\n            season.episodes.map((episode, episodeIndex) => (\n              <Episode\n                key={episode._id}\n                episode={episode}\n                index={episodeIndex}\n                onEpisodeChanged={onMovieChanged}\n                dragging={drag !== undefined}\n                onDragStart={() => {\n                  setDrag(episodeIndex);\n                }}\n                onDragOver={() => {\n                  if (episodeIndex !== drag) {\n                    setDrag(episodeIndex);\n                    season.episodes = produce(season.episodes, draft => {\n                      const tmp = draft[episodeIndex];\n                      draft[episodeIndex] = draft[drag];\n                      draft[drag] = tmp;\n                    });\n                  }\n                }}\n                onDragEnd={() => {\n                  updateSeason();\n                  setDrag();\n                }}\n              />\n            ))}\n        </SeasonContext.Provider>\n      </div>\n\n      {!lock ? (\n        <Fragment>\n          {open && (\n            <div className=\"form-inline d-block mt-1 mb-1\">\n              <input\n                type=\"number\"\n                className=\"form-control\"\n                style={{ width: \"80px\" }}\n                onChange={event =>\n                  setEpisodes(parseInt(event.target.value, 10))\n                }\n                value={episodes}\n              />\n              <button\n                className=\" ml-1 btn btn-primary\"\n                onClick={async () => {\n                  let times = episodes || 1;\n                  while (times > 0) {\n                    await MovieAPI.addEpisode(movie, season, user);\n                    times--;\n                  }\n                  setEpisodes(1);\n                  MovieAPI.getMovie(movie._id, user).then(onMovieChanged);\n                }}\n              >\n                <i className=\"fas fa-plus\" />\n                &nbsp;Add episode\n              </button>\n            </div>\n          )}\n        </Fragment>\n      ) : (\n        undefined\n      )}\n    </div>\n  );\n};\n","import React, {\n  Fragment,\n  useContext,\n  useEffect,\n  useState,\n  useRef\n} from \"react\";\nimport { withRouter } from \"react-router-dom\";\nimport * as MovieAPI from \"../Common/MovieAPI\";\nimport { UserContext } from \"../Login/UserContext\";\nimport { MovieSeen } from \"../Common/MovieSeen\";\nimport { MoviesContext } from \"../Common/MoviesContext\";\nimport { produce } from \"immer\";\nimport { Season } from \"./Season/Season\";\nimport { EditableInput, EditableTextarea } from \"../Common/EditableField\";\nimport { useToggle } from \"../Common/hooks\";\nimport \"./Movie.css\";\nimport { ApplicationContext } from \"../ApplicationContext\";\nimport { Tag } from \"../Admin/Tag\";\nimport { NotificationContext } from \"../Notifications/NotificationContext\";\n\nexport const MovieContext = React.createContext({});\n\nconst MovieTag = ({ tag, selected, onAdd, onDelete, lock }) =>\n  !lock ? (\n    <span onClick={selected ? onDelete : onAdd} className=\"mt-1\">\n      <Tag\n        {...tag}\n        className={`movie-tag mr-1 ${selected ? \"selected\" : \"\"}`}\n      />\n    </span>\n  ) : selected ? (\n    <span className=\"mt-1\">\n      <Tag {...tag} className={`mr-1 selected`} />\n    </span>\n  ) : null;\nexport const Movie = withRouter(({ match, history }) => {\n  // get contexts\n  const user = useContext(UserContext);\n  const movies = useContext(MoviesContext);\n  const [seasons, setSeasons] = useState(1);\n  const { tags } = useContext(ApplicationContext);\n  const { dispatch } = useContext(NotificationContext);\n  // create state\n  const [drag, setDrag] = useState();\n  const [movie, setMovie] = useState();\n  const [lock, toggle] = useToggle(true);\n\n  const fileRef = useRef();\n\n  // create effects\n  useEffect(() => MovieAPI.getMovie(match.params.id, user).then(setMovie), [\n    match.params.id\n  ]);\n\n  // create actions\n  const updateMovie = (transform = value => value) => {\n    MovieAPI.updateMovie(produce(movie, transform), user)\n      .then(mergeContext)\n      .catch(error => {\n        dispatch({\n          type: \"ADD\",\n          payload: { content: error.message, type: \"error\" }\n        });\n      });\n  };\n  const handleFiles = files => {\n    if (files.length === 1) {\n      MovieAPI.updateMoviePoster(movie, files[0], user)\n        .then(mergeContext)\n        .catch(error => {\n          dispatch({\n            type: \"ADD\",\n            payload: { content: error.message, type: \"error\" }\n          });\n        });\n    }\n  };\n\n  // helper\n  const mergeContext = updatedMovie => {\n    setMovie(updatedMovie);\n    movies.update(updatedMovie._id, updatedMovie);\n  };\n\n  return (\n    <div className=\"container movie-container\">\n      {!movie ? (\n        <h2 className=\"text-center mt-2\">\n          <i className=\"fas fa-spinner fa-spin fa-2x\" />\n        </h2>\n      ) : (\n        <Fragment>\n          <i\n            onClick={() => history.goBack()}\n            className=\"fas fa-arrow-circle-left fa-3x\"\n            style={{\n              top: \"22px\",\n              left: \"22px\",\n              position: \"absolute\",\n              color: \"#F1F7EE\",\n              cursor: \"pointer\"\n            }}\n            title=\"Return to the list of movies\"\n          />\n          <div\n            className=\"p-5 mt-3 single-movie-card\"\n            style={{ position: \"relative\" }}\n          >\n            <i\n              onClick={toggle}\n              className={`fas ${lock ? \"fa-lock\" : \"fa-lock-open\"} fa-2x`}\n              style={{\n                color: \"var(--movie-secondary)\",\n                position: \"absolute\",\n                top: \"5px\",\n                right: \"5px\",\n                cursor: \"pointer\"\n              }}\n              title={`Click to ${\n                lock ? \"open\" : \"close\"\n              } movie for modifications`}\n            />\n            <div className=\"d-flex\">\n              <div\n                className=\"d-flex\"\n                style={{ flex: \"0 0 250px\", flexDirection: \"column\" }}\n              >\n                <input\n                  accept=\".jpg, .jpeg, .png\"\n                  type=\"file\"\n                  ref={fileRef}\n                  style={{ display: \"none\" }}\n                  onChange={event => handleFiles(event.target.files)}\n                />\n                <img\n                  src={\n                    movie.fileUrl\n                      ? movie.fileUrl.replace(\"http:\", \"https:\")\n                      : \"/no-image.png\"\n                  }\n                  style={{\n                    height: \"300px\",\n                    width: \"225px\",\n                    cursor: lock ? \"auto\" : \"pointer\"\n                  }}\n                  alt=\"movie poster\"\n                  onClick={() => !lock && fileRef.current.click()}\n                />\n                <div className=\"d-flex flex-wrap\">\n                  {tags.map(tag => (\n                    <MovieTag\n                      key={tag._id}\n                      tag={tag}\n                      lock={lock}\n                      selected={movie.tags.find(\n                        movieTag => movieTag === tag._id\n                      )}\n                      onAdd={() =>\n                        updateMovie(movie => {\n                          movie.tags.push(tag._id);\n                        })\n                      }\n                      onDelete={() =>\n                        updateMovie(movie => {\n                          movie.tags = movie.tags.filter(\n                            movieTag => movieTag !== tag._id\n                          );\n                        })\n                      }\n                    />\n                  ))}\n                </div>\n              </div>\n              <div className=\"pl-4 d-flex flex-column\" style={{ flexGrow: 1 }}>\n                <h1 className=\"text-center\">\n                  <EditableInput\n                    lock={lock}\n                    value={movie.title}\n                    placeholder=\"Title\"\n                    onChange={title =>\n                      updateMovie(movie => {\n                        movie.title = title;\n                      })\n                    }\n                  />{\" \"}\n                  -{\" \"}\n                  <EditableInput\n                    lock={lock}\n                    value={movie.productionYear}\n                    placeholder=\"YYYY\"\n                    type=\"number\"\n                    transform={value => parseInt(value, 10)}\n                    onChange={productionYear =>\n                      updateMovie(movie => {\n                        movie.productionYear = productionYear;\n                      })\n                    }\n                  />\n                </h1>\n                <h6 className=\"text-center single-movie-subtitle\">\n                  {movie.genre.join(\",\")}\n                </h6>\n                <div>\n                  <EditableTextarea\n                    split={true}\n                    lock={lock}\n                    value={movie.summary}\n                    style={{ width: \"100%\" }}\n                    placeholder=\"Summary\"\n                    rows=\"7\"\n                    onChange={summary =>\n                      updateMovie(movie => {\n                        movie.summary = summary;\n                      })()\n                    }\n                  />\n                </div>\n              </div>\n            </div>\n            <div>\n              {movie.type === \"Film\" ? (\n                <MovieSeen\n                  seen={movie.seen}\n                  onClick={() =>\n                    updateMovie(movie => {\n                      movie.seen = !movie.seen;\n                    })\n                  }\n                />\n              ) : (\n                undefined\n              )}\n            </div>\n            <div className=\"text-center\">\n              {movie.type !== \"Film\" ? (\n                <Fragment>\n                  <MovieContext.Provider value={{ lock, movie }}>\n                    <div>\n                      {movie.seasons.map((season, seasonIndex) => (\n                        <Season\n                          key={season._id}\n                          season={season}\n                          index={seasonIndex}\n                          onMovieChanged={mergeContext}\n                          dragging={drag !== undefined}\n                          onDragStart={() => setDrag(seasonIndex)}\n                          onDragOver={() => {\n                            if (seasonIndex !== drag) {\n                              setDrag(seasonIndex);\n                              movie.seasons = produce(movie.seasons, draft => {\n                                const tmp = draft[seasonIndex];\n                                draft[seasonIndex] = draft[drag];\n                                draft[drag] = tmp;\n                              });\n                            }\n                          }}\n                          onDragEnd={() => {\n                            updateMovie();\n                            setDrag();\n                          }}\n                        />\n                      ))}\n                    </div>\n                  </MovieContext.Provider>\n                  {!lock ? (\n                    <div className=\"form-inline d-block mt-1 mb-1\">\n                      <input\n                        type=\"number\"\n                        className=\"form-control\"\n                        style={{ width: \"80px\" }}\n                        onChange={event =>\n                          setSeasons(parseInt(event.target.value, 10))\n                        }\n                        value={seasons}\n                      />\n                      <button\n                        className=\" ml-1 btn btn-primary\"\n                        onClick={async () => {\n                          let times = seasons || 1;\n                          while (times > 0) {\n                            await MovieAPI.addSeason(movie, user);\n                            times--;\n                          }\n                          setSeasons(1);\n                          MovieAPI.getMovie(movie._id, user).then(mergeContext);\n                        }}\n                      >\n                        <i className=\"fas fa-plus\" />\n                        &nbsp;Add season\n                      </button>\n                    </div>\n                  ) : (\n                    undefined\n                  )}\n                </Fragment>\n              ) : (\n                undefined\n              )}\n            </div>\n          </div>\n        </Fragment>\n      )}\n    </div>\n  );\n});\n","import React, { Component, Fragment } from \"react\";\nimport debounce from \"lodash/debounce\";\nimport { withUser } from \"../Login/UserContext\";\n\nexport const LOADING = Symbol(\"LOADING\");\nexport const LOADED = Symbol(\"LOADED\");\n\nconst headers = user => ({\n  Accept: \"application/json\",\n  \"Content-Type\": \"application/json\",\n  Authorization: `Bearer ${user.token}`\n});\nconst handleResponse = response => {\n  if (response.ok) return response.json();\n  throw new Error(\"Fetch fail\");\n};\n\nclass FetchWithContext extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      status: LOADING,\n      data: undefined\n    };\n\n    // TODO probably not the best place to debounce\n    this.debounceFetch = debounce(this.fetch, this.props.debounce || 0, {\n      leading: false,\n      trailing: true\n    });\n  }\n\n  componentWillUnmount() {\n    this.debounceFetch.cancel();\n  }\n\n  fetch() {\n    return fetch(`${this.props.endpoint}`, {\n      headers: headers(this.props.user)\n    })\n      .then(handleResponse)\n      .then(data => {\n        this.setState({\n          status: LOADED,\n          data\n        });\n        this.props.onSuccess && this.props.onSuccess(data);\n      });\n  }\n\n  componentDidMount() {\n    this.debounceFetch();\n  }\n\n  render() {\n    return (\n      <Fragment>\n        {this.props.children({\n          status: this.state.status,\n          data: this.state.data\n        })}\n      </Fragment>\n    );\n  }\n}\n\n/**\n * - create a context that holds movies\n * - dont load if there is already sth in the context\n * - pass initial data to prevent fetch the api (if data, dont fetch on cDM)\n */\n\nexport const Fetch = withUser(FetchWithContext);\n","import { Fetch } from \"./Common/Fetch\";\nimport React from \"react\";\nimport { Link } from \"react-router-dom\";\n\nexport const Header = () => {\n  return (\n    <div\n      className=\"text-center\"\n      style={{\n        backgroundColor: \"var(--movie-secondary)\",\n        color: \"var(--movie-primary)\",\n        padding: \"4px\"\n      }}\n    >\n      <h1 className=\"header\">\n        <Link to=\"/\">Cinematheque</Link>\n      </h1>\n      <Fetch endpoint=\"/api/movies?limit=0\">\n        {({ data }) => <h6>{data ? data.count : 0} movies/tvshows</h6>}\n      </Fetch>\n      <Link to=\"/stats\">\n        <i\n          className=\"fas fa-chart-bar fa-3x\"\n          style={{\n            top: \"22px\",\n            right: \"22px\",\n            position: \"absolute\",\n            color: \"#F1F7EE\",\n            cursor: \"pointer\"\n          }}\n          title=\"Show statistics\"\n        />\n      </Link>\n    </div>\n  );\n};\n","import React, { Fragment, useContext, useEffect, useState } from \"react\";\nimport { ApplicationContext } from \"../ApplicationContext\";\nimport * as MovieAPI from \"../Common/MovieAPI\";\nimport \"./Statistics.css\";\nimport { produce } from \"immer\";\nimport { UserContext } from \"../Login/UserContext\";\nimport orderBy from \"lodash/orderBy\";\nimport { Tag } from \"../Admin/Tag\";\nimport { MoviesContext } from \"../Common/MoviesContext\";\nimport { withRouter } from \"react-router-dom\";\n\nconst getMovies = MovieAPI.getMovies(false);\n\nconst initialState = (types, genres, tags) => {\n  return {\n    types: types.map(type => ({\n      name: type,\n      count: 0,\n      genres: genres.map(genre => ({\n        name: genre,\n        count: 0,\n        seen: 0,\n        unseen: 0\n      }))\n    })),\n    tags: tags.map(tag => ({\n      id: tag._id,\n      name: tag.label,\n      color: tag.color,\n      count: 0\n    }))\n  };\n};\n\nexport const Statistics = withRouter(({ history }) => {\n  // get contexts\n  const user = useContext(UserContext);\n  const { genres, types, tags } = useContext(ApplicationContext);\n  const { resetFilters, onChange } = useContext(MoviesContext);\n  const [stats, setStats] = useState(initialState(types, genres, tags));\n\n  // actions\n  const fetchByTypes = (types, genres) => {\n    types.forEach(type =>\n      getMovies(`types=${type}&limit=0`, user)\n        .then(data =>\n          setStats(\n            produce(\n              draft =>\n                void (draft.types.find(t => type === t.name).count = data.count)\n            )\n          )\n        )\n        .then(() =>\n          genres.forEach(genre => {\n            getMovies(`types=${type}&genres=${genre}&limit=0`, user).then(\n              data =>\n                setStats(\n                  produce(\n                    draft =>\n                      void (draft.types\n                        .find(t => type === t.name)\n                        .genres.find(g => genre === g.name).count = data.count)\n                  )\n                )\n            );\n            getMovies(\n              `types=${type}&genres=${genre}&seen=true&limit=0`,\n              user\n            ).then(data =>\n              setStats(\n                produce(\n                  draft =>\n                    void (draft.types\n                      .find(t => type === t.name)\n                      .genres.find(g => genre === g.name).seen = data.count)\n                )\n              )\n            );\n            getMovies(\n              `types=${type}&genres=${genre}&seen=false&limit=0`,\n              user\n            ).then(data =>\n              setStats(\n                produce(\n                  draft =>\n                    void (draft.types\n                      .find(t => type === t.name)\n                      .genres.find(g => genre === g.name).unseen = data.count)\n                )\n              )\n            );\n          })\n        )\n    );\n  };\n\n  const fetchByTags = tags => {\n    tags.forEach(tag =>\n      getMovies(`tags=${tag._id}&limit=0`, user).then(data =>\n        setStats(\n          produce(draft => {\n            draft.tags.find(t => tag._id === t.id).count += data.count;\n          })\n        )\n      )\n    );\n  };\n\n  // effects\n  useEffect(\n    () => {\n      setStats(initialState(types, genres, tags));\n      fetchByTypes(types, genres);\n      fetchByTags(tags);\n    },\n    [types, genres, tags]\n  );\n\n  return (\n    <div className=\"d-flex justify-content-around flex-wrap mb-4\">\n      {stats.types.map((type, index) => (\n        <div className=\"card stat-card\" key={index}>\n          <div className=\"card-body\">\n            <h5 className=\"card-title text-center\">\n              {type.count} {type.name}\n            </h5>\n            <div>\n              {orderBy(type.genres, [\"count\"], [\"desc\"]).map((genre, index) => (\n                <Fragment key={index}>\n                  <div>\n                    {\" \"}\n                    {genre.count} {genre.name} ({\" \"}\n                    {genre.count\n                      ? ((genre.seen * 100) / genre.count).toFixed(2)\n                      : 0}\n                    % seen){\" \"}\n                  </div>\n                  <div className=\"movie-progress\">\n                    <div\n                      className=\"progress-bar unseen\"\n                      role=\"progressbar\"\n                      style={{\n                        width: `calc(20px + ${(genre.unseen * 100) /\n                          orderBy(type.genres, [\"count\"], [\"desc\"])[0].count}%)`\n                      }}\n                    >\n                      {genre.unseen}\n                    </div>\n                    {genre.count - genre.unseen - genre.seen ? (\n                      <div\n                        className=\"progress-bar pending\"\n                        role=\"progressbar\"\n                        style={{\n                          width: `calc(20px + ${((genre.count -\n                            genre.unseen -\n                            genre.seen) *\n                            100) /\n                            orderBy(type.genres, [\"count\"], [\"desc\"])[0]\n                              .count}%)`\n                        }}\n                      >\n                        {genre.count - genre.unseen - genre.seen}\n                      </div>\n                    ) : (\n                      undefined\n                    )}\n                    <div\n                      className=\"progress-bar seen\"\n                      role=\"progressbar\"\n                      style={{\n                        width: `calc(20px + ${(genre.seen * 100) /\n                          orderBy(type.genres, [\"count\"], [\"desc\"])[0].count}%)`\n                      }}\n                    >\n                      {genre.seen}\n                    </div>\n                  </div>\n                </Fragment>\n              ))}\n            </div>\n          </div>\n        </div>\n      ))}\n      <div className=\"card stat-card stat-tags-card\">\n        <div className=\"card-body align-content-center\">\n          {stats.tags.map((tag, index) => (\n            <h5\n              className=\"text-center stat-tags-card-card mt-1\"\n              style={{\n                cursor: \"pointer\"\n              }}\n              key={index}\n            >\n              <Tag\n                label={`${tag.count} ${tag.name}`}\n                color={tag.color}\n                onClick={() => {\n                  resetFilters();\n                  onChange(\"tags\")([tag.id]);\n                  history.push(\"/\");\n                }}\n              />\n            </h5>\n          ))}\n        </div>\n      </div>\n    </div>\n  );\n});\n","const random = max => {\n  return Math.floor(Math.random() * Math.floor(max));\n};\nexport const generateColor = () => {\n  return `#${random(256)\n    .toString(16)\n    .padStart(2, \"0\")}${random(256)\n    .toString(16)\n    .padStart(2, \"0\")}${random(256)\n    .toString(16)\n    .padStart(2, \"0\")}`;\n};\n","import React, { useContext, Fragment } from \"react\";\nimport \"./TagList.css\";\nimport { deleteTag, updateTag } from \"../Common/TagAPI\";\nimport { UserContext } from \"../Login/UserContext\";\nimport { Tag } from \"./Tag\";\nimport { useInput, useToggle } from \"../Common/hooks\";\nimport { generateColor } from \"./tag.utils\";\nimport { ApplicationContext } from \"../ApplicationContext\";\n\nexport const TagListElement = ({ tag, onDelete, onUpdate }) => {\n  const [edit, toggleEdit] = useToggle(false);\n  const [color, setColor] = useInput(tag.color || \"\");\n  const [label] = useInput(tag.label || \"\");\n  // get context\n  const user = useContext(UserContext);\n  const { tags } = useContext(ApplicationContext);\n\n  return (\n    <div\n      className=\"mt-2 mb-2 d-flex\"\n      style={{\n        overflow: \"hidden\" // Collapsing margins\n      }}\n    >\n      {/* avoid the tag element to fill up all the available height */}\n      {!edit ? (\n        <Fragment>\n          <div>\n            <Tag {...tag} big />\n          </div>\n          <button\n            type=\"button\"\n            className=\"btn btn-primary ml-2\"\n            onClick={toggleEdit}\n          >\n            <i className=\"fas fa-pencil-alt\" />\n          </button>\n          <button\n            type=\"button\"\n            className=\"btn btn-danger ml-2\"\n            onClick={_ => {\n              if (window.confirm(\"Delete tag ?\")) {\n                deleteTag(tag, user).then(onDelete);\n              }\n            }}\n          >\n            <i className=\"fas fa-times\" />\n          </button>\n        </Fragment>\n      ) : (\n        <form className=\"form-inline w-100\">\n          <input type=\"color\" className=\"form-control colorpicker\" {...color} />\n          <input\n            type=\"text\"\n            className=\"form-control ml-2\"\n            placeholder=\"Label\"\n            {...label}\n          />\n          <button\n            type=\"button\"\n            className=\"btn btn-info btn-sm ml-2\"\n            onClick={() => {\n              setColor(generateColor());\n            }}\n          >\n            <i className=\"fas fa-sync-alt\" />\n          </button>\n          <button\n            type=\"button\"\n            className=\"btn btn-primary btn-sm ml-2\"\n            onClick={() => {\n              updateTag(\n                {\n                  _id: tag._id,\n                  color: color.value,\n                  label: label.value\n                },\n                user\n              )\n                .then(onUpdate)\n                .then(toggleEdit);\n            }}\n            disabled={\n              !label.value ||\n              tags.find(\n                tag => tag.label.toLowerCase() === label.value.toLowerCase()\n              )\n            }\n          >\n            <i className=\"fas fa-check\" />\n          </button>\n          <Tag\n            style={{ marginLeft: \"auto\" }}\n            color={color.value}\n            label={label.value || \"Label\"}\n          />\n        </form>\n      )}\n    </div>\n  );\n};\n","import React, { useContext } from \"react\";\nimport \"./TagList.css\";\nimport { useInput } from \"../Common/hooks\";\nimport { createTag } from \"../Common/TagAPI\";\nimport { UserContext } from \"../Login/UserContext\";\nimport { Tag } from \"./Tag\";\nimport { ApplicationContext } from \"../ApplicationContext\";\nimport { TagListElement } from \"./TagListElement\";\nimport { generateColor } from \"./tag.utils\";\nimport { produce } from \"immer\";\n\nexport const TagList = () => {\n  // get context\n  const user = useContext(UserContext);\n  const { tags, set } = useContext(ApplicationContext);\n  const setTags = set(\"tags\");\n\n  // create state\n  const [color, setColor] = useInput(generateColor());\n  const [label, setLabel] = useInput(\"\");\n\n  return (\n    <div className=\"container tags-card\">\n      {tags.map((tag, index) => (\n        <TagListElement\n          key={tag._id}\n          tag={tag}\n          onDelete={() => setTags(tags => tags.filter(t => t._id !== tag._id))}\n          onUpdate={tag => {\n            setTags(tags =>\n              produce(tags, draft => {\n                draft[index] = tag;\n              })\n            );\n          }}\n        />\n      ))}\n      <form className=\"form-inline\">\n        <input type=\"color\" className=\"form-control colorpicker\" {...color} />\n        <input\n          type=\"text\"\n          className=\"form-control ml-2\"\n          placeholder=\"Label\"\n          {...label}\n        />\n        <button\n          type=\"button\"\n          className=\"btn btn-info btn-sm ml-2\"\n          onClick={() => {\n            setColor(generateColor());\n          }}\n        >\n          <i className=\"fas fa-sync-alt\" />\n        </button>\n        <button\n          type=\"button\"\n          className=\"btn btn-primary btn-sm ml-2\"\n          onClick={() => {\n            createTag(\n              {\n                label: label.value,\n                color: color.value\n              },\n              user\n            )\n              .then(tag => setTags(tags => [...tags, tag]))\n              .then(_ => {\n                setColor(generateColor());\n                setLabel(\"\");\n              });\n          }}\n          disabled={\n            !label.value ||\n            tags.find(\n              tag => tag.label.toLowerCase() === label.value.toLowerCase()\n            )\n          }\n        >\n          <i className=\"fas fa-check\" />\n        </button>\n        <Tag\n          style={{ marginLeft: \"auto\" }}\n          color={color.value}\n          label={label.value || \"Label\"}\n        />\n      </form>\n    </div>\n  );\n};\n","import React, { useContext, useState } from \"react\";\nimport \"./Notification.css\";\nimport { NotificationContext } from \"./NotificationContext\";\n\nexport const Notification = ({ index, notification }) => {\n  const [animateProgress, setAnimateProgress] = useState(false);\n  const [notificationOut, setNotificationOut] = useState(false);\n  const { dispatch } = useContext(NotificationContext);\n  return (\n    <div\n      className={`notification ${notification.type} ${\n        notificationOut ? \"out\" : \"in\"\n      }`}\n      onAnimationEnd={event => {\n        if (event.animationName === \"bounceIn\") {\n          setAnimateProgress(true);\n        } else if (event.animationName === \"bounceOut\") {\n          dispatch({ type: \"CLOSE\", payload: { id: notification.id } });\n        }\n      }}\n    >\n      <div className=\"notification-content\">{notification.content}</div>\n      <div\n        className={`notification-progress-bar progress-bar-striped ${\n          animateProgress ? \"animate\" : \"\"\n        }`}\n        style={notificationOut ? { width: \"0\" } : {}}\n        onAnimationEnd={() => setNotificationOut(true)}\n      />\n    </div>\n  );\n};\n","import React, { useContext } from \"react\";\nimport { NotificationContext } from \"./NotificationContext\";\nimport { Notification } from \"./Notification\";\nimport \"./NotificationList.css\";\n\nexport const NotificationsList = () => {\n  const { notifications } = useContext(NotificationContext);\n  return (\n    <div className=\"notification-list\">\n      {notifications.map((notification, index) => (\n        <Notification\n          key={notification.id}\n          index={index}\n          notification={notification}\n        />\n      ))}\n    </div>\n  );\n};\n","import React, { Component, Fragment } from \"react\";\nimport { BrowserRouter as Router, Route } from \"react-router-dom\";\nimport \"./App.css\";\nimport { List } from \"./MovieList/List\";\nimport { Movie } from \"./Movie/Movie\";\nimport { Header } from \"./Header\";\nimport { Statistics } from \"./Statistics/Statistics\";\nimport { TagList } from \"./Admin/TagList\";\nimport { NotificationsList } from \"./Notifications/NotificationsList\";\n\nclass App extends Component {\n  render() {\n    return (\n      <Fragment>\n        <Router>\n          <Fragment>\n            <Header />\n            <NotificationsList />\n            <Route exact path=\"/\" component={List} />\n            <Route exact path=\"/movie/:id\" component={Movie} />\n            <Route exact path=\"/stats\" component={Statistics} />\n            <Route exact path=\"/admin\" component={TagList} />\n          </Fragment>\n        </Router>\n      </Fragment>\n    );\n  }\n}\n\nexport default App;\n","import React, { Component } from \"react\";\nimport { LOGIN_FAILED, withUser } from \"./UserContext\";\n\nclass LoginWithContext extends Component {\n  state = {\n    password: \"\"\n  };\n\n  render() {\n    return (\n      <div>\n        {this.props.user.status === LOGIN_FAILED ? (\n          <div className=\"alert alert-danger\" role=\"alert\">\n            Login failed\n          </div>\n        ) : (\n          undefined\n        )}\n        <div className=\"form-group\">\n          <label htmlFor=\"password\">Password</label>\n          <input\n            type=\"text\"\n            className=\"form-control\"\n            id=\"password\"\n            aria-describedby=\"password\"\n            placeholder=\"Enter password\"\n            value={this.state.password}\n            onChange={event => this.setState({ password: event.target.value })}\n            onKeyDown={event => {\n              if (event.key === \"Enter\")\n                this.props.user.login(this.state.password);\n            }}\n          />\n        </div>\n        <button\n          type=\"button\"\n          className=\"btn btn-primary\"\n          onClick={() => this.props.user.login(this.state.password)}\n        >\n          Submit\n        </button>\n      </div>\n    );\n  }\n}\n\nexport const Login = withUser(LoginWithContext);\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport \"./index.css\";\nimport App from \"./App\";\nimport { ApplicationProvider } from \"./ApplicationContext\";\nimport { UserProvider, UserContext } from \"./Login/UserContext\";\nimport { Login } from \"./Login/Login\";\nimport { MoviesProvider } from \"./Common/MoviesContext\";\nimport { NotificationProvider } from \"./Notifications/NotificationContext\";\n\nReactDOM.render(\n  <UserProvider>\n    <UserContext.Consumer>\n      {({ token }) =>\n        token ? (\n          <ApplicationProvider token={token}>\n            <MoviesProvider>\n              <NotificationProvider>\n                <App />\n              </NotificationProvider>\n            </MoviesProvider>\n          </ApplicationProvider>\n        ) : (\n          <Login />\n        )\n      }\n    </UserContext.Consumer>\n  </UserProvider>,\n  document.getElementById(\"root\")\n);\n"],"sourceRoot":""}
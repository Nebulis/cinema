{"version":3,"sources":["Common/MovieAPI.js","Common/MovieSeen.js","Login/UserContext.js","Common/TagAPI.js","ApplicationContext.js","Admin/Tag.js","MovieList/MovieCard.jsx","Common/MoviesContext.js","Common/MultiDownshift.jsx","shared.js","Common/MultiDownshiftWithReverse.jsx","Common/AsyncMultiDownshift.jsx","MovieList/MoviesFilter.js","Common/SingleDownshift.jsx","Common/Accordion.jsx","MovieList/MovieForm.jsx","MovieList/List.js","Common/EditableField.js","Notifications/NotificationContext.js","Movie/Movie.util.js","Common/hooks.js","Movie/Season/Episode.js","Movie/Season/Season.js","Common/Loader.js","Movie/Movie.js","Common/Fetch.jsx","Header.js","Statistics/Statistics.js","Admin/tag.utils.js","Admin/TagListElement.js","Admin/TagList.js","Notifications/Notification.js","Notifications/NotificationsList.js","Finder/Finder.jsx","App.js","Login/Login.js","index.js"],"names":["controller","MovieSeen","_ref","seen","onClick","_ref$partial","partial","react_default","a","createElement","className","style","color","cursor","title","headers","user","Accept","Content-Type","Authorization","concat","token","handleResponse","response","ok","json","Error","getMovies","abortable","search","abort","AbortController","fetch","signal","then","updateMovie","movie","_id","method","body","JSON","stringify","addSeason","updateSeason","season","addEpisode","updateEpisode","episode","UserContext","React","createContext","withUser","Component","props","Consumer","Object","assign","LOGOUT","Symbol","LOGIN","LOGIN_FAILED","UserProvider","_React$Component","_getPrototypeOf2","_this","classCallCheck","this","_len","arguments","length","args","Array","_key","possibleConstructorReturn","getPrototypeOf","call","apply","state","status","login","bind","assertThisInitialized","inherits","createClass","key","value","_this2","localStorage","getItem","exp","Date","setState","password","_this3","_ref2","setItem","catch","Provider","children","ApplicationContext","LOADING","LOADED","ApplicationProvider","set","field","fn","objectSpread","defineProperty","genres","types","tags","years","options","Promise","all","slicedToArray","reverse","Tag","hex","label","big","_ref$className","_ref$style","_ref$onClick","backgroundColor","indexOf","slice","parseInt","MovieCard","onEdit","onChange","onDelete","useContext","update","subtitle","productionYear","genre","join","Link","to","position","top","right","type","finished","MovieSeen_MovieSeen","every","seasons","map","episodes","some","window","confirm","deleteMovie","src","fileUrl","replace","alt","movieTag","Tag_Tag","find","tag","toLowerCase","open","MoviesContext","SORTS","id","initialState","movies","count","filters","limit","sort","reducer","undefined","payload","console","log","toConsumableArray","index","findIndex","filter","Boolean","produce","transform","name","MoviesProvider","_useReducer","useReducer","_useReducer2","dispatch","MultiDownshift","selectedItems","stateReducer","changes","Downshift","stateChangeTypes","keyDownEnter","clickItem","highlightedIndex","isOpen","callOnChange","downshift","getStateAndHelpers","handleSelection","selectedItem","includes","removeItem","addSelectedItem","item","cb","i","getRemoveButtonProps","objectWithoutProperties","e","stopPropagation","prevProps","_ref3","_this$props","render","_this$props$children","downshift_esm","Item","styled_base_browser_esm","target","isActive","isSelected","styles","push","background","fontWeight","BaseMenu","border","Menu","forwardRef","ref","ControllerButton","ArrowIcon","viewBox","preserveAspectRatio","width","fill","stroke","strokeWidth","d","MultiDownshiftWithReverse","clickOnItem","newSelectedItems","displayItem","displayBackground","itemToFind","_ref4","BaseMultiDownshift","BaseComponent","_Component","_class","handleChange","placeholder","items","core_browser_esm","getToggleButtonProps","getMenuProps","getItemProps","toggleMenu","_ref$clickOnItem","_ref$displayItem","identity","_ref$displayBackgroun","_ref$isSelected","margin","css","AsyncMultiDownshift_ref2","AsyncMultiDownshift_ref3","css_browser_esm","paddingLeft","paddingRight","display","wordWrap","borderRadius","event","preventDefault","AsyncMultiDownshift_ref4","AsyncMultiDownshift_ref5","AsyncMultiDownshift_ref6","AsyncMultiDownshift","AsyncMultiDownshiftwithReverse","fromEvent","forInput","from","FilterTag","selected","onAdd","MoviesFilter","_useContext","_useContext2","year","minWidth","icon","renderSeen","renderFinished","MoviesFilter_FilterTag","filterTag","t","SingleDownshift","getInputProps","getLabelProps","inputValue","SingleDownshift_ref2","SingleDownshift_ref3","SingleDownshift_ref4","SingleDownshift_ref5","SingleDownshift_ref6","Accordion","toggle","react","defaultState","summary","allocine","tvshows","MovieFormWithContext","valid","isEmpty","add","data","$","modal","onUpdate","synchronizeMovieAllocine","idAllocine","m","release","releaseDate","getFullYear","synopsisShort","synopsis","poster","href","synchronizeTvShowAllocine","tvseries","yearStart","onInput","onSelect","on","onClose","application","tabIndex","role","data-show","data-dismiss","aria-label","aria-hidden","htmlFor","aria-describedby","paddingTop","Accordion_Accordion","_ref5","overflowX","flexWrap","code","_ref6","tvshow","SingleDownshift_SingleDownshift","disabled","MovieForm","MovieAPI","List","_useState","useState","Math","ceil","computeOffset","_useState2","offset","setOffset","_useState3","_useState4","setMovie","_useState5","_useState6","setKey","_useState7","_useState8","loaded","setLoaded","loadMore","_","notGenres","keys","isArray","buildQuery","useEffect","debouncedLoadMore","debounce","leading","trailing","cancel","isFirstRun","useRef","current","left","MoviesFilter_MoviesFilter","MovieCard_MovieCard","disableBubbleClick","disableDragAndDrop","draggable","onDragStart","EditableField","setValue","edit","setEdit","lock","lastInitialValue","renderFormField","submit","renderValue","EditableInput","EditableField_EditableField","fieldProps","onKeyDown","valueProps","EditableTextarea","rows","ctrlKey","split","EditableMultiSelect","NotificationContext","action","getTime","notification","NotificationProvider","notifications","seasonTag","seasonIndex","toString","padStart","episodeTag","episodeIndex","handleError","error","createNotification","message","content","useToggle","initialValue","useInput","Episode","onDragOver","onDragEnd","dragging","onSeen","MovieContext","SeasonContext","moviesDispatch","_useToggle","_useToggle2","ellipsis","toggleEllipsis","setStyle","transformEpisode","transformedEpisode","draft","opacity","dataTransfer","dropEffect","EditableField_EditableInput","EditableField_EditableTextarea","Season","onProductionYearUpdate","setEpisodes","setOpacity","drag","setDrag","transformSeason","addEpisodes","asyncToGenerator","regenerator_default","mark","_callee","times","_loop","wrap","_context2","prev","next","newEpisode","_context","sent","stop","delegateYield","oneSeen","_callee2","promises","_context3","_x","s","Episode_Episode","tmp","_callee3","_context4","_x2","Loader","MovieTag","Movie","withRouter","match","history","setSeasons","loadImage","setLoadImage","fileRef","params","transformMovie","handleFiles","files","file","FormData","append","addSeasons","newSeason","goBack","flex","flexDirection","accept","click","Loader_Loader","height","Movie_MovieTag","flexGrow","EditableField_EditableMultiSelect","Season_Season_Season","_loop2","Fetch","FetchWithContext","debounceFetch","endpoint","onSuccess","Header","padding","unseen","Statistics","stats","setStats","forEach","g","fetchByTypes","fetchByTags","orderBy","toFixed","random","max","floor","generateColor","TagListElement","toggleEdit","_useInput","_useInput2","setColor","_useInput3","overflow","updateTag","marginLeft","deleteTag","TagList","setTags","_useInput4","setLabel","TagListElement_TagListElement","createTag","Notification","animateProgress","setAnimateProgress","notificationOut","setNotificationOut","onAnimationEnd","animationName","NotificationsList","Notification_Notification","months","movieReducer","page","cinema","Finder","setYear","String","getMonth","month","setMonth","movieState","movieDispatch","movieToAdd","setMovieToAdd","fetchMovies","Fragment","range","App","BrowserRouter","Header_Header","NotificationsList_NotificationsList","Route","exact","path","component","Login","ReactDOM","UserContext_UserProvider","ApplicationContext_ApplicationProvider","MoviesContext_MoviesProvider","NotificationContext_NotificationProvider","src_App_0","document","getElementById"],"mappings":"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","file":"static/js/main.be6be37f.chunk.js","sourcesContent":["const headers = user => ({\n  Accept: \"application/json\",\n  \"Content-Type\": \"application/json\",\n  Authorization: `Bearer ${user.token}`\n});\n\nconst handleResponse = response => {\n  if (response.ok) return response.json();\n  throw new Error(\"Fetch fail\");\n};\n\nexport const getMovie = (id, user) => {\n  return fetch(`/api/movies/${id}`, {\n    headers: headers(user)\n  }).then(handleResponse);\n};\n\nlet controller;\nexport const getMovies = abortable => (search, user) => {\n  if (abortable && controller) {\n    controller.abort();\n  }\n  controller = new AbortController();\n  return fetch(`/api/movies?${search}`, {\n    headers: headers(user),\n    signal: controller.signal\n  })\n    .then(handleResponse)\n    .then(response => {\n      controller = null;\n      return response;\n    });\n};\n\nexport const updateMovie = (movie, user) => {\n  return fetch(`/api/movies/${movie._id}`, {\n    method: \"PUT\",\n    body: JSON.stringify(movie),\n    headers: headers(user)\n  }).then(handleResponse);\n};\n\nexport const updateMoviePoster = (movie, file, user) => {\n  const data = new FormData();\n  data.append(\"file\", file);\n  return fetch(`/api/movies/${movie._id}/poster`, {\n    method: \"POST\",\n    body: data,\n    headers: {\n      Accept: \"application/json\",\n      Authorization: `Bearer ${user.token}`\n    }\n  }).then(handleResponse);\n};\n\nexport const deleteMovie = (movie, user) => {\n  return fetch(`/api/movies/${movie._id}`, {\n    method: \"DELETE\",\n    headers: headers(user)\n  }).then(handleResponse);\n};\n\nexport const addSeason = (movie, user) => {\n  return fetch(`/api/movies/${movie._id}/seasons`, {\n    method: \"POST\",\n    body: JSON.stringify(movie),\n    headers: headers(user)\n  }).then(handleResponse);\n};\n\nexport const updateSeason = (movie, season, user) => {\n  return fetch(`/api/movies/${movie._id}/seasons/${season._id}`, {\n    method: \"PUT\",\n    body: JSON.stringify(season),\n    headers: headers(user)\n  }).then(handleResponse);\n};\n\nexport const deleteSeason = (movie, season, user) => {\n  return fetch(`/api/movies/${movie._id}/seasons/${season._id}`, {\n    method: \"DELETE\",\n    headers: headers(user)\n  }).then(response => {\n    if (!response.ok) throw new Error(\"Fetch fail\");\n  });\n};\n\nexport const addEpisode = (movie, season, user) => {\n  return fetch(`/api/movies/${movie._id}/seasons/${season._id}/episodes`, {\n    method: \"POST\",\n    body: JSON.stringify(season),\n    headers: headers(user)\n  }).then(handleResponse);\n};\n\nexport const updateEpisode = (movie, season, episode, user) => {\n  return fetch(`/api/movies/${movie._id}/seasons/${season._id}/episodes/${episode._id}`, {\n    method: \"PUT\",\n    body: JSON.stringify(episode),\n    headers: headers(user)\n  }).then(handleResponse);\n};\n\nexport const deleteEpisode = (movie, season, episode, user) => {\n  return fetch(`/api/movies/${movie._id}/seasons/${season._id}/episodes/${episode._id}`, {\n    method: \"DELETE\",\n    headers: headers(user)\n  }).then(response => {\n    if (!response.ok) throw new Error(\"Fetch fail\");\n  });\n};\n","import React from \"react\";\n\nexport const MovieSeen = ({ seen, onClick, partial = false }) => (\n  <i\n    className=\"fas fa-eye\"\n    style={{\n      color: partial && !seen ? \"var(--warning)\" : seen ? \"var(--success)\" : \"\",\n      cursor: \"pointer\"\n    }}\n    onClick={onClick}\n    title={seen ? \"Mark as not seen\" : \"Mark as seen\"}\n  />\n);\n","import React from \"react\";\n\nexport const UserContext = React.createContext();\nexport const withUser = Component => props => (\n  <UserContext.Consumer>{user => <Component {...props} user={user} />}</UserContext.Consumer>\n);\n\nexport const LOGOUT = Symbol();\nexport const LOGIN = Symbol();\nexport const LOGIN_FAILED = Symbol();\n\nconst handleResponse = response => {\n  if (response.ok) return response.json();\n  throw new Error(\"Fetch fail\");\n};\n\nexport class UserProvider extends React.Component {\n  state = {\n    token: null,\n    status: LOGOUT,\n    login: this.login.bind(this)\n  };\n\n  componentDidMount() {\n    const token = localStorage.getItem(\"token\");\n    if (token) {\n      fetch(\"/account\", {\n        method: \"POST\",\n        headers: {\n          Accept: \"application/json\",\n          \"Content-Type\": \"application/json\",\n          Authorization: `Bearer ${token}`\n        }\n      })\n        .then(handleResponse)\n        .then(({ exp }) => {\n          if (new Date() < new Date(exp * 1000)) this.setState({ token, status: LOGIN });\n        });\n    }\n  }\n\n  login(password) {\n    fetch(\"/login\", {\n      method: \"POST\",\n      body: JSON.stringify({ password }),\n      headers: {\n        Accept: \"application/json\",\n        \"Content-Type\": \"application/json\"\n      }\n    })\n      .then(handleResponse)\n      .then(({ token }) => {\n        this.setState({ token, status: LOGIN });\n        localStorage.setItem(\"token\", token);\n      })\n      .catch(() => this.setState({ status: LOGIN_FAILED }));\n  }\n\n  render() {\n    return <UserContext.Provider value={this.state}>{this.props.children}</UserContext.Provider>;\n  }\n}\n","const headers = user => ({\n  Accept: \"application/json\",\n  \"Content-Type\": \"application/json\",\n  Authorization: `Bearer ${user.token}`\n});\n\nconst handleResponse = response => {\n  if (response.ok) return response.json();\n  throw new Error(\"Fetch fail\");\n};\n\nexport const getTags = user => {\n  return fetch(`/api/tags`, {\n    headers: headers(user)\n  }).then(handleResponse);\n};\n\nexport const createTag = (tag, user) => {\n  return fetch(`/api/tags`, {\n    method: \"POST\",\n    body: JSON.stringify(tag),\n    headers: headers(user)\n  }).then(handleResponse);\n};\n\nexport const updateTag = (tag, user) => {\n  return fetch(`/api/tags/${tag._id}`, {\n    method: \"PUT\",\n    body: JSON.stringify(tag),\n    headers: headers(user)\n  }).then(handleResponse);\n};\n\nexport const deleteTag = (tag, user) => {\n  return fetch(`/api/tags/${tag._id}`, {\n    method: \"DELETE\",\n    headers: headers(user)\n  }).then(handleResponse);\n};\n","import React from \"react\";\nimport { getTags } from \"./Common/TagAPI\";\n\nexport const ApplicationContext = React.createContext();\nexport const withApplication = Component => props => (\n  <ApplicationContext.Consumer>\n    {application => <Component {...props} application={application} />}\n  </ApplicationContext.Consumer>\n);\n\nexport const LOADING = Symbol();\nexport const LOADED = Symbol();\n\nexport class ApplicationProvider extends React.Component {\n  set = field => fn => {\n    this.setState(state => ({ ...state, [field]: fn(state[field]) }));\n  };\n\n  componentDidMount() {\n    const options = {\n      headers: {\n        Authorization: `Bearer ${this.props.token}`\n      }\n    };\n\n    const handleResponse = response => {\n      if (response.ok) return response.json();\n      throw new Error(\"Fetch fail\");\n    };\n    Promise.all([\n      fetch(\"/api/movies/genre\", options).then(handleResponse),\n      fetch(\"/api/movies/type\", options).then(handleResponse),\n      getTags(this.props),\n      fetch(\"/api/movies/years\", options).then(handleResponse)\n    ]).then(([genres, types, tags, years]) => {\n      this.setState({\n        genres,\n        types,\n        tags,\n        years: years.reverse(),\n        status: LOADED\n      });\n    });\n  }\n  state = {\n    genres: [],\n    types: [],\n    tags: [],\n    years: [],\n    status: LOADING,\n    set: this.set\n  };\n\n  render() {\n    return <ApplicationContext.Provider value={this.state}>{this.props.children}</ApplicationContext.Provider>;\n  }\n}\n","import React from \"react\";\nimport \"./Tag.css\";\n\nconst invertColor = hex => {\n  if (hex.indexOf(\"#\") === 0) {\n    hex = hex.slice(1);\n  }\n\n  const red = parseInt(hex.slice(0, 2), 16),\n    green = parseInt(hex.slice(2, 4), 16),\n    blue = parseInt(hex.slice(4, 6), 16);\n  return red * 0.299 + green * 0.587 + blue * 0.114 > 186 ? \"#000000\" : \"#FFFFFF\";\n};\n\nexport const Tag = ({ color, label, big, className = \"\", style = {}, onClick = () => void 0 }) => (\n  <span\n    className={`tag ${big ? \"big\" : \"\"} ${className}`}\n    style={{\n      backgroundColor: color,\n      color: `${invertColor(color)}`,\n      ...style\n    }}\n    onClick={onClick}\n  >\n    {label}\n  </span>\n);\n","import React, { useContext } from \"react\";\nimport \"./MovieList.css\";\nimport { Link } from \"react-router-dom\";\nimport { MovieSeen } from \"../Common/MovieSeen\";\nimport { deleteMovie, updateMovie } from \"../Common/MovieAPI\";\nimport every from \"lodash/every\";\nimport some from \"lodash/some\";\nimport { UserContext } from \"../Login/UserContext\";\nimport { ApplicationContext } from \"../ApplicationContext\";\nimport { Tag } from \"../Admin/Tag\";\n\nexport const MovieCard = ({ movie, onEdit, onChange, onDelete }) => {\n  const user = useContext(UserContext);\n  const { tags } = useContext(ApplicationContext);\n  const update = (field, value) => () => updateMovie({ ...movie, [field]: value }, user).then(onChange);\n\n  const title = `${movie.title}`;\n  const subtitle = `${movie.productionYear} - ${movie.genre.join(\",\")}`;\n\n  return (\n    <div className=\"card movie-card\">\n      <div className=\"card-body\">\n        <h5 className=\"card-title\">\n          <Link to={`movie/${movie._id}`}>\n            <div className=\"ellipsis\" title={title}>\n              {title}\n            </div>\n          </Link>\n        </h5>\n        <h6 className=\"card-subtitle mb-2 text-muted ellipsis\" title={subtitle}>\n          {subtitle}\n        </h6>\n        <div className=\"movie-card-actions\" style={{ position: \"absolute\", top: 2, right: 4 }}>\n          {movie.type !== \"Film\" && (\n            <i\n              className=\"fas fa-ban\"\n              style={{\n                cursor: \"pointer\",\n                color: movie.finished ? \"var(--danger)\" : \"black\"\n              }}\n              onClick={update(\"finished\", !movie.finished)}\n              title={movie.finished ? \"Mark tv show as in progress\" : \"Mark tv show as finished\"}\n            />\n          )}\n          {movie.type === \"Film\" ? (\n            <MovieSeen seen={movie.seen} onClick={update(\"seen\", !movie.seen)} />\n          ) : (\n            <MovieSeen\n              seen={\n                every(movie.seasons.map(season => every(season.episodes, \"seen\") && season.episodes.length > 0)) &&\n                movie.seasons.length > 0\n              }\n              partial={\n                some(movie.seasons.map(season => some(season.episodes, \"seen\") && season.episodes.length > 0)) &&\n                movie.seasons.length > 0\n              }\n            />\n          )}\n          <i title=\"Edit\" className=\"fas fa-pencil-alt\" onClick={onEdit} style={{ cursor: \"pointer\" }} />\n          <i\n            className=\"fas fa-trash\"\n            onClick={() => {\n              if (window.confirm()) {\n                deleteMovie(movie, user).then(onDelete);\n              }\n            }}\n            style={{ cursor: \"pointer\" }}\n            title=\"Delete\"\n          />\n        </div>\n        <div className=\"poster text-center\">\n          <img src={movie.fileUrl ? movie.fileUrl.replace(\"http:\", \"https:\") : \"/no-image.png\"} alt=\"movie poster\" />\n        </div>\n        <div className=\"mt-2 text-center\">\n          {movie.tags.map(movieTag => (\n            <Tag\n              key={movieTag}\n              {...tags.find(tag => tag._id === movieTag)}\n              className=\"mr-2\"\n              onClick={() => {\n                const tag = tags.find(tag => tag._id === movieTag);\n                if (tag && tag.label.toLowerCase() === \"netflix\") {\n                  window.open(`https://www.netflix.com/search?q=${movie.title}`, \"_blank\");\n                }\n              }}\n            />\n          ))}\n        </div>\n      </div>\n    </div>\n  );\n};\n","import React, { useReducer } from \"react\";\nimport findIndex from \"lodash/findIndex\";\nimport { produce } from \"immer\";\n\nexport const MoviesContext = React.createContext();\nexport const SORTS = [\n  {\n    id: \"1\",\n    label: \"Titre ascendant\",\n    field: \"title\",\n    value: \"1\"\n  },\n  {\n    id: \"2\",\n    label: \"Titre descendant\",\n    field: \"title\",\n    value: \"-1\"\n  },\n  {\n    id: \"3\",\n    label: \"Date de sortie ascendant\",\n    field: \"productionYear\",\n    value: \"1\"\n  },\n  {\n    id: \"4\",\n    label: \"Date de sortie descendant\",\n    field: \"productionYear\",\n    value: \"-1\"\n  }\n];\n\nconst initialState = {\n  movies: [],\n  count: 0,\n  filters: {\n    productionYear: \"-1\",\n    title: \"\",\n    genres: [],\n    types: [],\n    tags: [],\n    seen: null, // null = dont care, true = have seen, false = have not seen\n    finished: null, // null = dont care, true = finished\n    limit: 30,\n    sort: SORTS[0]\n  }\n};\n\nconst reducer = (state = initialState, { type, payload }) => {\n  console.log(state, type, payload);\n  switch (type) {\n    case \"ADD\":\n      return { ...state, movies: [payload.movie, ...state.movies], count: state.count + 1 };\n    case \"UPDATE\": {\n      const index = findIndex(state.movies, [\"_id\", payload.id]);\n      const movies = [...state.movies];\n      const count = payload.movie ? state.count : state.count - 1; // delete movie ? decrease counter\n      movies[index] = payload.movie;\n      // pass undefined as delete and then use filter te remove the element\n      return { ...state, movies: movies.filter(Boolean), count };\n    }\n    // next step => create real action ADD / DELETE / SEASONS / EPISODES\n    case \"UPDATE_WITH_TRANSFORM\": {\n      const index = findIndex(state.movies, [\"_id\", payload.id]);\n      const movies = [...state.movies];\n      movies[index] = produce(movies[index], payload.transform);\n      // pass undefined as delete and then use filter te remove the element\n      return { ...state, movies: movies.filter(Boolean) };\n    }\n    case \"ADD_ALL\":\n      return { ...state, movies: [...state.movies, ...payload.movies], count: payload.count };\n    case \"SET_MOVIES\":\n      return { ...state, movies: payload.movies || [], count: payload.count || 0 };\n    case \"RESET_FILTERS\":\n      return { ...state, filters: { ...initialState.filters } };\n    case \"FILTERS_CHANGED\":\n      return {\n        ...state,\n        movies: [],\n        count: 0,\n        filters: { ...state.filters, [payload.name]: payload.value }\n      };\n    default:\n      return state;\n  }\n};\n\nexport const MoviesProvider = props => {\n  const [state, dispatch] = useReducer(reducer, initialState);\n  return <MoviesContext.Provider value={{ state, dispatch }}>{props.children}</MoviesContext.Provider>;\n};\n","import React from \"react\";\nimport Downshift from \"downshift\";\n\nexport class MultiDownshift extends React.Component {\n  state = { selectedItems: this.props.selectedItems || [] };\n\n  componentDidUpdate(prevProps) {\n    if (prevProps.selectedItems !== this.props.selectedItems && this.props.selectedItems !== this.state.selectedItems) {\n      this.setState({ selectedItems: this.props.selectedItems || [] });\n    }\n  }\n  stateReducer = (state, changes) => {\n    switch (changes.type) {\n      case Downshift.stateChangeTypes.keyDownEnter:\n      case Downshift.stateChangeTypes.clickItem:\n        return {\n          ...changes,\n          highlightedIndex: state.highlightedIndex,\n          isOpen: true\n        };\n      default:\n        return changes;\n    }\n  };\n\n  callOnChange = downshift => () => {\n    if (this.props.onChange) {\n      this.props.onChange(this.state.selectedItems, this.getStateAndHelpers(downshift));\n    }\n  };\n\n  handleSelection = (selectedItem, downshift) => {\n    if (this.state.selectedItems.includes(selectedItem)) {\n      this.removeItem(selectedItem, this.callOnChange(downshift));\n    } else {\n      this.addSelectedItem(selectedItem, this.callOnChange(downshift));\n    }\n  };\n\n  removeItem = (item, cb) => {\n    this.setState(({ selectedItems }) => {\n      return {\n        selectedItems: selectedItems.filter(i => i !== item)\n      };\n    }, cb);\n  };\n  addSelectedItem(item, cb) {\n    this.setState(\n      ({ selectedItems }) => ({\n        selectedItems: [...selectedItems, item]\n      }),\n      cb\n    );\n  }\n\n  getRemoveButtonProps = downshift => ({ onClick, item, ...props } = {}) => {\n    return {\n      onClick: e => {\n        // TODO: use something like downshift's composeEventHandlers utility instead\n        onClick && onClick(e);\n        e.stopPropagation();\n        this.removeItem(item, this.callOnChange(downshift));\n      },\n      ...props\n    };\n  };\n\n  getStateAndHelpers(downshift) {\n    const { selectedItems } = this.state;\n    const { getRemoveButtonProps, removeItem } = this;\n    return {\n      getRemoveButtonProps: getRemoveButtonProps(downshift),\n      removeItem,\n      selectedItems,\n      ...downshift\n    };\n  }\n  render() {\n    const { render, children = render, ...props } = this.props;\n    // TODO: compose together props (rather than overwriting them) like downshift does\n    return (\n      <Downshift {...props} stateReducer={this.stateReducer} onChange={this.handleSelection} selectedItem={null}>\n        {downshift => children(this.getStateAndHelpers(downshift))}\n      </Downshift>\n    );\n  }\n}\n","import React from \"react\";\nimport styled from \"@emotion/styled\";\n\nconst Item = styled.li(\n  {\n    position: \"relative\",\n    cursor: \"pointer\",\n    display: \"block\",\n    border: \"none\",\n    height: \"auto\",\n    textAlign: \"left\",\n    borderTop: \"none\",\n    lineHeight: \"1em\",\n    color: \"rgba(0,0,0,.87)\",\n    fontSize: \"1rem\",\n    textTransform: \"none\",\n    fontWeight: \"400\",\n    boxShadow: \"none\",\n    padding: \".8rem 1.1rem\",\n    whiteSpace: \"normal\",\n    wordWrap: \"normal\"\n  },\n  ({ isActive, isSelected }) => {\n    const styles = [];\n    if (isActive) {\n      styles.push({\n        color: \"rgba(0,0,0,.95)\",\n        background: \"rgba(0,0,0,.03)\"\n      });\n    }\n    if (isSelected) {\n      styles.push({\n        color: \"rgba(0,0,0,.95)\",\n        fontWeight: \"700\"\n      });\n    }\n    return styles;\n  }\n);\n\nconst BaseMenu = styled.ul(\n  {\n    padding: 0,\n    marginTop: 0,\n    position: \"absolute\",\n    backgroundColor: \"white\",\n    width: \"100%\",\n    maxHeight: \"20rem\",\n    overflowY: \"auto\",\n    overflowX: \"hidden\",\n    outline: \"0\",\n    transition: \"opacity .1s ease\",\n    borderRadius: \"0 0 .28571429rem .28571429rem\",\n    boxShadow: \"0 2px 3px 0 rgba(34,36,38,.15)\",\n    borderColor: \"#96c8da\",\n    borderTopWidth: \"0\",\n    borderRightWidth: 1,\n    borderBottomWidth: 1,\n    borderLeftWidth: 1,\n    borderStyle: \"solid\",\n    zIndex: 10\n  },\n  ({ isOpen }) => ({\n    border: isOpen ? null : \"none\"\n  })\n);\n\nconst Menu = React.forwardRef((props, ref) => <BaseMenu ref={ref} {...props} />);\n\nconst ControllerButton = styled.button({\n  backgroundColor: \"transparent\",\n  border: \"none\",\n  position: \"absolute\",\n  right: 0,\n  top: 0,\n  cursor: \"pointer\",\n  width: 47,\n  display: \"flex\",\n  flexDirection: \"column\",\n  height: \"100%\",\n  justifyContent: \"center\",\n  alignItems: \"center\"\n});\n\nfunction ArrowIcon({ isOpen }) {\n  return (\n    <svg\n      viewBox=\"0 0 20 20\"\n      preserveAspectRatio=\"none\"\n      width={16}\n      fill=\"transparent\"\n      stroke=\"#979797\"\n      strokeWidth=\"1.1px\"\n      transform={isOpen ? \"rotate(180)\" : null}\n    >\n      <path d=\"M1,6 L10,15 L19,6\" />\n    </svg>\n  );\n}\nexport { Menu, ControllerButton, Item, ArrowIcon };\n","import React from \"react\";\nimport Downshift from \"downshift\";\n\nexport class MultiDownshiftWithReverse extends React.Component {\n  state = { selectedItems: this.props.selectedItems || [] };\n  stateReducer = (state, changes) => {\n    switch (changes.type) {\n      case Downshift.stateChangeTypes.keyDownEnter:\n      case Downshift.stateChangeTypes.clickItem:\n        return {\n          ...changes,\n          highlightedIndex: state.highlightedIndex,\n          isOpen: true\n        };\n      default:\n        return changes;\n    }\n  };\n\n  callOnChange = downshift => () => {\n    if (this.props.onChange) {\n      this.props.onChange(this.state.selectedItems, this.getStateAndHelpers(downshift));\n    }\n  };\n\n  handleSelection = (selectedItem, downshift) => {\n    if (this.state.selectedItems.filter(item => selectedItem === item[0]).length > 0) {\n      this.removeItem([selectedItem], this.callOnChange(downshift));\n    } else {\n      this.addSelectedItem(selectedItem, this.callOnChange(downshift));\n    }\n  };\n\n  removeItem = (item, cb) => {\n    this.setState(({ selectedItems }) => {\n      return {\n        selectedItems: selectedItems.filter(i => i[0] !== item[0])\n      };\n    }, cb);\n  };\n  addSelectedItem(item, cb) {\n    this.setState(\n      ({ selectedItems }) => ({\n        selectedItems: [...selectedItems, [item, true]]\n      }),\n      cb\n    );\n  }\n\n  getRemoveButtonProps = downshift => ({ onClick, item, ...props } = {}) => {\n    return {\n      onClick: e => {\n        // TODO: use something like downshift's composeEventHandlers utility instead\n        onClick && onClick(e);\n        e.stopPropagation();\n        this.removeItem(item, this.callOnChange(downshift));\n      },\n      ...props\n    };\n  };\n\n  clickOnItem = downshift => (item, index) => {\n    this.setState(({ selectedItems }) => {\n      const newSelectedItems = selectedItems;\n      newSelectedItems[index] = [item[0], !item[1]];\n      return {\n        selectedItems: newSelectedItems.filter(i => i !== item[0])\n      };\n    }, this.callOnChange(downshift));\n  };\n  displayItem = item => {\n    return item[0];\n  };\n  displayBackground = item => {\n    return item[1] ? \"#ccc\" : \"tomato\";\n  };\n  isSelected = itemToFind => {\n    return this.state.selectedItems.find(item => item[0] === itemToFind);\n  };\n\n  getStateAndHelpers(downshift) {\n    const { selectedItems } = this.state;\n    const { getRemoveButtonProps, removeItem, clickOnItem, displayItem, displayBackground, isSelected } = this;\n    return {\n      getRemoveButtonProps: getRemoveButtonProps(downshift),\n      removeItem,\n      selectedItems,\n      clickOnItem: clickOnItem(downshift),\n      displayItem,\n      displayBackground,\n      isSelected,\n      ...downshift\n    };\n  }\n  render() {\n    const { render, children = render, ...props } = this.props;\n    // TODO: compose together props (rather than overwriting them) like downshift does\n    return (\n      <Downshift {...props} stateReducer={this.stateReducer} onChange={this.handleSelection} selectedItem={null}>\n        {downshift => children(this.getStateAndHelpers(downshift))}\n      </Downshift>\n    );\n  }\n}\n","import { MultiDownshift } from \"./MultiDownshift\";\nimport { ArrowIcon, ControllerButton, Item, Menu } from \"../shared\";\nimport { Component } from \"react\";\nimport identity from \"lodash/identity\";\nimport { MultiDownshiftWithReverse } from \"./MultiDownshiftWithReverse\";\n/** @jsx jsx */\nimport { jsx } from \"@emotion/core\";\n\nconst BaseMultiDownshift = BaseComponent =>\n  class extends Component {\n    render() {\n      const { handleChange, placeholder, items, selectedItems } = this.props;\n      return (\n        <BaseComponent onChange={handleChange} selectedItems={selectedItems} placeholder={placeholder}>\n          {({\n            getToggleButtonProps,\n            getMenuProps,\n            getRemoveButtonProps,\n            removeItem,\n            isOpen,\n            selectedItems,\n            getItemProps,\n            highlightedIndex,\n            toggleMenu,\n            clickOnItem = () => void 0,\n            displayItem = identity,\n            displayBackground = () => \"#ccc\",\n            isSelected = item => selectedItems.includes(item)\n          }) => (\n            <div\n              style={{\n                margin: \"auto\",\n                position: \"relative\",\n                width: \"100%\"\n              }}\n            >\n              <div\n                css={{\n                  cursor: \"pointer\",\n                  position: \"relative\",\n                  padding: \".375rem .75rem\",\n                  paddingRight: 50,\n                  border: \"1px solid #ced4da\",\n                  borderRadius: \".25rem\",\n                  backgroundColor: \"white\"\n                }}\n                onClick={() => {\n                  toggleMenu();\n                }}\n              >\n                <div\n                  css={{\n                    display: \"flex\",\n                    flexWrap: \"wrap\",\n                    alignItems: \"center\"\n                  }}\n                >\n                  {selectedItems.length > 0 ? (\n                    selectedItems.map((item, index) => (\n                      <div\n                        key={index}\n                        css={{\n                          margin: \"0 2px\",\n                          paddingLeft: 8,\n                          paddingRight: 8,\n                          display: \"inline-block\",\n                          wordWrap: \"none\",\n                          backgroundColor: displayBackground(item),\n                          borderRadius: 2\n                        }}\n                        onClick={event => {\n                          event.preventDefault();\n                          event.stopPropagation();\n                          clickOnItem(item, index);\n                        }}\n                      >\n                        <div\n                          css={{\n                            display: \"grid\",\n                            gridGap: 6,\n                            gridAutoFlow: \"column\",\n                            alignItems: \"center\"\n                          }}\n                        >\n                          <span>{displayItem(item)}</span>\n                          <button\n                            {...getRemoveButtonProps({ item })}\n                            css={{\n                              cursor: \"pointer\",\n                              lineHeight: 0.8,\n                              border: \"none\",\n                              backgroundColor: \"transparent\",\n                              padding: \"0\",\n                              fontSize: \"16px\"\n                            }}\n                            type=\"button\"\n                          >\n                            𝘅\n                          </button>\n                        </div>\n                      </div>\n                    ))\n                  ) : (\n                    <span\n                      css={{\n                        color: \"#6c757d\"\n                      }}\n                    >\n                      {placeholder}\n                    </span>\n                  )}\n                </div>\n                <ControllerButton\n                  {...getToggleButtonProps({\n                    // prevents the menu from immediately toggling\n                    // closed (due to our custom click handler above).\n                    onClick(event) {\n                      event.stopPropagation();\n                    }\n                  })}\n                >\n                  <ArrowIcon isOpen={isOpen} />\n                </ControllerButton>\n              </div>\n              <Menu {...getMenuProps({ isOpen })}>\n                {isOpen\n                  ? items.map((item, index) => (\n                      <Item\n                        key={index}\n                        {...getItemProps({\n                          item,\n                          index,\n                          isActive: highlightedIndex === index,\n                          isSelected: isSelected(item)\n                        })}\n                      >\n                        {item}\n                      </Item>\n                    ))\n                  : null}\n              </Menu>\n            </div>\n          )}\n        </BaseComponent>\n      );\n    }\n  };\n\nexport const AsyncMultiDownshift = BaseMultiDownshift(MultiDownshift);\nexport const AsyncMultiDownshiftwithReverse = BaseMultiDownshift(MultiDownshiftWithReverse);\n","import React, { useContext } from \"react\";\nimport identity from \"lodash/identity\";\nimport { MoviesContext, SORTS } from \"../Common/MoviesContext\";\nimport { AsyncMultiDownshift, AsyncMultiDownshiftwithReverse } from \"../Common/AsyncMultiDownshift\";\nimport { ApplicationContext } from \"../ApplicationContext\";\nimport { Tag } from \"../Admin/Tag\";\n\nconst fromEvent = event => event.target.value;\n\nconst forInput = ({ filters, onChange }, name, transform = identity, from = fromEvent) => {\n  return {\n    value: filters[name],\n    onChange: value => onChange(name)(transform(from(value)))\n  };\n};\n\nconst FilterTag = ({ tag, selected, onAdd, onDelete }) => (\n  <span onClick={selected ? onDelete : onAdd}>\n    <Tag {...tag} className={`filter-tag mr-2 ${selected ? \"selected\" : \"\"}`} />\n  </span>\n);\n\nexport const MoviesFilter = () => {\n  const {\n    state: { filters },\n    dispatch\n  } = useContext(MoviesContext);\n  const { genres, types, tags, years } = useContext(ApplicationContext);\n  const { seen, finished } = filters;\n\n  const onChange = name => value => {\n    dispatch({ type: \"FILTERS_CHANGED\", payload: { name, value } });\n  };\n\n  const renderSeen = () => {\n    let color = \"\",\n      icon = \"fa-eye\",\n      onClick = () => onChange(\"seen\")(\"true\");\n    if (seen === \"true\") {\n      color = \"var(--success)\";\n      onClick = () => onChange(\"seen\")(\"partial\");\n    } else if (seen === \"partial\") {\n      color = \"var(--warning)\";\n      onClick = () => onChange(\"seen\")(\"false\");\n    } else if (seen === \"false\") {\n      color = \"var(--danger)\";\n      icon = \"fa-eye-slash\";\n      onClick = () => onChange(\"seen\")(null);\n    }\n    return (\n      <i\n        className={`fas ${icon}`}\n        style={{\n          color,\n          cursor: \"pointer\"\n        }}\n        onClick={onClick}\n      />\n    );\n  };\n\n  const renderFinished = () => {\n    let color = \"\",\n      onClick = () => onChange(\"finished\")(true);\n    if (finished === true) {\n      color = \"var(--danger)\";\n      onClick = () => onChange(\"finished\")(null);\n    }\n    return (\n      <i\n        className={`fas fa-ban`}\n        style={{\n          color,\n          cursor: \"pointer\"\n        }}\n        onClick={onClick}\n      />\n    );\n  };\n\n  return (\n    <form className=\"form-inline movies-filter mt-4 ml-3\">\n      <div className=\"form-group mr-2\">\n        <select className=\"form-control\" {...forInput({ filters, onChange }, \"productionYear\")}>\n          <option value=\"-1\">YYYY</option>\n          {years.map(year => (\n            <option value={year} key={year}>\n              {year}\n            </option>\n          ))}\n        </select>\n      </div>\n      <div className=\"form-group mr-2\">\n        <input type=\"text\" {...forInput({ filters, onChange }, \"title\")} placeholder=\"Title\" className=\"form-control\" />\n      </div>\n      <div className=\"form-group mr-2\" style={{ minWidth: \"220px\" }}>\n        <AsyncMultiDownshiftwithReverse\n          placeholder=\"Genre\"\n          handleChange={forInput({ filters, onChange }, \"genres\", identity, identity).onChange}\n          items={genres}\n          selectedItems={filters.genres}\n        />\n      </div>\n      <div className=\"form-group mr-2\" style={{ width: \"220px\" }}>\n        <AsyncMultiDownshift\n          placeholder=\"Type\"\n          handleChange={forInput({ filters, onChange }, \"types\", identity, identity).onChange}\n          items={types}\n          selectedItems={filters.types}\n        />\n      </div>\n      <div className=\"form-group mr-2\">{renderSeen()}</div>\n      <div className=\"form-group mr-2\">{renderFinished()}</div>\n      <div>\n        {tags.map(tag => (\n          <FilterTag\n            key={tag._id}\n            tag={tag}\n            selected={filters.tags.find(filterTag => filterTag === tag._id)}\n            onAdd={() => onChange(\"tags\")([...filters.tags, tag._id])}\n            onDelete={() => onChange(\"tags\")(filters.tags.filter(t => t !== tag._id))}\n          />\n        ))}\n      </div>\n      <div>\n        <select\n          className=\"form-control\"\n          value={filters.sort.id}\n          onChange={event => onChange(\"sort\")(SORTS.find(sort => sort.id === event.target.value))}\n        >\n          {SORTS.map(sort => (\n            <option value={sort.id} key={sort.id}>\n              {sort.label}\n            </option>\n          ))}\n        </select>\n      </div>\n    </form>\n  );\n};\n","import React from \"react\";\nimport Downshift from \"downshift\";\nimport { ArrowIcon, ControllerButton, Item, Menu } from \"../shared\";\n/** @jsx jsx */\nimport { jsx } from \"@emotion/core\";\n\nexport class SingleDownshift extends React.Component {\n  render() {\n    const { onChange, placeholder, items, selectedItem } = this.props;\n    return (\n      <Downshift onChange={onChange} selectedItem={selectedItem}>\n        {({\n          getToggleButtonProps,\n          getInputProps,\n          getItemProps,\n          getLabelProps,\n          getMenuProps,\n          isOpen,\n          inputValue,\n          highlightedIndex,\n          selectedItem,\n          toggleMenu\n        }) => (\n          <div\n            style={{\n              margin: \"auto\",\n              position: \"relative\",\n              width: \"100%\"\n            }}\n          >\n            <div\n              css={{\n                cursor: \"pointer\",\n                position: \"relative\",\n                padding: \".375rem .75rem\",\n                paddingRight: 50,\n                border: \"1px solid #ced4da\",\n                borderRadius: \".25rem\",\n                backgroundColor: \"white\"\n              }}\n              onClick={() => {\n                toggleMenu();\n              }}\n            >\n              <div\n                css={{\n                  display: \"flex\",\n                  flexWrap: \"wrap\",\n                  alignItems: \"center\"\n                }}\n              >\n                {selectedItem ? (\n                  <div\n                    css={{\n                      margin: \"0 2px\",\n                      paddingLeft: 8,\n                      paddingRight: 8,\n                      display: \"inline-block\",\n                      wordWrap: \"none\",\n                      backgroundColor: \"#ccc\",\n                      borderRadius: 2\n                    }}\n                  >\n                    <div\n                      css={{\n                        display: \"grid\",\n                        gridGap: 6,\n                        gridAutoFlow: \"column\",\n                        alignItems: \"center\"\n                      }}\n                    >\n                      <span>{selectedItem}</span>\n                    </div>\n                  </div>\n                ) : (\n                  <span\n                    css={{\n                      color: \"#6c757d\"\n                    }}\n                  >\n                    {placeholder}\n                  </span>\n                )}\n              </div>\n              <ControllerButton\n                {...getToggleButtonProps({\n                  // prevents the menu from immediately toggling\n                  // closed (due to our custom click handler above).\n                  onClick(event) {\n                    event.stopPropagation();\n                  }\n                })}\n              >\n                <ArrowIcon isOpen={isOpen} />\n              </ControllerButton>\n            </div>\n            <Menu {...getMenuProps({ isOpen })}>\n              {isOpen\n                ? items.map((item, index) => (\n                    <Item\n                      key={index}\n                      {...getItemProps({\n                        item,\n                        index,\n                        isActive: highlightedIndex === index,\n                        isSelected: selectedItem === item\n                      })}\n                    >\n                      {item}\n                    </Item>\n                  ))\n                : null}\n            </Menu>\n          </div>\n        )}\n      </Downshift>\n    );\n  }\n}\n","import React, { Component, Fragment } from \"react\";\n\nexport class Accordion extends Component {\n  state = {\n    open: false,\n    toggle: this.toggle.bind(this)\n  };\n\n  toggle() {\n    this.setState({ open: !this.state.open });\n  }\n\n  render() {\n    return <Fragment>{this.props.children(this.state)}</Fragment>;\n  }\n}\n","import React, { Fragment } from \"react\";\nimport { SingleDownshift } from \"../Common/SingleDownshift\";\nimport { LOADING, withApplication } from \"../ApplicationContext\";\nimport isEmpty from \"lodash/isEmpty\";\nimport { AsyncMultiDownshift } from \"../Common/AsyncMultiDownshift\";\nimport { Accordion } from \"../Common/Accordion\";\nimport { withUser } from \"../Login/UserContext\";\n\nconst defaultState = {\n  movie: {\n    title: \"\",\n    genre: [],\n    type: \"\",\n    productionYear: \"\",\n    summary: \"\"\n  },\n  allocine: {\n    movies: [],\n    tvshows: []\n  }\n};\n\nconst headers = user => ({\n  Accept: \"application/json\",\n  \"Content-Type\": \"application/json\",\n  Authorization: `Bearer ${user.token}`\n});\n\nconst handleResponse = response => {\n  if (response.ok) return response.json();\n  throw new Error(\"Fetch fail\");\n};\n\nclass MovieFormWithContext extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      movie: props.movie ? props.movie : defaultState.movie,\n      allocine: defaultState.allocine\n    };\n  }\n\n  componentDidMount() {\n    // eslint-disable-next-line no-undef\n    $(\"#movie-creator-updator\").on(\"hide.bs.modal\", this.props.onClose);\n  }\n\n  valid = () => {\n    return !isEmpty(this.state.movie.title) && this.state.movie.genre.length > 0 && !isEmpty(this.state.movie.type);\n  };\n\n  add = () => {\n    fetch(\"/api/movies\", {\n      method: \"POST\",\n      body: JSON.stringify(this.state.movie),\n      headers: headers(this.props.user)\n    })\n      .then(handleResponse)\n      .then(data => {\n        this.props.onAdd({ ...this.state.movie, ...data });\n        // eslint-disable-next-line no-undef\n        $(\"#movie-creator-updator\").modal(\"hide\");\n      });\n  };\n\n  update = () => {\n    fetch(`/api/movies/${this.props.movie._id}`, {\n      method: \"PUT\",\n      body: JSON.stringify(this.state.movie),\n      headers: headers(this.props.user)\n    })\n      .then(handleResponse)\n      .then(data => {\n        this.props.onUpdate({ ...this.state.movie, ...data });\n        // eslint-disable-next-line no-undef\n        $(\"#movie-creator-updator\").modal(\"hide\");\n      });\n  };\n\n  search = () => {\n    Promise.all([\n      fetch(`/api/allocine?type=Film&title=${this.state.movie.title}`, {\n        headers: headers(this.props.user)\n      }).then(handleResponse),\n      fetch(`/api/allocine?type=Série&title=${this.state.movie.title}`, {\n        headers: headers(this.props.user)\n      }).then(handleResponse)\n    ]).then(([movies, tvshows]) => this.setState({ allocine: { movies, tvshows } }));\n  };\n\n  synchronizeMovieAllocine = idAllocine => {\n    // if click on the currently selected movie, unselect it\n    if (idAllocine === this.state.movie.idAllocine) {\n      this.setState({\n        movie: {\n          ...this.state.movie,\n          idAllocine: null\n        }\n      });\n    } else {\n      fetch(`/api/allocine/movie/${idAllocine}`, {\n        headers: headers(this.props.user)\n      })\n        .then(handleResponse)\n        .then(({ movie }) =>\n          this.setState({\n            movie: {\n              ...this.state.movie,\n              idAllocine,\n              title: movie.title,\n              genre: movie.genre.map(m => m.$).sort(),\n              type: \"Film\",\n              productionYear:\n                movie.release && movie.release.releaseDate\n                  ? new Date(movie.release.releaseDate).getFullYear()\n                  : movie.productionYear,\n              summary: movie.synopsisShort || movie.synopsis,\n              fileUrl: movie.poster ? movie.poster.href : \"\"\n            }\n          })\n        );\n    }\n  };\n\n  synchronizeTvShowAllocine = idAllocine => {\n    // if click on the currently selected movie, unselect it\n    if (idAllocine === this.state.movie.idAllocine) {\n      this.setState({\n        movie: {\n          ...this.state.movie,\n          idAllocine: null\n        }\n      });\n    } else {\n      fetch(`/api/allocine/serie/${idAllocine}`, {\n        headers: headers(this.props.user)\n      })\n        .then(handleResponse)\n        .then(({ tvseries }) =>\n          this.setState({\n            movie: {\n              ...this.state.movie,\n              idAllocine,\n              title: tvseries.title,\n              genre: tvseries.genre.map(m => m.$).sort(),\n              type: \"Série\",\n              productionYear: tvseries.yearStart,\n              summary: tvseries.synopsisShort || tvseries.synopsis,\n              fileUrl: tvseries.poster ? tvseries.poster.href : \"\"\n            }\n          })\n        );\n    }\n  };\n\n  onInput = (field, transform = data => data) => {\n    return event =>\n      this.setState({\n        movie: { ...this.state.movie, [field]: transform(event.target.value) }\n      });\n  };\n\n  onSelect = field => {\n    return value => this.setState({ movie: { ...this.state.movie, [field]: value } });\n  };\n\n  render() {\n    const { movie } = this.state;\n    return (\n      <Fragment>\n        {this.props.application.status === LOADING ? (\n          <div>Loading...</div>\n        ) : (\n          <div\n            className=\"movie-modal modal fade movie-form\"\n            id=\"movie-creator-updator\"\n            tabIndex=\"-1\"\n            role=\"dialog\"\n            data-show=\"true\"\n          >\n            <div className=\"modal-dialog modal-dialog-centered\" role=\"document\">\n              <div className=\"modal-content\">\n                <div className=\"modal-header\">\n                  <h5 className=\"modal-title\">{(movie && movie.title) || \"New\"}</h5>\n                  <button type=\"button\" className=\"close\" data-dismiss=\"modal\" aria-label=\"Close\">\n                    <span aria-hidden=\"true\">&times;</span>\n                  </button>\n                </div>\n                <div className=\"modal-body\">\n                  <div className=\"form-row\">\n                    <div className=\"form-group col-11\">\n                      <label htmlFor=\"title\">Title</label>\n                      <input\n                        type=\"text\"\n                        className=\"form-control\"\n                        id=\"title\"\n                        aria-describedby=\"title\"\n                        placeholder=\"Enter title\"\n                        onChange={this.onInput(\"title\")}\n                        value={this.state.movie.title}\n                      />\n                    </div>\n                    <div className=\"form-group col-1 text-center\">\n                      <i\n                        title=\"Search in allocine\"\n                        className=\"fab fa-angular fa-2x\"\n                        style={{\n                          cursor: \"pointer\",\n                          color: \"#fecc00\",\n                          paddingTop: \"35px\"\n                        }}\n                        onClick={this.search}\n                      />\n                    </div>\n                  </div>\n                  {this.state.allocine.movies.length > 0 ? (\n                    <Accordion>\n                      {({ open, toggle }) => {\n                        return (\n                          <Fragment>\n                            <div onClick={toggle} style={{ cursor: \"pointer\" }}>\n                              {this.state.allocine.movies.length} movies\n                              {open ? (\n                                <i className=\"fas fa-chevron-up\" title=\"Hide\" />\n                              ) : (\n                                <i className=\"fas fa-chevron-down\" title=\"Show\" />\n                              )}\n                            </div>\n                            <div\n                              className=\"row\"\n                              style={{\n                                overflowX: \"scroll\",\n                                display: open ? \"flex\" : \"none\",\n                                flexWrap: \"nowrap\"\n                              }}\n                            >\n                              {this.state.allocine.movies.map(movie => (\n                                <div\n                                  key={movie.code}\n                                  className={`col-2 allocine-movie ${\n                                    movie.code === this.state.movie.idAllocine ? \"selected\" : \"\"\n                                  }`}\n                                  onClick={() => this.synchronizeMovieAllocine(movie.code)}\n                                >\n                                  {movie.code === this.state.movie.idAllocine ? (\n                                    <i\n                                      className=\"fas fa-check-circle selected-movie-icon fa-2x\"\n                                      title=\"Movie selected\"\n                                    />\n                                  ) : null}\n                                  <div>\n                                    {movie.title} -{\" \"}\n                                    {movie.release && movie.release.releaseDate\n                                      ? new Date(movie.release.releaseDate).getFullYear()\n                                      : movie.productionYear}\n                                  </div>\n                                  <div>\n                                    {movie.poster ? (\n                                      <img src={movie.poster.href} alt=\"movie poster\" style={{ width: \"100%\" }} />\n                                    ) : null}\n                                  </div>\n                                </div>\n                              ))}\n                            </div>\n                          </Fragment>\n                        );\n                      }}\n                    </Accordion>\n                  ) : null}\n                  {this.state.allocine.tvshows.length > 0 ? (\n                    <Accordion>\n                      {({ open, toggle }) => {\n                        return (\n                          <Fragment>\n                            <div onClick={toggle} style={{ cursor: \"pointer\" }}>\n                              {this.state.allocine.tvshows.length} tv shows\n                              {open ? (\n                                <i className=\"fas fa-chevron-up\" title=\"Hide\" />\n                              ) : (\n                                <i className=\"fas fa-chevron-down\" title=\"Show\" />\n                              )}\n                            </div>\n                            <div\n                              className=\"row\"\n                              style={{\n                                overflowX: \"scroll\",\n                                display: open ? \"flex\" : \"none\",\n                                flexWrap: \"nowrap\"\n                              }}\n                            >\n                              {this.state.allocine.tvshows.map(tvshow => (\n                                <div\n                                  key={tvshow.code}\n                                  className={`col-2 allocine-movie ${\n                                    tvshow.code === this.state.movie.idAllocine ? \"selected\" : \"\"\n                                  }`}\n                                  onClick={() => this.synchronizeTvShowAllocine(tvshow.code)}\n                                >\n                                  {tvshow.code === this.state.movie.idAllocine ? (\n                                    <i\n                                      className=\"fas fa-check-circle selected-movie-icon fa-2x\"\n                                      title=\"Tv show selected\"\n                                    />\n                                  ) : null}\n                                  <div>\n                                    {tvshow.title} - {tvshow.yearStart}\n                                  </div>\n                                  <div>\n                                    {tvshow.poster ? (\n                                      <img src={tvshow.poster.href} alt=\"tvshow poster\" style={{ width: \"100%\" }} />\n                                    ) : null}\n                                  </div>\n                                </div>\n                              ))}\n                            </div>\n                          </Fragment>\n                        );\n                      }}\n                    </Accordion>\n                  ) : null}\n                  <div className=\"form-group\">\n                    <label>Genre</label>\n                    <AsyncMultiDownshift\n                      selectedItems={this.state.movie.genre}\n                      placeholder=\"Genre\"\n                      items={this.props.application.genres}\n                      handleChange={this.onSelect(\"genre\")}\n                    />\n                  </div>\n                  <div className=\"form-group\">\n                    <label>Type</label>\n                    <SingleDownshift\n                      selectedItem={this.state.movie.type}\n                      placeholder=\"Type\"\n                      items={this.props.application.types}\n                      onChange={this.onSelect(\"type\")}\n                    />\n                  </div>\n                  <div className=\"form-group\">\n                    <label htmlFor=\"production-year\">Production Year</label>\n                    <input\n                      type=\"number\"\n                      className=\"form-control\"\n                      id=\"production-year\"\n                      aria-describedby=\"production year\"\n                      placeholder=\"Enter production year\"\n                      onChange={this.onInput(\"productionYear\", data => parseInt(data, 10))}\n                      value={this.state.movie.productionYear}\n                    />\n                  </div>\n                  <div className=\"form-group\">\n                    <label htmlFor=\"summary\">Summary</label>\n                    <textarea\n                      className=\"form-control\"\n                      id=\"summary\"\n                      aria-describedby=\"summary\"\n                      placeholder=\"Enter summary\"\n                      onChange={this.onInput(\"summary\")}\n                      value={this.state.movie.summary}\n                    />\n                  </div>\n                </div>\n                <div className=\"modal-footer\">\n                  <button type=\"button\" className=\"btn btn-secondary\" data-dismiss=\"modal\">\n                    Close\n                  </button>\n                  <button\n                    type=\"button\"\n                    disabled={!this.valid()}\n                    className=\"btn btn-primary\"\n                    onClick={this.state.movie._id ? this.update : this.add}\n                  >\n                    {movie._id ? \"Update\" : \"Save\"}\n                  </button>\n                </div>\n              </div>\n            </div>\n          </div>\n        )}\n      </Fragment>\n    );\n  }\n}\n\nexport const MovieForm = withApplication(withUser(MovieFormWithContext));\n","import React, { Fragment, useContext, useEffect, useState, useRef } from \"react\";\nimport { MovieCard } from \"./MovieCard\";\nimport isArray from \"lodash/isArray\";\nimport { ApplicationContext, LOADING } from \"../ApplicationContext\";\nimport { MoviesContext } from \"../Common/MoviesContext\";\nimport { MoviesFilter } from \"./MoviesFilter\";\nimport * as MovieAPI from \"../Common/MovieAPI\";\nimport { UserContext } from \"../Login/UserContext\";\nimport debounce from \"lodash/debounce\";\nimport { MovieForm } from \"./MovieForm\";\n\nconst newMovie = () => ({});\nconst getMovies = MovieAPI.getMovies(true);\n\nconst buildQuery = (filters, offset) => {\n  // can use lodash/partition to one line\n  const genres = filters.genres.filter(genre => genre[1]).map(genre => genre[0]);\n  const notGenres = filters.genres.filter(genre => !genre[1]).map(genre => genre[0]);\n  return Object.keys(filters)\n    .filter(key => key !== \"genres\") // handle genres manually\n    .filter(key => key !== \"sort\") // handle sort manually\n    .filter(key => key !== \"productionYear\" || (key === \"productionYear\" && filters[key] !== \"-1\"))\n    .filter(\n      key =>\n        (!isArray(filters[key]) && filters[key] !== null && filters[key] !== \"\") ||\n        (isArray(filters[key]) && filters[key].length > 0)\n    )\n    .map(key => `${key}=${filters[key]}`)\n    .concat(\n      genres.length > 0 ? `genres=${genres.join(\",\")}` : \"\",\n      notGenres.length > 0 ? `notGenres=${notGenres.join(\",\")}` : \"\",\n      `offset=${offset}`\n    )\n    .concat(`sortField=${filters.sort.field}`, `sortOrder=${filters.sort.value}`)\n    .filter(Boolean) // remove empty strings\n    .join(\"&\");\n};\n\nconst computeOffset = (movies, limit) => {\n  return Math.ceil(movies / limit) - 1;\n};\n\nexport const List = () => {\n  // load contexts\n  const { status } = useContext(ApplicationContext);\n  const { state, dispatch } = useContext(MoviesContext);\n  const { movies, filters, count } = state;\n  const user = useContext(UserContext);\n\n  // create state\n  const [offset, setOffset] = useState(movies.length ? computeOffset(movies.length, filters.limit) : 0);\n  const [movie, setMovie] = useState(newMovie());\n  const [key, setKey] = useState(0);\n  // set to true otherwise when navigating back to the page, the loader is displayed\n  const [loaded, setLoaded] = useState(true);\n\n  //create actions\n  const loadMore = _ => {\n    setLoaded(false);\n    getMovies(buildQuery(filters, offset), user).then(movies => {\n      if (offset === 0) {\n        // use a different action on new search otherwise there are some issues due to asynchronous action\n        dispatch({ type: \"SET_MOVIES\", payload: { movies: movies.data, count: movies.count } });\n      } else {\n        dispatch({ type: \"ADD_ALL\", payload: { movies: movies.data, count: movies.count } });\n      }\n      setLoaded(true);\n    });\n  };\n  const showMovie = () => {\n    // ignore first trigger, needed for backward navigation\n    if (key > 0) {\n      // eslint-disable-next-line no-undef\n      $(\"#movie-creator-updator\").modal(\"show\");\n    }\n  };\n\n  // create effects\n  useEffect(\n    () => {\n      // useDebounce :)\n      const debouncedLoadMore = debounce(loadMore, 400, {\n        leading: false,\n        trailing: true\n      });\n      // no movies ? then automatically fetch some (note: every time a filter is updated, movies are cleaned up)\n      if (count === 0) {\n        // the condition is needed in case of back navigation\n        setLoaded(false);\n        setOffset(0);\n        dispatch({ type: \"SET_MOVIES\", payload: {} }); // remove existing movies in case of backward navigation with initial load of movie\n        debouncedLoadMore();\n      }\n      return () => debouncedLoadMore.cancel();\n    },\n    [filters]\n  );\n  useEffect(showMovie, [movie]);\n\n  const isFirstRun = useRef(true);\n  // dont run this the first time landing in the page as it's run by the effect listening to filters\n  useEffect(\n    () => {\n      if (isFirstRun.current) {\n        isFirstRun.current = false;\n        return;\n      }\n      loadMore();\n    },\n    [offset]\n  );\n\n  // render\n  return (\n    <div>\n      {status === LOADING ? (\n        <h2 className=\"text-center mt-2\">\n          <i className=\"fas fa-spinner fa-spin fa-2x\" />\n        </h2>\n      ) : (\n        <Fragment>\n          <MovieForm\n            // force reinitialisation of movie form\n            key={movie._id || key}\n            movie={movie._id ? movie : null}\n            onAdd={movie => dispatch({ type: \"ADD\", payload: { movie } })}\n            onUpdate={movie => dispatch({ type: \"UPDATE\", payload: { movie, id: movie._id } })}\n          />\n          <i\n            onClick={() => {\n              setMovie(newMovie());\n              setKey(key + 1);\n            }}\n            className=\"fas fa-plus-circle fa-3x\"\n            style={{\n              top: \"22px\",\n              left: \"22px\",\n              position: \"absolute\",\n              color: \"#F1F7EE\",\n              cursor: \"pointer\"\n            }}\n            title=\"Add a movie or a tv show\"\n          />\n          <MoviesFilter />\n          <h2 className=\"text-center\">\n            {movies.length === count && count > 0 ? (\n              <span>{count} movies/tvshows</span>\n            ) : movies.length < count ? (\n              <span>\n                {movies.length} of {count} movies/tvshows\n              </span>\n            ) : loaded ? (\n              <span> No movies/tvshows</span>\n            ) : null}\n          </h2>\n          <div className=\"movies\">\n            {movies.map(movie => (\n              <MovieCard\n                key={movie._id}\n                movie={movie}\n                onChange={movie => dispatch({ type: \"UPDATE\", payload: { movie, id: movie._id } })}\n                onDelete={_ => dispatch({ type: \"UPDATE\", payload: { id: movie._id } })}\n                onEdit={() => {\n                  setMovie({\n                    ...movie // create a new movie to force the show effect to be displayed\n                  });\n                  setKey(key + 1); // mandatory otherwise first edit fail\n                }}\n              />\n            ))}\n          </div>\n          <h2 className=\"text-center mt-2\">\n            {!loaded ? (\n              <span>\n                <i className=\"fas fa-spinner fa-spin fa-2x\" />\n              </span>\n            ) : null}\n          </h2>\n          {movies.length < count && loaded ? (\n            <div className=\"text-center m-3\">\n              <button onClick={() => setOffset(offset + 1)} className=\"btn btn-primary btn-lg\">\n                Load more\n              </button>\n            </div>\n          ) : (\n            undefined\n          )}\n        </Fragment>\n      )}\n    </div>\n  );\n};\n","import React, { Fragment, useState, useRef } from \"react\";\nimport identity from \"lodash/identity\";\nimport { AsyncMultiDownshift } from \"./AsyncMultiDownshift\";\nimport \"./EditableField.css\";\n\nconst disableBubbleClick = {\n  onClick: event => {\n    event.preventDefault();\n    event.stopPropagation();\n  }\n};\n\nconst disableDragAndDrop = {\n  draggable: true,\n  onDragStart: event => {\n    event.preventDefault();\n    event.stopPropagation();\n  }\n};\n\nconst EditableField = props => {\n  const [value, setValue] = useState(props.value || \"\");\n  const [edit, setEdit] = useState(!props.value);\n  const transform = props.transform || identity;\n  const lock = props.lock || false;\n\n  // handle props.value update\n  const lastInitialValue = useRef(props.value);\n  if (props.value !== lastInitialValue.current) {\n    setValue(props.value || \"\");\n    setEdit(!props.value);\n    lastInitialValue.current = props.value;\n  }\n\n  return (\n    <Fragment>\n      {!lock && edit ? (\n        <Fragment>\n          {props.renderFormField({\n            ...props,\n            value,\n            // in case of downshift, event is directly the value\n            onChange: event => setValue(transform(event.target ? event.target.value : event)),\n            submit: () => {\n              if (value) {\n                props.onChange(value);\n                setEdit(false);\n              }\n            }\n          })}\n          <button\n            className=\"btn btn-primary\"\n            {...disableDragAndDrop}\n            onClick={event => {\n              event.preventDefault();\n              event.stopPropagation();\n              if (value) {\n                props.onChange(value);\n                setEdit(false);\n              }\n            }}\n          >\n            OK\n          </button>\n        </Fragment>\n      ) : (\n        <Fragment>\n          {props.renderValue({\n            className: `${props.className || \"\"} ${!lock ? \"editable-field\" : \"\"}`,\n            value,\n            onClick: event => {\n              if (!lock) {\n                event.preventDefault();\n                event.stopPropagation();\n                setEdit(true);\n              }\n            }\n          })}\n        </Fragment>\n      )}\n    </Fragment>\n  );\n};\n\nexport const EditableInput = props => (\n  <EditableField\n    {...props}\n    renderFormField={fieldProps => (\n      <div className=\"form-inline d-inline-block\">\n        <input\n          className=\"form-control mr-1\"\n          placeholder={fieldProps.placeholder}\n          type={props.type || \"text\"}\n          value={fieldProps.value}\n          onKeyDown={event => {\n            if (event.key === \"Enter\") {\n              fieldProps.submit();\n            }\n          }}\n          onChange={fieldProps.onChange}\n          {...disableDragAndDrop}\n          {...disableBubbleClick}\n        />\n      </div>\n    )}\n    renderValue={valueProps => (\n      <span onClick={valueProps.onClick} className={valueProps.className}>\n        {valueProps.value}\n      </span>\n    )}\n  />\n);\n\nexport const EditableTextarea = props => (\n  <EditableField\n    {...props}\n    renderFormField={fieldProps => (\n      <textarea\n        className=\"form-control w-100\"\n        placeholder={fieldProps.placeholder}\n        style={fieldProps.style}\n        value={fieldProps.value}\n        rows={fieldProps.rows || 2}\n        onKeyDown={event => {\n          if (event.key === \"Enter\" && event.ctrlKey) {\n            fieldProps.submit();\n          }\n        }}\n        onChange={fieldProps.onChange}\n        {...disableDragAndDrop}\n        {...disableBubbleClick}\n      />\n    )}\n    renderValue={valueProps => (\n      <span onClick={valueProps.onClick} className={`${valueProps.className} w-100`}>\n        {props.split ? (\n          valueProps.value.split(\"\\n\").map((item, key) => (\n            <Fragment key={key}>\n              {item}\n              <br />\n            </Fragment>\n          ))\n        ) : (\n          <Fragment>{valueProps.value}</Fragment>\n        )}\n      </span>\n    )}\n  />\n);\n\nexport const EditableMultiSelect = props => (\n  <EditableField\n    {...props}\n    renderFormField={fieldProps => (\n      <div\n        className=\"form-inline d-inline-block\"\n        style={{\n          minWidth: \"220px\"\n        }}\n      >\n        <AsyncMultiDownshift\n          placeholder={fieldProps.placeholder}\n          handleChange={fieldProps.onChange}\n          items={fieldProps.items}\n          selectedItems={fieldProps.value}\n          className=\"form-group\"\n        />\n      </div>\n    )}\n    renderValue={valueProps => (\n      <span onClick={valueProps.onClick} className={valueProps.className}>\n        {valueProps.value.join(\",\")}\n      </span>\n    )}\n  />\n);\n","import React, { useReducer } from \"react\";\n\nexport const NotificationContext = React.createContext();\n\nconst reducer = (state = [], action) => {\n  switch (action.type) {\n    case \"ADD\":\n      return [...state, { ...action.payload, id: new Date().getTime() }];\n    case \"CLOSE\":\n      return state.filter(notification => notification.id !== action.payload.id);\n    default:\n      return state;\n  }\n};\n\nexport const NotificationProvider = props => {\n  const [state, dispatch] = useReducer(reducer, []);\n  return (\n    <NotificationContext.Provider value={{ notifications: state, dispatch }}>\n      {props.children}\n    </NotificationContext.Provider>\n  );\n};\n","export const seasonTag = seasonIndex => {\n  return `S${(seasonIndex + 1).toString().padStart(2, \"0\")}`;\n};\nexport const episodeTag = (seasonIndex, episodeIndex) => {\n  return `${seasonTag(seasonIndex)}E${(episodeIndex + 1).toString().padStart(2, \"0\")}`;\n};\n\nexport const handleError = dispatch => error => {\n  createNotification(dispatch, error.message, \"error\");\n  throw error;\n};\n\nexport const createNotification = (dispatch, content, type = \"success\") => {\n  dispatch({\n    type: \"ADD\",\n    payload: {\n      content,\n      type\n    }\n  });\n};\n","import { useState } from \"react\";\n\nexport const useToggle = (initialValue = false) => {\n  const [value, setValue] = useState(initialValue);\n  const toggle = () => setValue(!value);\n  return [value, toggle];\n};\n\nexport const useInput = (initialValue = \"\") => {\n  const [value, setValue] = useState(initialValue);\n  return [\n    {\n      value,\n      onChange: event => setValue(event.target.value)\n    },\n    setValue\n  ];\n};\n","import { EditableInput, EditableTextarea } from \"../../Common/EditableField\";\nimport React, { useContext, useState } from \"react\";\nimport { UserContext } from \"../../Login/UserContext\";\nimport { produce } from \"immer\";\nimport * as MovieAPI from \"../../Common/MovieAPI\";\nimport { MovieContext } from \"../Movie\";\nimport { SeasonContext } from \"./Season\";\nimport { NotificationContext } from \"../../Notifications/NotificationContext\";\nimport { MoviesContext } from \"../../Common/MoviesContext\";\nimport { createNotification, episodeTag, handleError } from \"../Movie.util\";\nimport { useToggle } from \"../../Common/hooks\";\n\nexport const Episode = ({ episode, index, onDragStart, onDragOver, onDragEnd, dragging, onSeen }) => {\n  // get contexts\n  const user = useContext(UserContext);\n  const { movie, lock } = useContext(MovieContext);\n  const { season, index: seasonIndex } = useContext(SeasonContext);\n  const { dispatch } = useContext(NotificationContext);\n  const { dispatch: moviesDispatch } = useContext(MoviesContext);\n\n  // local state\n  const [ellipsis, toggleEllipsis] = useToggle(true);\n  const [style, setStyle] = useState({});\n\n  // actions\n  const transformEpisode = transform => {\n    moviesDispatch({\n      type: \"UPDATE_WITH_TRANSFORM\",\n      payload: {\n        id: movie._id,\n        transform\n      }\n    });\n  };\n  const updateEpisode = transform => {\n    const transformedEpisode = produce(episode, transform); // optimistic update\n    transformEpisode(draft => {\n      draft.seasons[seasonIndex].episodes[index] = transformedEpisode;\n    });\n    return MovieAPI.updateEpisode(movie, season, transformedEpisode, user).catch(error => {\n      //revert on error\n      transformEpisode(draft => {\n        draft.seasons[seasonIndex].episodes[index] = episode;\n      });\n      handleError(dispatch)(error);\n    });\n  };\n\n  return (\n    <div\n      className=\"row episode mr-0 ml-0\"\n      draggable={!lock}\n      onDragStart={event => {\n        setStyle({\n          backgroundColor: \"var(--movie-secondary-lighter)\",\n          opacity: \"0.4\",\n          color: \"var(--movie-primary)\"\n        });\n        event.dataTransfer.dropEffect = \"move\";\n        event.stopPropagation();\n        onDragStart();\n      }}\n      onDragOver={() => {\n        dragging && onDragOver();\n      }}\n      onDragEnd={event => {\n        event.stopPropagation();\n        onDragEnd();\n        setStyle({});\n      }}\n      style={style}\n    >\n      <div className=\" col-md-12 col-xl-2 align-items-center d-flex p-0 mb-1 mt-1\">\n        {!lock && (\n          <i\n            className=\"fas fa-times delete-episode\"\n            title={`Delete episode ${index + 1}`}\n            onClick={event => {\n              event.preventDefault();\n              event.stopPropagation();\n              if (window.confirm(\"Delete episode ?\")) {\n                MovieAPI.deleteEpisode(movie, season, episode, user)\n                  .then(() =>\n                    transformEpisode(draft => {\n                      draft.seasons[seasonIndex].episodes = draft.seasons[seasonIndex].episodes.filter(\n                        e => e._id !== episode._id\n                      );\n                    })\n                  )\n                  .then(() => createNotification(dispatch, `${episodeTag(seasonIndex, index)} - Deleted`))\n                  .catch(handleError(dispatch));\n              }\n            }}\n          />\n        )}\n        <div\n          className=\"text-center col-1\"\n          style={{\n            color: episode.seen ? \"var(--success)\" : \"\",\n            fontWeight: episode.seen ? \"bold\" : \"\",\n            cursor: \"pointer\"\n          }}\n          onClick={() => onSeen(!episode.seen)}\n        >\n          {index + 1}\n        </div>\n        <div className=\"text-center col-11\">\n          <EditableInput\n            lock={lock}\n            className={`font-weight-bold episode-title ${episode.seen ? \"seen\" : \"\"}`}\n            value={episode.title}\n            placeholder=\"Title\"\n            onChange={title =>\n              updateEpisode(episode => {\n                episode.title = title;\n              }).then(() => createNotification(dispatch, `${episodeTag(seasonIndex, index)} - Title updated`))\n            }\n          />\n        </div>\n      </div>\n      <div className=\"col-md-12 col-xl-10 align-items-center d-flex mb-1 mt-1\">\n        <EditableTextarea\n          lock={lock}\n          style={{ width: \"100%\" }}\n          rows={4}\n          value={episode.summary}\n          placeholder=\"Summary\"\n          className={`${ellipsis ? \"ellipsis\" : \"\"} d-block episode-summary w-100 text-left`}\n          onChange={summary =>\n            updateEpisode(episode => {\n              episode.summary = summary;\n            }).then(() => createNotification(dispatch, `${episodeTag(seasonIndex, index)} - Summary updated`))\n          }\n        />\n        {lock && (\n          <span style={{ cursor: \"pointer\" }} onClick={() => toggleEllipsis()}>\n            <i className=\"fas fa-question-circle\" title={ellipsis ? \"Display summary\" : \"Hide summary\"} />\n          </span>\n        )}\n      </div>\n    </div>\n  );\n};\n","import React, { useContext, Fragment, useState } from \"react\";\nimport { EditableInput } from \"../../Common/EditableField\";\nimport * as MovieAPI from \"../../Common/MovieAPI\";\nimport { produce } from \"immer\";\nimport { UserContext } from \"../../Login/UserContext\";\nimport { MovieSeen } from \"../../Common/MovieSeen\";\nimport { Episode } from \"./Episode\";\nimport every from \"lodash/every\";\nimport some from \"lodash/some\";\nimport { useToggle } from \"../../Common/hooks\";\nimport { MovieContext } from \"../../Movie/Movie\";\nimport { NotificationContext } from \"../../Notifications/NotificationContext\";\nimport \"./Season.css\";\nimport { MoviesContext } from \"../../Common/MoviesContext\";\nimport { createNotification, episodeTag, handleError, seasonTag } from \"../Movie.util\";\n\nexport const SeasonContext = React.createContext({});\n\nexport const Season = ({ season, index, onDragStart, onDragOver, onDragEnd, dragging, onProductionYearUpdate }) => {\n  // get contexts\n  const user = useContext(UserContext);\n  const { movie, lock } = useContext(MovieContext);\n  const { dispatch } = useContext(NotificationContext);\n  const { dispatch: moviesDispatch } = useContext(MoviesContext);\n\n  const [open, toggle] = useToggle();\n  const [episodes, setEpisodes] = useState(1);\n  const [opacity, setOpacity] = useState(\"1\");\n  const [drag, setDrag] = useState();\n\n  // actions\n  const transformSeason = transform => {\n    moviesDispatch({\n      type: \"UPDATE_WITH_TRANSFORM\",\n      payload: {\n        id: movie._id,\n        transform\n      }\n    });\n  };\n  const updateSeason = (transform = value => value) => {\n    return MovieAPI.updateSeason(movie, produce(season, transform), user)\n      .then(season =>\n        transformSeason(draft => {\n          draft.seasons[index] = season;\n        })\n      )\n      .catch(handleError(dispatch));\n  };\n  const updateEpisode = (episode, episodeIndex, transform = value => value) => {\n    const transformedEpisode = produce(episode, transform); // optimistic update\n    transformSeason(draft => {\n      draft.seasons[index].episodes[episodeIndex] = transformedEpisode;\n    });\n    return MovieAPI.updateEpisode(movie, season, transformedEpisode, user).catch(error => {\n      //revert on error\n      transformSeason(draft => {\n        draft.seasons[index].episodes[episodeIndex] = episode;\n      });\n      handleError(dispatch)(error);\n    });\n  };\n  const addEpisodes = async () => {\n    const times = episodes || 1;\n    for (let i = 0; i < times; i++) {\n      const newEpisode = await MovieAPI.addEpisode(movie, season, user).catch(handleError(dispatch));\n      transformSeason(draft => {\n        draft.seasons[index].episodes.push(newEpisode);\n      });\n    }\n    createNotification(dispatch, `${seasonTag(index)} - Added ${times} episodes`);\n    setEpisodes(1);\n  };\n\n  const seen = every(season.episodes, \"seen\") && season.episodes.length > 0;\n  const oneSeen = some(season.episodes, \"seen\") && season.episodes.length > 0;\n\n  return (\n    <div\n      className=\"season\"\n      draggable={!lock}\n      onDragStart={event => {\n        setOpacity(\"0.5\");\n        event.dataTransfer.dropEffect = \"move\";\n        event.stopPropagation();\n        onDragStart();\n      }}\n      onDragEnd={event => {\n        event.stopPropagation();\n        onDragEnd();\n        setOpacity(\"1.5\");\n      }}\n      onDragOver={() => {\n        dragging && onDragOver();\n      }}\n      style={{\n        opacity\n      }}\n    >\n      <div className=\"season-header\" onClick={toggle}>\n        <div>\n          <MovieSeen\n            seen={seen}\n            partial={oneSeen}\n            onClick={async event => {\n              event.preventDefault();\n              event.stopPropagation();\n              const promises = [];\n              for (let i = 0; i < season.episodes.length; i++) {\n                // only update episodes for which seen value is different\n                if (season.episodes[i].seen !== !seen) {\n                  promises.push(\n                    updateEpisode(season.episodes[i], i, draft => {\n                      draft.seen = !seen;\n                    })\n                  );\n                }\n              }\n              await Promise.all(promises);\n              createNotification(dispatch, `${seasonTag(index)} - ${seen ? \"unseen\" : \"seen\"}`);\n            }}\n          />\n        </div>\n        <div>\n          {!lock && (\n            <i\n              title={`Delete season ${index + 1}`}\n              className=\"fas fa-times delete-season\"\n              onClick={event => {\n                event.preventDefault();\n                event.stopPropagation();\n                if (window.confirm(\"Delete season ?\")) {\n                  MovieAPI.deleteSeason(movie, season, user)\n                    .then(() =>\n                      transformSeason(draft => {\n                        draft.seasons = draft.seasons.filter(s => s._id !== season._id);\n                      })\n                    )\n                    .then(() => createNotification(dispatch, `${seasonTag(index)} - Deleted`))\n                    .catch(handleError(dispatch));\n                }\n              }}\n            />\n          )}\n          &nbsp;Season {index + 1}\n          &nbsp;-&nbsp;\n          <EditableInput\n            lock={lock}\n            placeholder=\"YYYY\"\n            type=\"number\"\n            value={season.productionYear}\n            transform={value => parseInt(value, 10)}\n            onChange={productionYear => onProductionYearUpdate(productionYear)}\n          />\n        </div>\n        <div className=\"season-header-arrow\">\n          {open ? <i className=\"fas fa-chevron-up\" title=\"Hide\" /> : <i className=\"fas fa-chevron-down\" title=\"Show\" />}\n        </div>\n      </div>\n      <div className=\"episodes\">\n        <SeasonContext.Provider value={{ season, index }}>\n          {open &&\n            season.episodes.map((episode, episodeIndex) => (\n              <Episode\n                key={episode._id}\n                episode={episode}\n                index={episodeIndex}\n                dragging={drag !== undefined}\n                onDragStart={() => {\n                  setDrag(episodeIndex);\n                }}\n                onDragOver={() => {\n                  if (episodeIndex !== drag) {\n                    setDrag(episodeIndex);\n                    season.episodes = produce(season.episodes, draft => {\n                      const tmp = draft[episodeIndex];\n                      draft[episodeIndex] = draft[drag];\n                      draft[drag] = tmp;\n                    });\n                  }\n                }}\n                onDragEnd={() => {\n                  updateSeason().then(() =>\n                    createNotification(dispatch, `${episodeTag(index, episodeIndex)} - Reordered`)\n                  );\n                  setDrag();\n                }}\n                onSeen={async seen => {\n                  const promises = [];\n                  if (!seen) {\n                    promises.push(\n                      updateEpisode(season.episodes[episodeIndex], episodeIndex, draft => {\n                        draft.seen = false;\n                      })\n                    );\n                  } else {\n                    for (let i = 0; i <= episodeIndex; i++) {\n                      // only update episodes that are not seen\n                      if (!season.episodes[i].seen) {\n                        promises.push(\n                          updateEpisode(season.episodes[i], i, draft => {\n                            draft.seen = true;\n                          })\n                        );\n                      }\n                    }\n                  }\n                  await Promise.all(promises);\n                  createNotification(dispatch, `Episodes set to ${seen ? \"seen\" : \"unseen\"}`);\n                }}\n              />\n            ))}\n        </SeasonContext.Provider>\n      </div>\n\n      {!lock ? (\n        <Fragment>\n          {open && (\n            <div\n              className=\"form-inline d-block mt-1 mb-1\"\n              draggable={true}\n              onDragStart={event => {\n                // disable drag and drop for this element\n                event.preventDefault();\n                event.stopPropagation();\n              }}\n            >\n              <input\n                type=\"number\"\n                className=\"form-control\"\n                style={{ width: \"80px\" }}\n                onChange={event => setEpisodes(parseInt(event.target.value, 10))}\n                onKeyDown={event => {\n                  if (event.key === \"Enter\") {\n                    addEpisodes();\n                  }\n                }}\n                value={episodes}\n              />\n              <button className=\" ml-1 btn btn-primary\" onClick={addEpisodes}>\n                <i className=\"fas fa-plus\" title=\"Add episode\" />\n                &nbsp;Add episode\n              </button>\n            </div>\n          )}\n        </Fragment>\n      ) : (\n        undefined\n      )}\n    </div>\n  );\n};\n","import React from \"react\";\nimport \"./Loader.css\";\n\nexport const Loader = () => {\n  return (\n    <div className=\"loader d-flex\">\n      <i className=\"fas fa-spinner fa-spin fa-5x\" />\n    </div>\n  );\n};\n","import React, { Fragment, useContext, useEffect, useState, useRef } from \"react\";\nimport { withRouter } from \"react-router-dom\";\nimport * as MovieAPI from \"../Common/MovieAPI\";\nimport { UserContext } from \"../Login/UserContext\";\nimport { MovieSeen } from \"../Common/MovieSeen\";\nimport { MoviesContext } from \"../Common/MoviesContext\";\nimport { produce } from \"immer\";\nimport { Season } from \"./Season/Season\";\nimport { EditableInput, EditableTextarea, EditableMultiSelect } from \"../Common/EditableField\";\nimport { useToggle } from \"../Common/hooks\";\nimport \"./Movie.css\";\nimport { ApplicationContext } from \"../ApplicationContext\";\nimport { Tag } from \"../Admin/Tag\";\nimport find from \"lodash/find\";\nimport { NotificationContext } from \"../Notifications/NotificationContext\";\nimport { createNotification, handleError, seasonTag } from \"./Movie.util\";\nimport { Loader } from \"../Common/Loader\";\n\nexport const MovieContext = React.createContext({});\n\nconst MovieTag = ({ tag, selected, onAdd, onDelete, lock }) =>\n  !lock ? (\n    <div onClick={selected ? onDelete : onAdd} className={`movie-tag ${selected ? \"selected\" : \"\"}`}>\n      <Tag {...tag} className={`d-inline-block`} />\n    </div>\n  ) : selected ? (\n    <div className=\"movie-tag selected\">\n      <Tag {...tag} className={`d-inline-block`} />\n    </div>\n  ) : null;\n\nexport const Movie = withRouter(({ match, history }) => {\n  // get contexts\n  const user = useContext(UserContext);\n  const {\n    state: { movies },\n    dispatch: moviesDispatch\n  } = useContext(MoviesContext);\n  const [seasons, setSeasons] = useState(1);\n  const { tags, genres } = useContext(ApplicationContext);\n  const { dispatch } = useContext(NotificationContext);\n  // create state\n  const [drag, setDrag] = useState();\n  const [lock, toggle] = useToggle(true);\n  const [loadImage, setLoadImage] = useState(false);\n\n  const fileRef = useRef();\n\n  // create effects\n  let movie = find(movies, [\"_id\", match.params.id]);\n  useEffect(\n    () => {\n      if (!movie) {\n        MovieAPI.getMovie(match.params.id, user)\n          .then(movie => {\n            moviesDispatch({ type: \"ADD\", payload: { movie } });\n          })\n          .catch(handleError(dispatch));\n      }\n    },\n    [match.params.id]\n  );\n\n  // create actions\n\n  const transformMovie = transform => {\n    moviesDispatch({\n      type: \"UPDATE_WITH_TRANSFORM\",\n      payload: {\n        id: movie._id,\n        transform\n      }\n    });\n  };\n  const updateSeason = (season, seasonIndex, transform = value => value) => {\n    return MovieAPI.updateSeason(movie, produce(season, transform), user)\n      .then(season =>\n        transformMovie(draft => {\n          draft.seasons[seasonIndex] = season;\n        })\n      )\n      .catch(handleError(dispatch));\n  };\n  const updateMovie = (transform = value => value) => {\n    return MovieAPI.updateMovie(produce(movie, transform), user)\n      .then(movie => {\n        moviesDispatch({ type: \"UPDATE\", payload: { id: movie._id, movie } });\n      })\n      .catch(handleError(dispatch));\n  };\n  const handleFiles = files => {\n    if (files.length === 1) {\n      setLoadImage(true);\n      MovieAPI.updateMoviePoster(movie, files[0], user)\n        .then(movie => {\n          fileRef.current.value = \"\";\n          moviesDispatch({ type: \"UPDATE\", payload: { id: movie._id, movie } });\n          createNotification(dispatch, `${movie.title} - Image uploaded`);\n          setLoadImage(false);\n        })\n        .catch(error => {\n          fileRef.current.value = \"\";\n          handleError(dispatch)(error);\n          setLoadImage(false);\n        });\n    }\n  };\n  const addSeasons = async () => {\n    const times = seasons || 1;\n    for (let i = 0; i < times; i++) {\n      const newSeason = await MovieAPI.addSeason(movie, user).catch(handleError(dispatch));\n      transformMovie(draft => {\n        draft.seasons.push(newSeason);\n      });\n    }\n    createNotification(dispatch, `${movie.title} - Added ${times} seasons`);\n    setSeasons(1);\n  };\n\n  return (\n    <div className=\"container movie-container\">\n      {!movie ? (\n        <h2 className=\"text-center mt-2\">\n          <i className=\"fas fa-spinner fa-spin fa-2x\" />\n        </h2>\n      ) : (\n        <Fragment>\n          <i\n            onClick={() => history.goBack()}\n            className=\"fas fa-arrow-circle-left fa-3x\"\n            style={{\n              top: \"22px\",\n              left: \"22px\",\n              position: \"absolute\",\n              color: \"#F1F7EE\",\n              cursor: \"pointer\"\n            }}\n            title=\"Return to the list of movies\"\n          />\n          <div className=\"p-5 mt-3 single-movie-card\" style={{ position: \"relative\" }}>\n            <i\n              onClick={toggle}\n              className={`fas ${lock ? \"fa-lock\" : \"fa-lock-open\"} fa-2x`}\n              style={{\n                color: \"var(--movie-secondary)\",\n                position: \"absolute\",\n                top: \"5px\",\n                right: \"5px\",\n                cursor: \"pointer\"\n              }}\n              title={`Click to ${lock ? \"open\" : \"close\"} movie for modifications`}\n            />\n            <div className=\"d-flex\">\n              <div className=\"d-flex\" style={{ flex: \"0 0 250px\", flexDirection: \"column\" }}>\n                <input\n                  accept=\".jpg, .jpeg, .png\"\n                  type=\"file\"\n                  ref={fileRef}\n                  style={{ display: \"none\" }}\n                  onChange={event => handleFiles(event.target.files)}\n                />\n                <div>\n                  <span\n                    className={`d-inline-block ${!lock ? \"editable-field\" : \"\"}`}\n                    onClick={() => !lock && fileRef.current.click()}\n                    style={{ position: \"relative\" }}\n                  >\n                    {loadImage ? <Loader /> : null}\n                    <img\n                      src={movie.fileUrl ? movie.fileUrl.replace(\"http:\", \"https:\") : \"/no-image.png\"}\n                      style={{\n                        height: \"300px\",\n                        width: \"225px\",\n                        cursor: lock ? \"auto\" : \"pointer\",\n                        opacity: lock ? 1 : 0.3\n                      }}\n                      alt=\"movie poster\"\n                    />\n                    {!lock && movie.fileUrl && (\n                      <i\n                        className=\"fas fa-times delete-poster\"\n                        title=\"Delete movie poster\"\n                        onClick={event => {\n                          event.preventDefault();\n                          event.stopPropagation();\n                          if (window.confirm(\"Delete poster ?\")) {\n                            updateMovie(movie => {\n                              movie.fileUrl = \"\";\n                            }).then(() => createNotification(dispatch, `${movie.title} - Poster deleted`));\n                          }\n                        }}\n                      />\n                    )}\n                  </span>\n                </div>\n                <div className=\"d-flex flex-wrap mt-1 mb-1\">\n                  {tags.map(tag => (\n                    <MovieTag\n                      key={tag._id}\n                      tag={tag}\n                      lock={lock}\n                      selected={movie.tags.find(movieTag => movieTag === tag._id)}\n                      onAdd={() =>\n                        updateMovie(movie => {\n                          movie.tags.push(tag._id);\n                        }).then(() => createNotification(dispatch, `${movie.title} - Tag ${tag.label} added`))\n                      }\n                      onDelete={() =>\n                        updateMovie(movie => {\n                          movie.tags = movie.tags.filter(movieTag => movieTag !== tag._id);\n                        }).then(() => createNotification(dispatch, `${movie.title} - Tag ${tag.label} deleted`))\n                      }\n                    />\n                  ))}\n                </div>\n              </div>\n              <div className=\"pl-4 d-flex flex-column\" style={{ flexGrow: 1 }}>\n                <h1 className=\"text-center\">\n                  <EditableInput\n                    lock={lock}\n                    value={movie.title}\n                    placeholder=\"Title\"\n                    onChange={title =>\n                      updateMovie(movie => {\n                        movie.title = title;\n                      }).then(() => createNotification(dispatch, `${title} - Title updated`))\n                    }\n                  />{\" \"}\n                  -{\" \"}\n                  <EditableInput\n                    lock={lock}\n                    value={movie.productionYear}\n                    placeholder=\"YYYY\"\n                    type=\"number\"\n                    transform={value => parseInt(value, 10)}\n                    onChange={productionYear =>\n                      updateMovie(movie => {\n                        movie.productionYear = productionYear;\n                      }).then(() => createNotification(dispatch, `${movie.title} - Production year updated`))\n                    }\n                  />\n                </h1>\n                <div className=\"text-center single-movie-subtitle mb-2\">\n                  <EditableMultiSelect\n                    lock={lock}\n                    value={movie.genre}\n                    placeholder=\"Genre\"\n                    items={genres}\n                    onChange={genres =>\n                      updateMovie(movie => {\n                        movie.genre = genres;\n                      }).then(() => createNotification(dispatch, `${movie.title} - Genre updated`))\n                    }\n                  />\n                </div>\n                <div>\n                  <EditableTextarea\n                    split={true}\n                    lock={lock}\n                    value={movie.summary}\n                    style={{ width: \"100%\" }}\n                    placeholder=\"Summary\"\n                    rows=\"7\"\n                    onChange={summary =>\n                      updateMovie(movie => {\n                        movie.summary = summary;\n                      }).then(() => createNotification(dispatch, `${movie.title} - Summary updated`))\n                    }\n                  />\n                </div>\n              </div>\n            </div>\n            <div>\n              {movie.type === \"Film\" ? (\n                <MovieSeen\n                  seen={movie.seen}\n                  onClick={() =>\n                    updateMovie(movie => {\n                      movie.seen = !movie.seen;\n                    }).then(() => createNotification(dispatch, `${movie.title} - Seen updated`))\n                  }\n                />\n              ) : (\n                undefined\n              )}\n            </div>\n            <div className=\"text-center\">\n              {movie.type !== \"Film\" ? (\n                <Fragment>\n                  <MovieContext.Provider value={{ lock, movie }}>\n                    <div>\n                      {movie.seasons.map((season, seasonIndex) => (\n                        <Season\n                          key={season._id}\n                          season={season}\n                          index={seasonIndex}\n                          dragging={drag !== undefined}\n                          onDragStart={() => setDrag(seasonIndex)}\n                          onDragOver={() => {\n                            if (seasonIndex !== drag) {\n                              setDrag(seasonIndex);\n                              movie.seasons = produce(movie.seasons, draft => {\n                                const tmp = draft[seasonIndex];\n                                draft[seasonIndex] = draft[drag];\n                                draft[drag] = tmp;\n                              });\n                            }\n                          }}\n                          onDragEnd={() => {\n                            updateMovie().then(() =>\n                              createNotification(dispatch, `${seasonTag(seasonIndex)} - Reordered`)\n                            );\n                            setDrag();\n                          }}\n                          onProductionYearUpdate={async productionYear => {\n                            const promises = [];\n                            for (let i = seasonIndex; i < movie.seasons.length; i++) {\n                              promises.push(\n                                updateSeason(movie.seasons[i], i, draft => {\n                                  draft.productionYear = productionYear + (i - seasonIndex);\n                                })\n                              );\n                            }\n                            await Promise.all(promises);\n                            createNotification(dispatch, \"Seasons production years updated\");\n                          }}\n                        />\n                      ))}\n                    </div>\n                  </MovieContext.Provider>\n                  {!lock ? (\n                    <div className=\"form-inline d-block mt-1 mb-1\">\n                      <input\n                        type=\"number\"\n                        className=\"form-control\"\n                        style={{ width: \"80px\" }}\n                        onChange={event => setSeasons(parseInt(event.target.value, 10))}\n                        onKeyDown={event => {\n                          if (event.key === \"Enter\") {\n                            addSeasons();\n                          }\n                        }}\n                        value={seasons}\n                      />\n                      <button className=\" ml-1 btn btn-primary\" onClick={addSeasons}>\n                        <i className=\"fas fa-plus\" title=\"Add seasons\" />\n                        &nbsp;Add season\n                      </button>\n                    </div>\n                  ) : (\n                    undefined\n                  )}\n                </Fragment>\n              ) : (\n                undefined\n              )}\n            </div>\n          </div>\n        </Fragment>\n      )}\n    </div>\n  );\n});\n","import React, { Component, Fragment } from \"react\";\nimport debounce from \"lodash/debounce\";\nimport { withUser } from \"../Login/UserContext\";\n\nexport const LOADING = Symbol(\"LOADING\");\nexport const LOADED = Symbol(\"LOADED\");\n\nconst headers = user => ({\n  Accept: \"application/json\",\n  \"Content-Type\": \"application/json\",\n  Authorization: `Bearer ${user.token}`\n});\nconst handleResponse = response => {\n  if (response.ok) return response.json();\n  throw new Error(\"Fetch fail\");\n};\n\nclass FetchWithContext extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      status: LOADING,\n      data: undefined\n    };\n\n    // TODO probably not the best place to debounce\n    this.debounceFetch = debounce(this.fetch, this.props.debounce || 0, {\n      leading: false,\n      trailing: true\n    });\n  }\n\n  componentWillUnmount() {\n    this.debounceFetch.cancel();\n  }\n\n  fetch() {\n    return fetch(`${this.props.endpoint}`, {\n      headers: headers(this.props.user)\n    })\n      .then(handleResponse)\n      .then(data => {\n        this.setState({\n          status: LOADED,\n          data\n        });\n        this.props.onSuccess && this.props.onSuccess(data);\n      });\n  }\n\n  componentDidMount() {\n    this.debounceFetch();\n  }\n\n  render() {\n    return (\n      <Fragment>\n        {this.props.children({\n          status: this.state.status,\n          data: this.state.data\n        })}\n      </Fragment>\n    );\n  }\n}\n\n/**\n * - create a context that holds movies\n * - dont load if there is already sth in the context\n * - pass initial data to prevent fetch the api (if data, dont fetch on cDM)\n */\n\nexport const Fetch = withUser(FetchWithContext);\n","import { Fetch } from \"./Common/Fetch\";\nimport React from \"react\";\nimport { Link } from \"react-router-dom\";\n\nexport const Header = () => {\n  return (\n    <div\n      className=\"text-center\"\n      style={{\n        backgroundColor: \"var(--movie-secondary)\",\n        color: \"var(--movie-primary)\",\n        padding: \"4px\"\n      }}\n    >\n      <h1 className=\"header\">\n        <Link to=\"/\">Cinematheque</Link>\n      </h1>\n      <Fetch endpoint=\"/api/movies?limit=0\">{({ data }) => <h6>{data ? data.count : 0} movies/tvshows</h6>}</Fetch>\n      <Link to=\"/stats\">\n        <i\n          className=\"fas fa-chart-bar fa-3x\"\n          style={{\n            top: \"22px\",\n            right: \"22px\",\n            position: \"absolute\",\n            color: \"#F1F7EE\",\n            cursor: \"pointer\"\n          }}\n          title=\"Show statistics\"\n        />\n      </Link>\n    </div>\n  );\n};\n","import React, { Fragment, useContext, useEffect, useState } from \"react\";\nimport { ApplicationContext } from \"../ApplicationContext\";\nimport * as MovieAPI from \"../Common/MovieAPI\";\nimport \"./Statistics.css\";\nimport { produce } from \"immer\";\nimport { UserContext } from \"../Login/UserContext\";\nimport orderBy from \"lodash/orderBy\";\nimport { Tag } from \"../Admin/Tag\";\nimport { MoviesContext } from \"../Common/MoviesContext\";\nimport { withRouter } from \"react-router-dom\";\n\nconst getMovies = MovieAPI.getMovies(false);\n\nconst initialState = (types, genres, tags) => {\n  return {\n    types: types.map(type => ({\n      name: type,\n      count: 0,\n      genres: genres.map(genre => ({\n        name: genre,\n        count: 0,\n        seen: 0,\n        unseen: 0\n      }))\n    })),\n    tags: tags.map(tag => ({\n      id: tag._id,\n      name: tag.label,\n      color: tag.color,\n      count: 0\n    }))\n  };\n};\n\nexport const Statistics = withRouter(({ history }) => {\n  // get contexts\n  const user = useContext(UserContext);\n  const { genres, types, tags } = useContext(ApplicationContext);\n  const { dispatch } = useContext(MoviesContext);\n  const [stats, setStats] = useState(initialState(types, genres, tags));\n\n  // actions\n  const fetchByTypes = (types, genres) => {\n    types.forEach(type =>\n      getMovies(`types=${type}&limit=0`, user)\n        .then(data => setStats(produce(draft => void (draft.types.find(t => type === t.name).count = data.count))))\n        .then(() =>\n          genres.forEach(genre => {\n            getMovies(`types=${type}&genres=${genre}&limit=0`, user).then(data =>\n              setStats(\n                produce(\n                  draft =>\n                    void (draft.types.find(t => type === t.name).genres.find(g => genre === g.name).count = data.count)\n                )\n              )\n            );\n            getMovies(`types=${type}&genres=${genre}&seen=true&limit=0`, user).then(data =>\n              setStats(\n                produce(\n                  draft =>\n                    void (draft.types.find(t => type === t.name).genres.find(g => genre === g.name).seen = data.count)\n                )\n              )\n            );\n            getMovies(`types=${type}&genres=${genre}&seen=false&limit=0`, user).then(data =>\n              setStats(\n                produce(\n                  draft =>\n                    void (draft.types.find(t => type === t.name).genres.find(g => genre === g.name).unseen = data.count)\n                )\n              )\n            );\n          })\n        )\n    );\n  };\n\n  const fetchByTags = tags => {\n    tags.forEach(tag =>\n      getMovies(`tags=${tag._id}&limit=0`, user).then(data =>\n        setStats(\n          produce(draft => {\n            draft.tags.find(t => tag._id === t.id).count += data.count;\n          })\n        )\n      )\n    );\n  };\n\n  // effects\n  useEffect(\n    () => {\n      setStats(initialState(types, genres, tags));\n      fetchByTypes(types, genres);\n      fetchByTags(tags);\n    },\n    [types, genres, tags]\n  );\n\n  return (\n    <div className=\"d-flex justify-content-around flex-wrap mb-4\">\n      {stats.types.map((type, index) => (\n        <div className=\"card stat-card\" key={index}>\n          <div className=\"card-body\">\n            <h5 className=\"card-title text-center\">\n              {type.count} {type.name}\n            </h5>\n            <div>\n              {orderBy(type.genres, [\"count\"], [\"desc\"]).map((genre, index) => (\n                <Fragment key={index}>\n                  <div>\n                    {\" \"}\n                    {genre.count} {genre.name} ( {genre.count ? ((genre.seen * 100) / genre.count).toFixed(2) : 0}%\n                    seen){\" \"}\n                  </div>\n                  <div className=\"movie-progress\">\n                    <div\n                      className=\"progress-bar unseen\"\n                      role=\"progressbar\"\n                      style={{\n                        width: `calc(20px + ${(genre.unseen * 100) /\n                          orderBy(type.genres, [\"count\"], [\"desc\"])[0].count}%)`\n                      }}\n                    >\n                      {genre.unseen}\n                    </div>\n                    {genre.count - genre.unseen - genre.seen ? (\n                      <div\n                        className=\"progress-bar pending\"\n                        role=\"progressbar\"\n                        style={{\n                          width: `calc(20px + ${((genre.count - genre.unseen - genre.seen) * 100) /\n                            orderBy(type.genres, [\"count\"], [\"desc\"])[0].count}%)`\n                        }}\n                      >\n                        {genre.count - genre.unseen - genre.seen}\n                      </div>\n                    ) : (\n                      undefined\n                    )}\n                    <div\n                      className=\"progress-bar seen\"\n                      role=\"progressbar\"\n                      style={{\n                        width: `calc(20px + ${(genre.seen * 100) /\n                          orderBy(type.genres, [\"count\"], [\"desc\"])[0].count}%)`\n                      }}\n                    >\n                      {genre.seen}\n                    </div>\n                  </div>\n                </Fragment>\n              ))}\n            </div>\n          </div>\n        </div>\n      ))}\n      <div className=\"card stat-card stat-tags-card\">\n        <div className=\"card-body align-content-center\">\n          {stats.tags.map((tag, index) => (\n            <h5\n              className=\"text-center stat-tags-card-card mt-1\"\n              style={{\n                cursor: \"pointer\"\n              }}\n              key={index}\n            >\n              <Tag\n                label={`${tag.count} ${tag.name}`}\n                color={tag.color}\n                onClick={() => {\n                  dispatch({ type: \"RESET_FILTERS\" });\n                  dispatch({ type: \"FILTERS_CHANGED\", payload: { name: \"tags\", value: [tag.id] } });\n                  history.push(\"/\");\n                }}\n              />\n            </h5>\n          ))}\n        </div>\n      </div>\n    </div>\n  );\n});\n","const random = max => {\n  return Math.floor(Math.random() * Math.floor(max));\n};\nexport const generateColor = () => {\n  return `#${random(256)\n    .toString(16)\n    .padStart(2, \"0\")}${random(256)\n    .toString(16)\n    .padStart(2, \"0\")}${random(256)\n    .toString(16)\n    .padStart(2, \"0\")}`;\n};\n","import React, { useContext, Fragment } from \"react\";\nimport \"./TagList.css\";\nimport { deleteTag, updateTag } from \"../Common/TagAPI\";\nimport { UserContext } from \"../Login/UserContext\";\nimport { Tag } from \"./Tag\";\nimport { useInput, useToggle } from \"../Common/hooks\";\nimport { generateColor } from \"./tag.utils\";\nimport { ApplicationContext } from \"../ApplicationContext\";\n\nexport const TagListElement = ({ tag, onDelete, onUpdate }) => {\n  const [edit, toggleEdit] = useToggle(false);\n  const [color, setColor] = useInput(tag.color || \"\");\n  const [label] = useInput(tag.label || \"\");\n  // get context\n  const user = useContext(UserContext);\n  const { tags } = useContext(ApplicationContext);\n\n  return (\n    <div\n      className=\"mt-2 mb-2 d-flex\"\n      style={{\n        overflow: \"hidden\" // Collapsing margins\n      }}\n    >\n      {/* avoid the tag element to fill up all the available height */}\n      {!edit ? (\n        <Fragment>\n          <div>\n            <Tag {...tag} big />\n          </div>\n          <button type=\"button\" className=\"btn btn-primary ml-2\" onClick={toggleEdit}>\n            <i className=\"fas fa-pencil-alt\" />\n          </button>\n          <button\n            type=\"button\"\n            className=\"btn btn-danger ml-2\"\n            onClick={_ => {\n              if (window.confirm(\"Delete tag ?\")) {\n                deleteTag(tag, user).then(onDelete);\n              }\n            }}\n          >\n            <i className=\"fas fa-times\" />\n          </button>\n        </Fragment>\n      ) : (\n        <form className=\"form-inline w-100\">\n          <input type=\"color\" className=\"form-control colorpicker\" {...color} />\n          <input type=\"text\" className=\"form-control ml-2\" placeholder=\"Label\" {...label} />\n          <button\n            type=\"button\"\n            className=\"btn btn-info btn-sm ml-2\"\n            onClick={() => {\n              setColor(generateColor());\n            }}\n          >\n            <i className=\"fas fa-sync-alt\" />\n          </button>\n          <button\n            type=\"button\"\n            className=\"btn btn-primary btn-sm ml-2\"\n            onClick={() => {\n              updateTag(\n                {\n                  _id: tag._id,\n                  color: color.value,\n                  label: label.value\n                },\n                user\n              )\n                .then(onUpdate)\n                .then(toggleEdit);\n            }}\n            disabled={!label.value || tags.find(tag => tag.label.toLowerCase() === label.value.toLowerCase())}\n          >\n            <i className=\"fas fa-check\" />\n          </button>\n          <Tag style={{ marginLeft: \"auto\" }} color={color.value} label={label.value || \"Label\"} />\n        </form>\n      )}\n    </div>\n  );\n};\n","import React, { useContext } from \"react\";\nimport \"./TagList.css\";\nimport { useInput } from \"../Common/hooks\";\nimport { createTag } from \"../Common/TagAPI\";\nimport { UserContext } from \"../Login/UserContext\";\nimport { Tag } from \"./Tag\";\nimport { ApplicationContext } from \"../ApplicationContext\";\nimport { TagListElement } from \"./TagListElement\";\nimport { generateColor } from \"./tag.utils\";\nimport { produce } from \"immer\";\n\nexport const TagList = () => {\n  // get context\n  const user = useContext(UserContext);\n  const { tags, set } = useContext(ApplicationContext);\n  const setTags = set(\"tags\");\n\n  // create state\n  const [color, setColor] = useInput(generateColor());\n  const [label, setLabel] = useInput(\"\");\n\n  return (\n    <div className=\"container tags-card\">\n      {tags.map((tag, index) => (\n        <TagListElement\n          key={tag._id}\n          tag={tag}\n          onDelete={() => setTags(tags => tags.filter(t => t._id !== tag._id))}\n          onUpdate={tag => {\n            setTags(tags =>\n              produce(tags, draft => {\n                draft[index] = tag;\n              })\n            );\n          }}\n        />\n      ))}\n      <form className=\"form-inline\">\n        <input type=\"color\" className=\"form-control colorpicker\" {...color} />\n        <input type=\"text\" className=\"form-control ml-2\" placeholder=\"Label\" {...label} />\n        <button\n          type=\"button\"\n          className=\"btn btn-info btn-sm ml-2\"\n          onClick={() => {\n            setColor(generateColor());\n          }}\n        >\n          <i className=\"fas fa-sync-alt\" />\n        </button>\n        <button\n          type=\"button\"\n          className=\"btn btn-primary btn-sm ml-2\"\n          onClick={() => {\n            createTag(\n              {\n                label: label.value,\n                color: color.value\n              },\n              user\n            )\n              .then(tag => setTags(tags => [...tags, tag]))\n              .then(_ => {\n                setColor(generateColor());\n                setLabel(\"\");\n              });\n          }}\n          disabled={!label.value || tags.find(tag => tag.label.toLowerCase() === label.value.toLowerCase())}\n        >\n          <i className=\"fas fa-check\" />\n        </button>\n        <Tag style={{ marginLeft: \"auto\" }} color={color.value} label={label.value || \"Label\"} />\n      </form>\n    </div>\n  );\n};\n","import React, { useContext, useState } from \"react\";\nimport \"./Notification.css\";\nimport { NotificationContext } from \"./NotificationContext\";\n\nexport const Notification = ({ index, notification }) => {\n  const [animateProgress, setAnimateProgress] = useState(false);\n  const [notificationOut, setNotificationOut] = useState(false);\n  const { dispatch } = useContext(NotificationContext);\n  return (\n    <div\n      className={`notification ${notification.type} ${notificationOut ? \"out\" : \"in\"}`}\n      onAnimationEnd={event => {\n        if (event.animationName === \"bounceIn\") {\n          setAnimateProgress(true);\n        } else if (event.animationName === \"bounceOut\") {\n          dispatch({ type: \"CLOSE\", payload: { id: notification.id } });\n        }\n      }}\n    >\n      <div className=\"notification-content\">{notification.content}</div>\n      <div\n        className={`notification-progress-bar progress-bar-striped ${animateProgress ? \"animate\" : \"\"}`}\n        style={notificationOut ? { width: \"0\" } : {}}\n        onAnimationEnd={() => setNotificationOut(true)}\n      />\n    </div>\n  );\n};\n","import React, { useContext } from \"react\";\nimport { NotificationContext } from \"./NotificationContext\";\nimport { Notification } from \"./Notification\";\nimport \"./NotificationList.css\";\n\nexport const NotificationsList = () => {\n  const { notifications } = useContext(NotificationContext);\n  return (\n    <div className=\"notification-list\">\n      {notifications.map((notification, index) => (\n        <Notification key={notification.id} index={index} notification={notification} />\n      ))}\n    </div>\n  );\n};\n","import React, { useState, useReducer, useEffect, useContext } from \"react\";\nimport { SingleDownshift } from \"../Common/SingleDownshift\";\nimport range from \"lodash/range\";\nimport { MovieForm } from \"../MovieList/MovieForm\";\nimport { UserContext } from \"../Login/UserContext\";\n\nconst months = [\n  { label: \"Janvier\", value: \"1\" },\n  { label: \"Février\", value: \"2\" },\n  { label: \"Mars\", value: \"3\" },\n  { label: \"Avril\", value: \"4\" },\n  { label: \"Mai\", value: \"5\" },\n  { label: \"Juin\", value: \"6\" },\n  { label: \"Juillet\", value: \"7\" },\n  { label: \"Août\", value: \"8\" },\n  { label: \"Septembre\", value: \"9\" },\n  { label: \"Octobre\", value: \"10\" },\n  { label: \"Novembre\", value: \"11\" },\n  { label: \"Décembre\", value: \"12\" }\n];\n\nconst movieReducer = (state, action) => {\n  switch (action.type) {\n    case \"FETCH_MOVIES_REQUESTED\":\n      return { ...state, status: action.type };\n    case \"FETCH_MOVIES_SUCCEEDED\":\n      return { ...state, status: action.type, movies: [...state.movies, ...action.payload], page: state.page + 1 };\n    case \"RESET_PAGE\":\n      return { ...state, page: 0 };\n    case \"RESET_MOVIES\":\n      return { ...state, movies: [] };\n    case \"ADD_MOVIE_SUCCEEDED\":\n      return {\n        ...state,\n        movies: state.movies.map(movie => {\n          if (movie.allocine.code === action.payload.idAllocine) {\n            return {\n              ...movie,\n              cinema: action.payload\n            };\n          }\n          return movie;\n        })\n      };\n    default:\n      return state;\n  }\n};\n\nexport const Finder = () => {\n  const user = useContext(UserContext);\n  const [year, setYear] = useState(new Date().getFullYear());\n  const [month, setMonth] = useState(months.find(m => m.value === String(new Date().getMonth() + 1)).label);\n  const [movieState, movieDispatch] = useReducer(movieReducer, { movies: [], page: 0, offset: 20 });\n  const [movieToAdd, setMovieToAdd] = useState({ idAllocine: 0 });\n  const showMovie = () => {\n    // eslint-disable-next-line no-undef\n    $(\"#movie-creator-updator\").modal(\"show\");\n  };\n  const fetchMovies = () => {\n    movieDispatch({ type: \"FETCH_MOVIES_REQUESTED\" });\n    fetch(\n      `/api/allocine/find?month=${months.find(m => m.label === month).value}&year=${year}&page=${\n        movieState.page\n      }&offset=${movieState.offset}`,\n      {\n        headers: {\n          Accept: \"application/json\",\n          \"Content-Type\": \"application/json\",\n          Authorization: `Bearer ${user.token}`\n        }\n      }\n    )\n      .then(response => response.json())\n      .then(movies => {\n        movieDispatch({ type: \"FETCH_MOVIES_SUCCEEDED\", payload: movies });\n      });\n  };\n  useEffect(showMovie, [movieToAdd]);\n\n  return (\n    <>\n      <MovieForm\n        // force reinitialisation of movie form\n        key={movieToAdd.idAllocine}\n        movie={movieToAdd}\n        onAdd={movie => movieDispatch({ type: \"ADD_MOVIE_SUCCEEDED\", payload: movie })}\n      />\n      <form className=\"form-inline mt-4 ml-3\">\n        <div className=\"form-group mr-3\" style={{ minWidth: \"150px\" }}>\n          <SingleDownshift\n            items={months.map(month => month.label)}\n            placeholder=\"Month\"\n            onChange={value => {\n              setMonth(value);\n              movieDispatch({ type: \"RESET_PAGE\" });\n            }}\n            selectedItem={month}\n          />\n        </div>\n        <div className=\"form-group mr-3\" style={{ minWidth: \"150px\" }}>\n          <SingleDownshift\n            items={range(new Date().getFullYear() + 3, 2010, -1)}\n            placeholder=\"Year\"\n            onChange={value => {\n              setYear(value);\n              movieDispatch({ type: \"RESET_PAGE\" });\n            }}\n            selectedItem={year}\n          />\n        </div>\n        <button\n          onClick={event => {\n            event.preventDefault();\n            event.stopPropagation();\n            movieDispatch({ type: \"RESET_MOVIES\" });\n            fetchMovies();\n          }}\n        >\n          Goooo\n        </button>\n      </form>\n      <div className=\"movies\">\n        {movieState.movies.map(movie => {\n          return (\n            <div className=\"card movie-card\" key={movie.allocine.code}>\n              <div className=\"card-body\">\n                <h5 className=\"card-title\">\n                  <div className=\"ellipsis\" title={movie.allocine.title}>\n                    {movie.allocine.title}\n                  </div>\n                </h5>\n                <h6\n                  className=\"card-subtitle mb-2 text-muted ellipsis\"\n                  title={`${movie.allocine.productionYear} - ${movie.allocine.genre.map(g => g.$).join(\",\")}`}\n                >\n                  {`${movie.allocine.productionYear} - ${movie.allocine.genre.map(g => g.$).join(\",\")}`}\n                </h6>\n                <div className=\"movie-card-actions\" style={{ position: \"absolute\", top: 2, right: 4 }}>\n                  <i\n                    title=\"Add\"\n                    className=\"fas fa-link\"\n                    style={{ cursor: \"pointer\", color: movie.cinema ? \"#fecc00\" : \"inherit\" }}\n                    onClick={() => {\n                      if (movie.cinema) return;\n                      setMovieToAdd({\n                        idAllocine: movie.allocine.code,\n                        title: movie.allocine.title,\n                        genre: movie.allocine.genre.map(m => m.$).sort(),\n                        type: \"Film\",\n                        productionYear:\n                          movie.allocine.release && movie.allocine.release.releaseDate\n                            ? new Date(movie.allocine.release.releaseDate).getFullYear()\n                            : movie.allocine.productionYear,\n                        summary: movie.allocine.synopsisShort || movie.allocine.synopsis,\n                        fileUrl: movie.allocine.poster ? movie.allocine.poster.href : \"\"\n                      });\n                    }}\n                  />\n                </div>\n                <div className=\"poster text-center\">\n                  <img\n                    src={\n                      movie.allocine.poster.href\n                        ? movie.allocine.poster.href.replace(\"http:\", \"https:\")\n                        : \"/no-image.png\"\n                    }\n                    alt=\"movie poster\"\n                  />\n                </div>\n              </div>\n            </div>\n          );\n        })}\n      </div>\n      {movieState.status === \"FETCH_MOVIES_REQUESTED\" && (\n        <h2 className=\"text-center mt-2\">\n          <i className=\"fas fa-spinner fa-spin fa-2x\" />\n        </h2>\n      )}\n      {movieState.movies.length === movieState.offset * movieState.page &&\n      movieState.status === \"FETCH_MOVIES_SUCCEEDED\" ? (\n        <div className=\"text-center m-3\">\n          <button onClick={() => fetchMovies()} className=\"btn btn-primary btn-lg\">\n            Load more\n          </button>\n        </div>\n      ) : (\n        undefined\n      )}\n    </>\n  );\n};\n","import React, { Component, Fragment } from \"react\";\nimport { BrowserRouter as Router, Route } from \"react-router-dom\";\nimport \"./App.css\";\nimport { List } from \"./MovieList/List\";\nimport { Movie } from \"./Movie/Movie\";\nimport { Header } from \"./Header\";\nimport { Statistics } from \"./Statistics/Statistics\";\nimport { TagList } from \"./Admin/TagList\";\nimport { NotificationsList } from \"./Notifications/NotificationsList\";\nimport { Finder } from \"./Finder\";\n\nclass App extends Component {\n  render() {\n    return (\n      <Fragment>\n        <Router>\n          <Fragment>\n            <Header />\n            <NotificationsList />\n            <Route exact path=\"/\" component={List} />\n            <Route exact path=\"/movie/:id\" component={Movie} />\n            <Route exact path=\"/stats\" component={Statistics} />\n            <Route exact path=\"/admin\" component={TagList} />\n            <Route exact path=\"/finder\" component={Finder} />\n          </Fragment>\n        </Router>\n      </Fragment>\n    );\n  }\n}\n\nexport default App;\n","import React, { Component } from \"react\";\nimport { LOGIN_FAILED, withUser } from \"./UserContext\";\n\nclass LoginWithContext extends Component {\n  state = {\n    password: \"\"\n  };\n\n  render() {\n    return (\n      <div>\n        {this.props.user.status === LOGIN_FAILED ? (\n          <div className=\"alert alert-danger\" role=\"alert\">\n            Login failed\n          </div>\n        ) : (\n          undefined\n        )}\n        <div className=\"form-group\">\n          <label htmlFor=\"password\">Password</label>\n          <input\n            type=\"text\"\n            className=\"form-control\"\n            id=\"password\"\n            aria-describedby=\"password\"\n            placeholder=\"Enter password\"\n            value={this.state.password}\n            onChange={event => this.setState({ password: event.target.value })}\n            onKeyDown={event => {\n              if (event.key === \"Enter\") this.props.user.login(this.state.password);\n            }}\n          />\n        </div>\n        <button type=\"button\" className=\"btn btn-primary\" onClick={() => this.props.user.login(this.state.password)}>\n          Submit\n        </button>\n      </div>\n    );\n  }\n}\n\nexport const Login = withUser(LoginWithContext);\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport \"./index.css\";\nimport App from \"./App\";\nimport { ApplicationProvider } from \"./ApplicationContext\";\nimport { UserProvider, UserContext } from \"./Login/UserContext\";\nimport { Login } from \"./Login/Login\";\nimport { MoviesProvider } from \"./Common/MoviesContext\";\nimport { NotificationProvider } from \"./Notifications/NotificationContext\";\n\nReactDOM.render(\n  <UserProvider>\n    <UserContext.Consumer>\n      {({ token }) =>\n        token ? (\n          <ApplicationProvider token={token}>\n            <MoviesProvider>\n              <NotificationProvider>\n                <App />\n              </NotificationProvider>\n            </MoviesProvider>\n          </ApplicationProvider>\n        ) : (\n          <Login />\n        )\n      }\n    </UserContext.Consumer>\n  </UserProvider>,\n  document.getElementById(\"root\")\n);\n"],"sourceRoot":""}